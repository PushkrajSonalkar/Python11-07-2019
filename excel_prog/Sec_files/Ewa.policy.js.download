Type.registerNamespace("Common.App.Policy.Contracts");Common.App.Policy.Contracts.a=function(){};Common.App.Policy.Contracts.a.registerInterface("Common.App.Policy.Contracts.a");Common.App.Policy.Contracts.b=function(){this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.DefaultLabelId="";this.SensitivityLabels=new Array(0)};Common.App.Policy.Contracts.b.prototype={AreLabelsAvailable:!1,AppliedPolicyId:null,RequiredDowngradeJustification:!1,DefaultLabelId:null,CustomUrl:null,SensitivityLabels:null};Common.App.Policy.Contracts.h=function(){this.Id="";this.Enabled=!1;this.Name="";this.DisplayName="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=new Array(0)};Common.App.Policy.Contracts.h.prototype={Id:null,Enabled:!1,Name:null,DisplayName:null,Order:0,Tooltip:null,IsEndpointProtectionEnabled:!1,ParentId:null,RequiredDowngradeJustification:!1,LabelActions:null};Common.App.Policy.Contracts.g=function(){this.Name="";this.Font="";this.FontSize=0;this.FontColor="";this.Text="";this.Margin=0;this.Alignment="";this.Placement=""};Common.App.Policy.Contracts.g.prototype={Name:null,Font:null,FontSize:0,FontColor:null,Text:null,Margin:0,Alignment:null,Placement:null};Common.App.Policy.Contracts.d=function(n,t,i,r){Common.App.Policy.Contracts.d.initializeBase(this);this.d=n;this.c=t;this.a=i;this.b=r};Common.App.Policy.Contracts.d.prototype={c:null,d:null,a:null,b:null};Common.App.Policy.Contracts.c=function(){Common.App.Policy.Contracts.c.initializeBase(this)};Common.App.Policy.Contracts.f=function(n){Common.App.Policy.Contracts.f.initializeBase(this);this.a=n};Common.App.Policy.Contracts.f.prototype={a:null};Common.App.Policy.Contracts.e=function(){this.IsSuccessful=!1};Common.App.Policy.Contracts.e.prototype={IsSuccessful:!1};Common.App.Policy.Contracts.b.registerClass("Common.App.Policy.Contracts.b");Common.App.Policy.Contracts.h.registerClass("Common.App.Policy.Contracts.h");Common.App.Policy.Contracts.d.registerClass("Common.App.Policy.Contracts.d",Sys.EventArgs);Common.App.Policy.Contracts.c.registerClass("Common.App.Policy.Contracts.c",Sys.EventArgs);Common.App.Policy.Contracts.f.registerClass("Common.App.Policy.Contracts.f",Sys.EventArgs);Common.App.Policy.Contracts.e.registerClass("Common.App.Policy.Contracts.e");Type.registerNamespace("Common.App.Policy");Common.App.Policy.g=function(n,t,i){this.IsPolicyTipAvailable=n;this.GeneralText=t;this.NavigateUrl=i};Common.App.Policy.d=function(){};Common.App.Policy.c=function(n,t,i,r){this.r=Function.createDelegate(this,this.F);this.w=Function.createDelegate(this,this.O);this.x=Function.createDelegate(this,this.P);this.v=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.Q);this.t=Function.createDelegate(this,this.L);this.u=Function.createDelegate(this,this.M);this.s=Function.createDelegate(this,this.J);this.d=n;this.c=t;this.i=i;this.b=r;this.f={};this.l={};i.a("SupportsPolicies")&&i.c("AppliedPolicyId")&&(this.k=i.c("IrmPolicyTitle"),this.j=i.c("IrmPolicyDescription"));this.m=i.a("ProtectedFile")};Common.App.Policy.c.a=function(n,t){t.Image16by16=Common.a.r;t.Image16by16Class=n?Common.y.b(Common.App.Policy.a.h):Common.y.b(Common.App.Policy.a.i);t.Visible=!0};Common.App.Policy.c.prototype={d:null,c:null,i:null,b:null,k:null,j:null,m:!1,a:null,g:null,e:null,f:null,l:null,h:null,B:function(){this.d.a(3427834559,2147483648,this.s);this.d.b(497870830,2147483648,this.u,96);this.d.b(1145315516,2147483648,this.t,96);this.d.b(2935633379,2147483648,this.y,96);this.d.b(3134802707,2147483648,this.v,96);this.d.b(991261903,2147483648,this.x,96);this.d.b(2875864574,2147483648,this.w,96);this.c.g(!1)},L:function(n,t,i,r,u){if(i===1||!this.p())return 32;var f=u,e;return f.MenuItems=(e=new Common.cR,e.Id="SensitivityList",e.MenuSectionList=[],e.UpdateDynamically=!0,e),Array.add(f.MenuItems.MenuSectionList,this.H(!this.n())),this.a.CustomUrl&&Array.add(f.MenuItems.MenuSectionList,this.G(this.n()?this.a.CustomUrl:Common.e.c(this.a.CustomUrl))),this.n()||(f.PopulationXML=Common.v.f(f.MenuItems)),32},N:function(n,t,i,r,u){if(i===1||!u||!this.i.a("WacApplyManualPolicyLabelIsEnabled"))return 32;if(this.a=this.b.a().a(),this.p()){var f=u;f[Common.App.Policy.a.k]=!0}return 32},P:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o;return f[Common.App.Policy.a.j]=!!(e=f[Common.App.Policy.a.g])&&!!(o=this.f[e])&&o===this.a.AppliedPolicyId,32},O:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o,s;return f[Common.App.Policy.a.d]=!!(e=f[Common.App.Policy.a.c])&&!!(o=this.f[e])&&!!(s=this.g[o])&&s.c(this.a.AppliedPolicyId),32},Q:function(n,t,i,r,u){if(i===1||!u)return 32;var e=u,o=e[Common.App.Policy.a.c],f=this.f[o];return Common.App.Policy.a.a in e&&this.b.a().m(e[Common.App.Policy.a.a]),f?this.b.a().i()?(Diag.a.a(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress."),this.c.g(!1),this.o(f,!0,$a.gb)):this.b.a().g(f)?this.i.a("WacLabelingJustificationDialogIsEnabled")&&this.a.RequiredDowngradeJustification&&this.e[f].RequiredDowngradeJustification&&!this.h?this.R(f):this.E(f===this.a.AppliedPolicyId?"":f,this.h):(Diag.a.a(42796169,306,50,"Policy label cannot be set because the user is in a coauth session."),this.c.g(!1),this.o(f,!0,$a.fU)):(Diag.a.a(42796167,306,50,"Policy label cannot be set because the selected policy ID is null."),this.c.g(!1),this.o("",!1,"")),32},C:function(){var t;if(this.e={},this.a=this.b.a().a(),this.a)for(var i=this.a.SensitivityLabels,r=i.length,n=0;n<r;++n)t=i[n],this.e[t.Id]=t},D:function(){var i,n,e;if(this.g={},this.a=this.b.a().a(),this.a){for(var u=this.a.SensitivityLabels,o=u.length,t=0;t<o;++t)i=u[t],i.ParentId||(this.g[i.Id]=new($$sc.t.$$(String)));for(var f=this.a.SensitivityLabels,s=f.length,r=0;r<s;++r)(n=f[r],n.ParentId&&n.ParentId in this.g)&&(e=this.g[n.ParentId],e.b(n.Id))}},A:function(){Common.a.a.a("WacApplyManualPolicyLabelIsEnabled")&&this.n()&&(this.a=this.b.a().a(),this.p())&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))},E:function(n,t){this.h=t;this.b.a().n(n);this.c.g(!1);this.b.a().o(n,this.h)},F:function(n,t,i){n===1&&this.E(t===this.a.AppliedPolicyId?"":t,i)},R:function(n){var t=new Common.App.Policy.b(n,this.r);t.W()},o:function(n,t,i){if(t){var r=new CommonUI.d;r.E=Common.a.bM;r.g(0);r.h(1,$a.b);r.cv($a.fR,i,null)}else this.b.a().j()},n:function(){return!!this.c&&!!this.c.a()&&this.c.a().a()},J:function(n,t,i){return i===1?32:(i===2,32)},M:function(n,t,i,r,u){var f,e,s;if(i===1||(this.a=this.b.a().a(),!this.a||!u))return 32;if(f=u,f.LabelText=null,f.Alt=null,f.Image16by16=null,f.Image16by16Class=null,f.Visible=!1,this.a.AreLabelsAvailable){e=null;for(var h=this.a.SensitivityLabels,c=h.length,o=0;o<c;++o)if(s=h[o],s.Id.toLowerCase()===this.a.AppliedPolicyId.toLowerCase()){e=s;break}e&&(f.LabelText=this.K(e),f.Alt=e.Tooltip,this.m=e.IsEndpointProtectionEnabled)}else{if(!this.k)return 32;f.LabelText=this.k;this.j&&(f.Alt=this.j)}return f.LabelText&&Common.App.Policy.c.a(this.m,f),32},K:function(n){return n.ParentId&&this.e[n.ParentId]?this.e[n.ParentId].DisplayName+"\\"+n.DisplayName:n.DisplayName},G:function(n){var i=this.q("LearnMoreSection",!0),r="SensitivityLearnMore",t,u=(t=new Common.cb,t.Id=r,t.ExternalId=r,t.MenuItemId=n,t.LabelText=$a.Z,t.Command="1959943459",t.Image16by16=Common.a.r,t.Image16by16Class=Common.y.b(Common.App.Policy.a.e),t.Visible=!0,t.Alt=$a.L_LearnMoreTooltip,t.KeyTip="L",t);return Array.add(i.ControlList,u),i},z:function(n,t,i,r,u,f,e,o){var c="Toggle_"+e+"_"+t,h=o?Common.e.c(c):c,s,l=(s=new Common.cx,s.Id=h,s.ExternalId=h,s.LabelText=o?Common.e.c(i):i,s.Command="2935633379",s.MenuItemId=h,s.QueryCommand="991261903",s.CheckedImage=Common.a.r,s.CheckedImageClass=Common.y.b(Common.App.Policy.a.b),s.Image16by16=Common.a.r,s.Image16by16Class=Common.y.b(Common.App.Policy.a.b),s.Visible=!0,s.Alt=o?Common.e.c(r):r,s.IsChecked=u,s.AriaLabel="menuitemradio",s.KeyTip=f,s);return h=c,this.f[h]=n,this.l[n]=h,l},q:function(n,t){var i;return i=new Common.cl,i.Title="",i.Id=n,i.DisplayMode=Common.App.Policy.a.f,i.ShowMenuSectionSeparator=t,i.ControlsId="Ctrl_"+n,i.ControlList=[],i},I:function(n,t,i){for(var u=this.q(n+"Sub",!1),f=1,e=t.$$lge(),o,r;e.$$mn();)o=e.$$cu(),r=this.e[o],r&&r.Enabled&&Array.add(u.ControlList,this.z(r.Id,r.Name,r.DisplayName,r.Tooltip,r.Id===this.a.AppliedPolicyId,f.toString(),n,i)),f++;return u},H:function(n){var e=this.q("SensitivitySection",!1),o=1,h=this.g,s,f,r,t,u;for(s in h){var c={key:s,value:h[s]},l=c.value,i=this.e[c.key];i&&i.Enabled&&(l.e.length?(f=n?Common.e.c(i.Name):i.Name,u=(t=new Common.cz,t.Id=f,t.ExternalId=f,t.LabelText=n?Common.e.c(i.DisplayName):i.DisplayName,t.Command="798637440",t.QueryCommand="2875864574",t.Menu=(r=new Common.cR,r.Title="",r.MenuSectionList=[],r.UpdateDynamically=!0,r),t.Image16by16=Common.a.r,t.Image16by16Class=Common.y.b(Common.App.Policy.a.b),t.ImageIsVisible=!1,t.ImageUsesSpaceWhileInvisible=!0,t.AriaLabel="menuitemradio",t.KeyTip=o.toString(),t),Array.add(u.Menu.MenuSectionList,this.I(f,l,n)),Array.add(e.ControlList,u),this.f[u.Id]=i.Id,this.l[i.Id]=u.Id):Array.add(e.ControlList,this.z(i.Id,i.Name,i.DisplayName,i.Tooltip,i.Id===this.a.AppliedPolicyId,o.toString(),"",n)),o++)}return e},p:function(){var n=this;return!!this.a&&this.a.AreLabelsAvailable&&!!this.a.SensitivityLabels&&this.a.SensitivityLabels.length>0&&Common.bT.a(this.a.SensitivityLabels,function(n){return!!n&&n.Enabled})}};Common.App.Policy.a=function(){};Common.App.Policy.e=function(n,t,i,r){this.L=Function.createDelegate(this,this.W);this.P=Function.createDelegate(this,this.ba);this.Q=Function.createDelegate(this,this.bb);this.N=Function.createDelegate(this,this.Y);this.O=Function.createDelegate(this,this.Z);this.K=Function.createDelegate(this,this.V);this.M=Function.createDelegate(this,this.X);this.p=new Common.R;this.w=n;this.x=t;this.r=i;this.z=r;this.q=new Common.App.Policy.Contracts.b;this.G=this.w.f.PolicyHandlerEndpointName||"PolicyHandler.ashx"};Common.App.Policy.e.prototype={G:null,w:null,C:null,x:null,z:0,E:0,D:0,u:0,v:"",F:null,y:null,q:null,r:null,A:null,s:null,t:null,B:null,c:function(n){this.p.q("PolicyTipEvent",n)},b:function(n){this.p.q("LabelInfoUpdateEvent",n)},f:function(n){this.p.q("SetPolicyLabelEventKey",n)},l:function(n){this.p.t("SetPolicyLabelEventKey",n)},d:function(n){this.p.q("SetPolicyLabelFailureEventKey",n)},k:function(n){this.p.t("SetPolicyLabelFailureEventKey",n)},I:function(n){var i=this.w.f.PolicyHandlerWebServiceBase||Common.a.b().a().i(),t=String.format("{0}{1}?action={2}&{3}",i,this.G,n,Common.a.e);return n==="setpolicylabel"&&Common.a.z&&Common.a.z.b()&&(t=Common.l.a(t,"sl","1",!1)),t},e:function(){this.r&&(this.A=this.r.a("WebServiceCall","Call Get Policy Endpoint On Server"));this.x.a(this.I("datalosspolicy"),1,null,null,!0,2,this.M,this.K,null,null,!1,null,null,null,null,!1,null,!1);this.E++;Diag.a.a(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.G,this.E)},h:function(n,t){if(this.w.a("WacLabelingGetPolicyLabelsIsEnabled")){this.v=n;this.y=t;this.r&&(this.s=this.r.a("WebServiceCall","Call Get Policy Endpoint On Server"));var i={};i["X-AppliedPolicyId"]=n;this.x.a(this.I("getpolicylabels"),1,null,i,!0,2,this.O,this.N,null,null,!1,null,null,"22",null,!1,null,!1);this.D++;Diag.a.a(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.D)}},a:function(){if(!this.y)return this.q;var r=JSON.stringify(this.q),n,t,i;return(i=Common.bl.a(Common.App.Policy.Contracts.b,r,t={val:n}),n=t.val,i)?(this.y(n),n):(Diag.a.a(41754699,306,15,"PolicyManager.GetPolicyLabelsData - Trying to deserialize the policy data failed."),this.q)},Z:function(n){this.s&&(this.s.a(),this.s=null);var t="",i,r;(r=this.J(n,i={val:t}),t=i.val,r)&&(Diag.a.a(34996493,306,50,"Request to get label policy data succeeded."),this.bd(t))},Y:function(n){if(this.s&&(this.s.a(),this.s=null),this.D<=this.z){this.h(this.v,this.y);return}Diag.a.a(34996494,306,15,"Request to get label policy failed with error response: {0}.",n?n.b?n.b.i:null:null)},X:function(n){this.S();var t="",i,r;(r=this.J(n,i={val:t}),t=i.val,r)&&(Diag.a.a(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.r&&(this.B=this.r.a("Task","Parse and Handle Get Policy Response")),this.bc(t),this.B)&&(this.B.a(),this.B=null)},V:function(n){if(this.S(),this.E<=this.z){this.e();return}Diag.a.a(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",n?n.b?n.b.i:null:null)},i:function(){return this.u>0},n:function(n){this.q.AppliedPolicyId=n},o:function(n,t){if(this.w.a("WacApplyManualPolicyLabelIsEnabled")){this.r&&(this.t=this.r.a("WebServiceCall","Call Set Policy Endpoint On Server"));var i={};i["X-SelectedPolicyLabelId"]=n;t&&(i["X-SetPolicyLabelJustification"]=t);this.F&&(i["X-AppLockId"]=this.F);this.x.a(this.I("setpolicylabel"),1,null,i,!0,2,this.Q,this.P,null,null,!1,null,null,"32",null,!1,null,!1);this.u++;Diag.a.a(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.u)}},bb:function(n){var i,r,u,f,t,e,o;if(this.t&&(this.t.a(),this.t=null),this.R(n,u={val:i},f={val:r}),i=u.val,r=f.val,t="",!(o=this.J(n,e={val:t}),t=e.val,o)){this.H();return}Diag.a.a(41799707,306,50,"Request to set label policy data succeeded.");this.u=0;this.be(t,i)},ba:function(n){this.t&&(this.t.a(),this.t=null);var t,i,r,u;if(this.R(n,r={val:t},u={val:i}),t=r.val,i=u.val,this.u<=this.z){this.o(t,i);return}Diag.a.a(41799708,306,15,"Request to set label policy failed with error response: {0}.",n?n.b?n.b.i:null:null);this.u=0;this.H()},g:function(n){var i,r,t;if(!n)return!1;if(Common.a.z&&Common.a.z.a())return!0;i=null;r=null;for(var f=this.q.SensitivityLabels,e=f.length,u=0;u<e;++u)t=f[u],t.Id===n&&(i=t),t.Id===this.v&&(r=t);return i?i.IsEndpointProtectionEnabled===(!!r&&r.IsEndpointProtectionEnabled):!1},R:function(n,t,i){t.val=i.val=null;n&&n.a()&&n.a().d&&n.a().d.get_headers()&&(t.val=n.a().d.get_headers()["X-SelectedPolicyLabelId"],i.val=n.a().d.get_headers()["X-SetPolicyLabelJustification"])},J:function(n,t){return(t.val=n?n.b?n.b.a:null:null,!t.val||!t.val.length||this.U(t.val))?(Diag.a.a(25565152,306,10,"No response data from policy endpoint."),!1):!0},bc:function(n){var t;try{t=JSON.parse(n)}catch(i){Diag.a.a(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(!t){Diag.a.a(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.");return}if(!t.IsPolicyTipAvailable){Diag.a.a(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");return}switch(t.IsPolicyTipAvailable.toLowerCase()){case"false":Diag.a.a(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");return;case"true":Diag.a.a(25565186,306,50,"DLP Policy is enabled on this document.");this.C=t.NavigateUrl;this.bh(t.GeneralText,this.L);break;default:Diag.a.a(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",t.IsPolicyTipAvailable)}},be:function(n,t){var i,r,u;if(!(u=Common.bl.a(Common.App.Policy.Contracts.e,n,r={val:i}),i=r.val,u)){Diag.a.a(41799709,306,10,"Error when deserializing set policy label data response.");return}i?i.IsSuccessful?(this.bg(t),this.h(t,null)):this.H():(Diag.a.a(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response."),this.H())},H:function(){this.q.AppliedPolicyId=this.v;this.T(new Common.App.Policy.Contracts.c);this.j()},bg:function(n){this.q.AppliedPolicyId=this.v=n;this.bf(new Common.App.Policy.Contracts.f(n))},bd:function(n){var t,i,r;if(!(r=Common.bl.a(Common.App.Policy.Contracts.b,n,i={val:t}),t=i.val,r)){Diag.a.a(34996495,306,10,"Error when deserializing label policy data response.");return}if(!t){Diag.a.a(42467542,306,10,"policyData is null after deserializing label policy data response.");return}t.AreLabelsAvailable&&(this.q=t,this.T(new Common.App.Policy.Contracts.c))},T:function(n){Diag.a.a(35393610,306,50,"Raising label info update event.");this.p.p("LabelInfoUpdateEvent",n,null)},bf:function(n){Diag.a.a(41799710,306,50,"Raising set policy label event.");this.p.p("SetPolicyLabelEventKey",n,null)},bh:function(n,t){Diag.a.a(34996496,306,50,"Showing policy tip to user.");this.p.p("PolicyTipEvent",new Common.App.Policy.Contracts.d($a.fd,n,$a.fe,t),null)},j:function(){Diag.a.a(42074656,306,50,"Raising set policy label failure event.");this.p.p("SetPolicyLabelFailureEventKey",new Sys.EventArgs,null)},m:function(n){this.F=n},W:function(){this.C?(Diag.a.a(25565187,306,50,"DLP override button was clicked."),Common.g.e(this.C)):Diag.a.a(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")},U:function(n){return!n.startsWith("<")||n.indexOf("Error")===-1&&n.indexOf("Unavailable")===-1?!1:(Diag.a.a(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint."),!0)},S:function(){this.A&&(this.A.a(),this.A=null)}};Common.App.Policy.f=function(){this.j=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.n);this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.m)};Common.App.Policy.f.a=function(){Common.App.a.a().a(new Common.App.Policy.f,0,!1)};Common.App.Policy.f.prototype={a:function(){return"Common.App.Policy"},d:null,f:null,e:null,b:function(){if(Common.a.a.a("ShouldInitCommonPolicyPackage")){if(Common.a.a.a("IsDataLossPreventionEnabledForUser")&&Common.a.b()){this.d=this.f.a(Common.App.Policy.Contracts.a);this.d.c(this.h);Diag.a.a(36537375,306,50,"PolicyManager is created successfully.");var n=this;Common.App.AppLifecycleManager.get_instance().a(6,function(){n.d.e()},3)}Common.a.a.a("WacLabelingPoliciesIsEnabled")&&Common.a.a.a("SupportsPolicies")&&(Common.App.AppLifecycleManager.get_instance().a(6,this.g,3),Common.a.a.a("WacApplyManualPolicyLabelIsEnabled")&&this.d.d(this.i))}},c:function(n){var i=this,t;n.b(Common.App.Policy.Contracts.a).a().b(function(){return new Common.App.Policy.e(Common.a.a,Common.a.d,Common.a.b().c(),Common.a.a.b("MaxGetPolicyRetries",1))});t=this;n.b(Common.App.Policy.c).a().b(function(){return new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,n.e(Common.App.Policy.Contracts.a))});this.f=n},l:function(){this.e=this.f.a(Common.App.Policy.c);this.e.B();this.d||(this.d=this.f.a(Common.App.Policy.Contracts.a));this.d.b(this.j)},o:function(){this.e.D();this.e.C();this.e.A();Common.a.b().g(!1)},m:function(n,t){var i=this.k(t.d,t.c,null,t.b,t.a),r=Common.a.b().a();if(!r.q(i,!0)){Diag.a.a(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.");return}Diag.a.a(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")},n:function(){var n=this.k($a.fT,$a.fS,null,null,null),t=Common.a.b().a();if(!t.q(n,!0)){Diag.a.a(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.");return}Diag.a.a(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")},k:function(n,t,i,r,u){var f=new CommonUI.i(n,t,i);return f.d(21),f.c(!0),r&&f.a(u,r,"",!1),f}};Common.App.Policy.b=function(n,t){this.e=Function.createDelegate(this,this.U);this.R=Function.createDelegate(this,this.X);this.d=Function.createDelegate(this,this.T);this.a=[$a.fX,$a.fV,$a.fY];Common.App.Policy.b.initializeBase(this);this.c=n;this.b=t;this.n=this.S();this.g(1);this.h(1,$a.cL);this.B(1,!1)};Common.App.Policy.b.prototype={c:null,b:null,W:function(){for(var n={},t=0;t<this.a.length;t++)n[Common.App.Policy.b.b+t]=!1;n[Common.App.Policy.b.a]="";this.l($a.ga,this.d,n);this.V();Common.j.a($get(Common.App.Policy.b.a),"input",this.R)},bm:function(){var t=$get(Common.App.Policy.b.a);if(t.disabled)return!0;var n=t.value,i=n.length<2,r=n.length>500,u=new RegExp("[{|}|;|\\\\]").test(n),f=Common.e.I(n)==="";return!i&&!r&&!u&&!f},T:function(n,t){if(n===1)for(var i=0;i<this.a.length;i++)if(t[Common.App.Policy.b.b+i]){this.b(n,this.c,i===this.a.length-1?t[Common.App.Policy.b.a]:this.a[i]);return}},X:function(n){var t=n.target;t&&this.B(1,this.bm())},S:function(){return CommonUI.b.a(Common.App.Policy.b.d,Common.a.r,Common.y.b(Common.App.Policy.b.c),$a.fW,this.a[0],this.a[1],this.a[2],$a.fZ)},V:function(){for(var i,t=document.getElementsByName(Common.App.Policy.b.e),n=0;n<t.length;n++)i=t[n],Common.j.a(i,"focus",this.e)},U:function(n){var i=n.target,t;i&&(i.checked=!0,t=$get(Common.App.Policy.b.a),i.id===Common.App.Policy.b.b+(this.a.length-1)?(t.disabled=!1,Sys.UI.DomElement.setVisible(t,!0),t.focus()):(t.disabled=!0,i.focus()),this.B(1,this.bm()))}};Common.App.Policy.c.registerClass("Common.App.Policy.c");Common.App.Policy.b.registerClass("Common.App.Policy.b",CommonUI.b);Common.App.Policy.d.a="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> <\/div> <\/div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}<\/label> <\/div> <\/div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'><\/input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'><\/input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'><\/input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"><\/textarea> <\/div>";Common.App.Policy.a.h="sbProtectForm14";Common.App.Policy.a.i="SBStatusBarMarkAsReadOnly14";Common.App.Policy.a.e="Info_16x16x32";Common.App.Policy.a.b="QuickSearchCompletedToday_16x16x32";Common.App.Policy.a.j="On";Common.App.Policy.a.k="Visible";Common.App.Policy.a.d="ImageIsVisible";Common.App.Policy.a.c="SourceControlId";Common.App.Policy.a.g="MenuItemId";Common.App.Policy.a.f="Menu";Common.App.Policy.a.a="AppLockId";Common.App.Policy.b.d=Common.App.Policy.d.a;Common.App.Policy.b.e="ListRadioBox";Common.App.Policy.b.b="radiobox";Common.App.Policy.b.a="txtJustification";Common.App.Policy.b.c="Info_32x32x32";Common.App.Policy.f.a();Type.registerNamespace("_Ewa");_Ewa.tu=function(n){_Ewa.tu.initializeBase(this);this.h=n;this.j()};_Ewa.tu.a=function(n){n.a().b(_Ewa.Rw.$$(_Ewa.iy),274,new _Ewa.tu(n))};_Ewa.tu.prototype={k:null,h:null,b:function(){var t=_Ewa.k.b(_Ewa.cF,this.h.a(),4,3),i=Common.a.d,r=Common.a.a,n=this;_Ewa.e.cw(t,function(){try{var u=new($$sc.x.$$(Common.App.Policy.Contracts.a))(function(){return new Common.App.Policy.e(r,i,Common.a.b().c(),n.h.f().MaxGetPolicyRetries)});n.i(n.k||(n.k=new _Ewa.PolicyManagerWrapper(u.a(),new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,u),t.a(),n.h)))}catch(f){Diag.a.a(36444224,306,10,"PolicyManager was not created successfully [Exception: {0}]",f.toString());throw f;}},this.dg(),3)}};_Ewa.PolicyManagerWrapper=function(n,t,i,r){if(this.z=Function.createDelegate(this,this.J),this.x=Function.createDelegate(this,this.E),this.y=Function.createDelegate(this,this.w),this.p=Function.createDelegate(this,this.I),this.q=Function.createDelegate(this,this.K),this.r=Function.createDelegate(this,this.M),this.B=Function.createDelegate(this,this.O),this.A=Function.createDelegate(this,this.L),_Ewa.PolicyManagerWrapper.initializeBase(this,[!1]),Diag.a.a(34402886,306,50,"DataLossPrevention feature is Enabled and launched on Excel."),this.f=r,this.h=n,this.o=i,this.h.c(this.A),this.G(),this.l=t,this.f.b(533)){this.h.b(this.B);this.l.B();var u=this;this.f.a().c(_Ewa.bH,29,function(n){u.m=n;n.c(u)});this.C();this.F(this.H());this.f.b(534)&&(this.h.d(this.r),this.h.f(this.q),this.f.c().u(this.p))}};_Ewa.PolicyManagerWrapper.prototype={h:null,f:null,m:null,l:null,n:!1,o:null,k:function(n){this.dh("LabelInfoChangedKey",n)},i:function(n){this.di("LabelInfoChangedKey",n)},g:function(){return!0},d:function(n,t){if(n!=="QueryPolicyLabel")return!1;var i=Common.a.c().c(497870830,2,t,null);return i===32},dispose:function(){this.m&&(this.m.b(this),this.m=null);this.n=!1;this.f.b(534)&&(this.h.k(this.r),this.h.l(this.q),this.f.c().v(this.p));_Ewa.cJ.prototype.dispose.call(this)},v:null,e:function(){return this.v},u:null,c:function(){return this.u},s:null,a:function(){return this.s},t:null,b:function(){return this.t},j:null,C:function(){this.de("LabelInfoChangedKey",null,null)},G:function(){this.h.e()},H:function(){return this.f.f().DocumentHostInfo.TenantId},F:function(n){Diag.a.a(41740191,306,50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",n.length);var t=this.f.d().a().b(),i=this;_Ewa.tv.b(this.f.d().a(),n,function(n){i.N(n)},null,null,t)},L:function(n,t){if(!t){Diag.a.a(34402887,306,15,"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.");return}this.v=t.d;this.u=t.c;this.s=t.a;this.t=t.b;this.o.a(25,null);Diag.a.a(34402888,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")},M:function(){this.o.a(35,null)},O:function(){this.l&&(Diag.a.a(41961095,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),this.l.D(),this.l.C(),this.f.b(534)&&this.l.A());this.D();this.C()},N:function(n){Diag.a.a(41740192,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");n&&!_Ewa.U.a(n)?(this.j=n.Result,Common.App.AppLifecycleManager.get_instance().a(10,this.y,3),Diag.a.a(41740193,306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.j.length)):Diag.a.a(41740194,306,15,"PolicyManagerWrapper: LabelId is invalid")},w:function(){this.h.h(this.j,this.x)},K:function(n,t){Diag.a.a(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label.");var r=this.h.a(),u=JSON.stringify(r),f=this.f.d().a(),i=this,e=function(n){return _Ewa.tv.a(f,u,t.a,i.f.f().DocumentHostInfo.TenantId,_Ewa.m.a.call(null,n,i.z),null,t.a,null)},o=this;_Ewa.L.a(this.f.g(),e,function(n){return new _Ewa.F(215,0,n,0,null)},null)},D:function(){this.n||(this.f.E(),this.n=!0)},J:function(n,t){Diag.a.a(42763015,306,100,"PolicyManagerWrapper.OnApplyManualPolicyLabelSuccessCallback: Invoking GetPolicyLabels to update UI.");this.j=t;this.w()},E:function(n){var i,e;if(!this.f.b(469))for(var u=n.SensitivityLabels,o=u.length,t=0;t<o;++t){i=u[t];for(var f=i.LabelActions,s=f.length,r=0;r<s;++r)if(e=f[r],_Ewa.j.a(e.Name,"ApplyWatermark",!1)){i.Enabled=!1;break}}},I:function(){var n=this.f.c().L();n&&!_Ewa.j.a(n.AppliedPolicyLabelId,this.j,!1)&&(Diag.a.a(42844434,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),this.j=n.AppliedPolicyLabelId,this.w())}};_Ewa.tw=function(n){_Ewa.tw.initializeBase(this,[n])};_Ewa.tw.a=function(n){_Ewa.Y.a(314,new _Ewa.tw(n))};_Ewa.tw.prototype={l:function(){this.k([new _Ewa.FV(this.h)],null)}};_Ewa.FV=function(n){this.a=n};_Ewa.FV.prototype={a:null,t:function(){return!1},r:function(n,t,i){var r;switch(t.a){case 2935633379:return this.a.k().FileCoauthorable||(i[Common.App.Policy.a.a]=this.a.k().ExclusiveLockId),r=Common.a.c().c(2935633379,2,i,null),$$sc.a.a(Boolean,r===32);case 2875864574:return r=Common.a.c().c(2875864574,2,i,null),$$sc.a.a(Boolean,r===32);case 991261903:return r=Common.a.c().c(991261903,2,i,null),$$sc.a.a(Boolean,r===32);default:return _Ewa.H.a(t.a)}},q:function(n,t){switch(t.a){case 2935633379:case 2875864574:case 991261903:return this.a.b(533)&&this.a.b(534);default:return!1}},s:function(n,t,i){switch(t){case"PopulateSensitivityFlyout":if(!this.a.b(533)||!this.a.b(534))return!1;var r=Common.a.c().c(1145315516,2,i,null);return r===32;default:return!1}}};_Ewa.tv=function(){};_Ewa.tv.b=function(n,t,i,r,u,f){var e=n.a(1,f);return e.tenantId=t,_Ewa.g.a(n,"GetPolicyLabelId",e,i,r,u,4,null)};_Ewa.tv.a=function(n,t,i,r,u,f,e,o){var s=n.a(41,o);return s.labelsInfoJson=t,s.appliedLabelId=i,s.tenantId=r,_Ewa.g.a(n,"ApplyManualPolicyLabel",s,u,f,e,0,null)};_Ewa.tu.registerClass("_Ewa.tu",_Ewa.nS.$$(_Ewa.iy));_Ewa.PolicyManagerWrapper.registerClass("_Ewa.PolicyManagerWrapper",_Ewa.cJ,_Ewa.sj,Common.IRootUser,_Ewa.iy);_Ewa.tw.registerClass("_Ewa.tw",_Ewa.Y);Type.registerNamespace("_Ewa");_Ewa.SN=function(){};_Ewa.SN.a=function(){_Ewa.f.a(function(n){_Ewa.tu.a(n);n.b(533)&&_Ewa.tw.a(n)})};_Ewa.SN.a();