var excelOnlineCalc=function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=12)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=n(1);r.utils=t;var o=n(2);r.idbPromised=o;var a=n(3);r.ULS=a.ULS,r.TraceLevel=a.TraceLevel,r.LogCategory=a.LogCategory,r.NulLogger=a.NulLogger,r.ConsoleLogger=a.ConsoleLogger;var i=n(4);r.browserSupport=i;var u=n(5);r.perfWatch=u;var c=n(6);r.initEwaUtils=c.initEwaUtils,r.ewaUtils=c.ewaUtils;var l=n(7);r.initStopwatchFactory=l.initStopwatchFactory;var s=n(8);r.getNewGuid=s.getNewGuid},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,n){return e.reduce(function(e,t){return e.then(function(){return n&&n.stop?Promise.resolve(void 0):r(t,n)})},Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,n){if(void 0===n&&(n=0),n<0||n>t)return r;if(null==r||"object"!=typeof r)return r;var o={};Object.getOwnPropertyNames(r).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])});var a=Object.getPrototypeOf(r);a&&"object"==typeof a&&Object.keys(a).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])});var i={};return Object.keys(o).forEach(function(r){i[r]=e(o[r],n+1)}),i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var t=5;var o="_",a=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(a,o).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===o&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===o&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var n=Promise.reject(void 0),t=function(r){n=n.catch(function(n){return e(r,n)})},o=1;o<=r;o+=1)t(o);return n},r.chainFallbackPromises=function(e,r){if(!e||0===e.length)return Promise.resolve();for(var n=r(e[0]),t=function(t){var o=e[t];n=n.catch(function(){return r(o)})},o=1;o<e.length;o+=1)t(o);return n},r.getQueryParameterByName=function(e,r){var n=new RegExp("[?&]"+r+"(=([^&#]*)|&|#|$)").exec(e);if(n)return n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""},r.calcHashCode=function(e){if(!e)return 0;for(var r=5381,n=r,t=e.length,o=0;o<t&&(r=4294967295&((r<<5)+r^e.charCodeAt(o)),o!==t-1);o+=2)n=4294967295&((n<<5)+n^e.charCodeAt(o+1));var a=r+35685*n+(23896*n<<16)&4294967295;return a<0&&(a+=4294967296),a},r.getCharIndexInTextFromPoint=function(e,r){var n=-1,t=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(n=o.offset);else if(void 0!==document.caretRangeFromPoint)null!==(o=document.caretRangeFromPoint(e,r))&&(n=o.startOffset);else try{var o;(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(t),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}for(;null!=t&&"SPAN"===t.nodeName;)null!=(t=t.previousSibling)&&null!=t.textContent&&(n+=t.textContent.length);return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t,o=n(1);function a(e,r,n){return e?!(r&&!e.objectStoreNames.contains(r))||(n({name:"ValidationError",message:"The database doesn't contain store name: "+r}),!1):(n({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function u(e){void 0!==i&&i(e)}function c(e,r,n,t){return new Promise(function(o,i){if(a(e,r,i)){var u,c=e.transaction([r],n);c.oncomplete=function(){return o()},c.onerror=function(){return i(u||c.error)},c.onabort=function(){return i(u||c.error)};var l=c.objectStore(r),s=t(l);s.onerror=function(){u=s.error}}})}r.registerTraceSubscriber=function(e){i=e},r.clearTraceSubscriber=function(){i=void 0},r.setTestDbFactory=function(e){t=e},r.getDbFactory=function(){if(t)return t;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(n){var e=o.getStringifiedError(n);e&&e!==o.defaultToJSONResultWhenStringifyFails||!n||!n.message||(e=n.message);var r=o.getPerfWatchMarkName(e);u("indexedDB_access_error"+(r&&r.length>0?"_":"")+r)}},r.getStoreReadinessPromise=function(e){return new Promise(function(r,n){e.transaction.oncomplete=function(){return r()},e.transaction.onerror=function(){return n(e.transaction.error)}})},r.initDb=function(e,r,n,t){return new Promise(function(o,a){u("idb_open");var i,c,l,s,f=n||0===n?e.open(r,n):e.open(r),d=(i=!1,c=!1,l=function(e){u("idb_open_"+e)},s=function(){return c?(l("already_resolved"),!1):!i||(l("already_rejected"),!1)},{rejectOnce:function(e){l("should_reject"),s()&&(l("rejecting"),i=!0,a(e))},resolveOnce:function(e){l("should_resolve"),s()&&(l("resolving"),c=!0,o(e))}});f.onupgradeneeded=function(e){u("idb_open_onupgradeneeded_start");var n=e.target.result;if(e.oldVersion>0&&function(e){u("idb_open_onupgradeneeded_deleteAllObjectStores");for(var r=[],n=e.objectStoreNames.length-1;n>=0;n-=1){var t=e.objectStoreNames.item(n);(t||""===t)&&r.push(t)}r.forEach(function(r){u("idb_open_onupgradeneeded_delete_store_"+r),e.deleteObjectStore(r)})}(n),t){u("idb_open_onupgradeneeded_create_stores");var o=t(n);o&&o.length>0&&Promise.all(o).then(function(){u("idb_open_onupgradeneeded_stores_ready"),d.resolveOnce({db:n,dbName:r})},function(e){u("idb_open_onupgradeneeded_stores_ready_error"),d.rejectOnce(e)})}u("idb_open_onupgradeneeded_end")},f.onsuccess=function(e){u("idb_open_onsuccess"),d.resolveOnce({db:e.target.result,dbName:r})},f.onerror=function(){u("idb_open_onerror"),d.rejectOnce(f.error)},f.onblocked=function(e){u("idb_open_onblocked"),d.rejectOnce(e)}})},r.deleteDb=function(e,r){return new Promise(function(n,t){var o=e.deleteDatabase(r);o.onsuccess=function(){return n()},o.onblocked=function(){return n()},o.onerror=function(){return t(o.error)}})},r.doTransactionAction=c,r.put=function(e,r,n,t){return c(e,r,"readwrite",function(e){return n?e.put(t,n):e.put(t)})},r.get=function(e,r,n){return new Promise(function(t,o){if(a(e,void 0,o)){var i;e.objectStoreNames.contains(r)||t(void 0);var u=void 0,c=e.transaction([r],"readonly");c.oncomplete=function(){return t(u)},c.onerror=function(){return o(i||c.error)},c.onabort=function(){return o(i||c.error)};var l=c.objectStore(r).get(n);l.onsuccess=function(e){u=e.target.result},l.onerror=function(){i=l.error}}})},r.getAllItems=function(e,r){return new Promise(function(n,t){if(a(e,r,t)){var o,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(o||u.error)},u.onabort=function(){return t(o||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.value),r.continue())},c.onerror=function(){o=c.error}}})},r.getAllKeys=function(e,r){return new Promise(function(n,t){if(a(e,r,t)){var o,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(o||u.error)},u.onabort=function(){return t(o||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.key),r.continue())},c.onerror=function(){o=c.error}}})},r.remove=function(e,r,n){return c(e,r,"readwrite",function(e){return e.delete(n)})},r.removeAll=function(e,r){return c(e,r,"readwrite",function(e){return e.clear()})}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,n,t){return r.traceTag(0,e,n,t)},traceTag:function(e,n,t,o){return r.traceTag(e,n,t,o)},debugTrace:function(e,n,t){return r.debugTraceTag(0,e,n,t)},debugTraceTag:function(e,n,t,o){return r.debugTraceTag(e,n,t,o)},assert:function(e,n,t){return r.assertTag(0,e,n,t)},assertTag:function(e,n,t,o){return r.assertTag(e,n,t,o)},shipAssert:function(e,n,t){return r.shipAssertTag(0,e,n,t)},shipAssertTag:function(e,n,t,o){return r.shipAssertTag(e,n,t,o)}}}}};var t=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,n,t){console.assert(n,"shipAssertTag:",e,r,t)},e.prototype.assertTag=function(e,r,n,t){console.assert(n,"assertTag",e,r,t)},e.prototype.traceTag=function(e,r,n,t){console.log("traceTag",e,t,r,n)},e.prototype.debugTraceTag=function(e,r,n,t){console.log("debugTraceTag",e,t,r,n)},e}();r.ConsoleLogger=t;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=o},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={},o="promises";r.promises=function(){return void 0===t[o]&&(t[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),t[o]}},function(e,r,n){"use strict";function t(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,r,n){e[r]=t()-n}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=t(),n=e,a=r,i={},u=function(e,r,t){return function(e,r,n,t,a,i){o(e,"end",n);var u={sessionName:r,result:t?"success":"failure",message:i,marks:e},c=JSON.stringify(u);a(c)}(i,n,a,e,r,t)};return i.start=0,{mark:function(e){return function(e){return o(i,e,a)}(e)},end:function(e){return u(!0,e)},success:function(e,r){return u(!0,e,r)},failure:function(e,r){return u(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,n){void 0!==e&&e.success(r,n)},r.failure=function(e,r,n){void 0!==e&&e.failure(r,n)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return t},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");t=e}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(t=function(){return self.performance.now()}),function(n){var o=t(),a=n;return{reset:function(e){null!=e&&(a=e),o=t()},stop:function(){var n=t()-o,i=JSON.stringify({Target:a,Duration:n.toFixed(r)});e(i)}}}}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getNewGuid=function(){var e=new Uint8Array(31),r=function(e){var r={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){r.crypto=!0;try{return n.getRandomValues(e),r}catch(e){r.exceptions.push("crypto: "+JSON.stringify(e))}}var t=!1,o=window.performance;try{o&&o.now&&o.now()!==1/0&&(t=!0)}catch(e){r.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(t){r.perfNow=!0;var i=Math.floor(100*o.now())%10;(i<0||i>9)&&(i=0);for(var u=0;u<i;u+=1)Math.random()}}catch(e){r.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return r}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=15&e[n];return n+=1,("x"===r?t:3&t|8).toString(16)}),r]}},function(e,r,n){"use strict";n.r(r),function(e,t){n.d(r,"testEmitter",function(){return o});var o=void 0;function a(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var i=void 0!==e&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,u=void 0!==t&&t.global===t;if(i||u){var c,l;try{c=require}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{l=c("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}if(o=new(c("events").EventEmitter),t.Worker=function(){function e(e){var r=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=r._onmessage&&r._onmessage.call(r,a(e))},this._errorHandler=function(e){null!=r._onerror&&r._onerror.call(r,function(e,r){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:r}):{type:"error",message:e,error:r,preventDefault:function(){}}}(e.message,e))},this._worker=new l.Worker(e),this._worker.on("exit",function(e){o.emit("workerdestroyed",r)}),o.emit("workercreated",this)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!l.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var s=function(){function r(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(r){null!=e._onmessage&&e._onmessage.call(e,a(r))}}return Object.defineProperty(r.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?l.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&l.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),r.prototype.postMessage=function(e,r){l.parentPort.postMessage(e)},r.prototype.close=function(){e.exit()},r}();t.DedicatedWorkerGlobalScope=s,t.self=new s,t.importScripts=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=c("vm"),t=c("fs");e.forEach(function(e){var r=t.readFileSync(e,"utf-8");n.runInThisContext(r)})}}}}}.call(this,n(10),n(11))},function(e,r){var n,t,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(r){try{return n.call(null,e,0)}catch(r){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var c,l=[],s=!1,f=-1;function d(){s&&c&&(s=!1,c.length?l=c.concat(l):f=-1,l.length&&p())}function p(){if(!s){var e=u(d);s=!0;for(var r=l.length;r;){for(c=l,l=[];++f<r;)c&&c[f].run();f=-1,r=l.length}c=null,s=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(r){try{return t.call(null,e)}catch(r){return t.call(this,e)}}}(e)}}function E(e,r){this.fun=e,this.array=r}function h(){}o.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];l.push(new E(e,r)),1!==l.length||s||u(p)},E.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,r,n){"use strict";n.r(r);var t={};n.r(t),n.d(t,"createParseGlobals",function(){return pt}),n.d(t,"ReasonKind",function(){return Et}),n.d(t,"notImplemented",function(){return dt}),n.d(t,"notFormulaString",function(){return ht}),n.d(t,"createParser",function(){return Eu}),n.d(t,"parseResultHelper",function(){return Cu});var o={};n.r(o),n.d(o,"createAnalyzeGlobals",function(){return Au}),n.d(o,"createAnalyzer",function(){return Ic});var a={};n.r(a),n.d(a,"fastMathpack",function(){return bc}),n.d(a,"createCompiler",function(){return us}),n.d(a,"createEvaluator",function(){return qd}),n.d(a,"createFormulaInspector",function(){return ap}),n.d(a,"ReasonKind",function(){return dl}),n.d(a,"CellKind",function(){return sl}),n.d(a,"Interrupt",function(){return fl}),n.d(a,"notImplemented",function(){return cl}),n.d(a,"finalValue",function(){return hl}),n.d(a,"pendingValue",function(){return vl}),n.d(a,"cellFormula",function(){return gl}),n.d(a,"unavailable",function(){return ll}),n.d(a,"unevaluated",function(){return Tl}),n.d(a,"stopped",function(){return ml}),n.d(a,"nameCycle",function(){return Rl}),n.d(a,"cellCycle",function(){return Il}),n.d(a,"paused",function(){return Nl}),n.d(a,"previousFailure",function(){return Cl}),n.d(a,"javaScriptError",function(){return Al}),n.d(a,"evalGlobals",function(){return Sl}),n.d(a,"getEvalFailureReason",function(){return Ol}),n.d(a,"illFormedFormula",function(){return El}),n.d(a,"createCompileGlobals",function(){return pl}),n.d(a,"extractResultValue",function(){return xl}),n.d(a,"evalToCellValue",function(){return Vl}),n.d(a,"getBasicFirstOrderFunc",function(){return vE}),n.d(a,"extension",function(){return pE});var i={};n.r(i),n.d(i,"WorkerKind",function(){return Ah}),n.d(i,"ErrorKind",function(){return Nh}),n.d(i,"isWorkerSupported",function(){return sv}),n.d(i,"createWorker",function(){return dv}),n.d(i,"tryCreateWorker",function(){return pv}),n.d(i,"dedicatedWorkerInsideInit",function(){return hv}),n.d(i,"runSmokeTest",function(){return Cv}),n.d(i,"cancelSmokeTest",function(){return Rv}),n.d(i,"smokeTestInsideDef",function(){return vv});var u={};n.r(u),n.d(u,"recalcMapper",function(){return HE}),n.d(u,"mapperContext",function(){return KE}),n.d(u,"formulaCacheGlobals",function(){return eh}),n.d(u,"formulaCache",function(){return rh}),n.d(u,"createFormatInfo",function(){return $E}),n.d(u,"worksheetFunctionName",function(){return ah}),n.d(u,"localeData",function(){return uh}),n.d(u,"numberFormat",function(){return ch}),n.d(u,"sheetName",function(){return lh}),n.d(u,"blankValue",function(){return sh}),n.d(u,"errorValue",function(){return fh}),n.d(u,"richValue",function(){return dh}),n.d(u,"cellLocation",function(){return ph}),n.d(u,"rangeLocation",function(){return Eh}),n.d(u,"sheetRangeLocation",function(){return hh}),n.d(u,"cellData",function(){return vh}),n.d(u,"rangeUpdate",function(){return gh}),n.d(u,"rangeWrite",function(){return mh}),n.d(u,"rangePromote",function(){return Th}),n.d(u,"arrayData",function(){return Sh}),n.d(u,"arrayUpdate",function(){return Rh}),n.d(u,"arrayWrite",function(){return Ih}),n.d(u,"arrayPromote",function(){return Ch}),n.d(u,"rangeFormulaEdit",function(){return Lh}),n.d(u,"arrayFormulaEdit",function(){return kh}),n.d(u,"inferredFormat",function(){return Dh}),n.d(u,"cellDataDelta",function(){return Mh}),n.d(u,"rangeDelta",function(){return _h}),n.d(u,"arrayDelta",function(){return Fh}),n.d(u,"rangeFailure",function(){return bh}),n.d(u,"recalcResults",function(){return Uh}),n.d(u,"updateRequest",function(){return wh}),n.d(u,"createRecalcService",function(){return Ov}),n.d(u,"recalcServiceInsideDef",function(){return Av});var c={};n.r(c),n.d(c,"getBasicFirstOrderFunc",function(){return vE}),n.d(c,"makeGetFirstOrderFunc",function(){return gE});var l={};n.r(l),n.d(l,"Workbook",function(){return Yv}),n.d(l,"DataCell",function(){return kv}),n.d(l,"FormulaCell",function(){return Mv}),n.d(l,"FailedCell",function(){return _v}),n.d(l,"emptyCell",function(){return Dv}),n.d(l,"Worksheet",function(){return bv});var s=n(0);function f(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function d(e){return e}function p(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=E(e[n],n));return r}function E(e,r){if("string"==typeof r&&null!=g[r])return e;var n=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var n=e.kind;if("string"==typeof n)return n}return r}(e),t=m[n];return null!=t?t(e,r):"object"==typeof e?p(e):"<unexpected>"}function h(e){try{var r=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(r=e.kind)||"Array"===r||"App"===r||"Paren"===r||"Name"===r||"CellRef"===r||"Bad"===r||"Operator"===r))return"FormulaNode"}var r}(e);if(void 0!==r){var n=T[r](e);return void 0!==n?n:JSON.stringify(E(e,void 0))}return JSON.stringify(E(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var v,g={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},m={boolean:d,symbol:d,undefined:d,null:d,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:p,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(E):"<unexpected>"}},T={},S={ULS:new s.NulLogger};function R(e){S.ULS=e}function I(e,r){var n=e+": code should be unreachable because a value has type 'never'; given "+h(r);return S.ULS.assertTag(595980872,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}function C(e){return S.ULS.assertTag(595980873,s.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!f(r)||r<0)&&C(e+": expected natural number; given "+h(r))}function N(e,r){(!f(r)||r<=0)&&C(e+": expected positive integer; given "+h(r))}function O(e,r,n){(!f(r)||r<0||r>=n)&&C(e+": expected natural number less than "+h(n)+"; given "+h(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(v||(v={}));var y=L(void 0,"");function L(e,r){return{path:e,name:r}}function k(e,r,n){return{document:e,index:r,length:n}}function D(e,r,n){return A("calc.lang.sheetRange",r),N("calc.lang.sheetRange",n),k(e,r,n)}function M(e,r){return A("calc.lang.sheetIndex",r),k(e,r,1)}function _(e,r,n,t){return{row:e,col:r,rows:n,cols:t}}function F(e,r,n,t){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),N("calc.lang.gridRange",n),N("calc.lang.gridRange",t),_(e,r,n,t)}function b(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),_(e,r,1,1)}function U(e,r){return{sheet:e,range:r}}var w,P,B,x,V,W,G=U,H=U,K=U;function j(e){return{document:e,index:void 0}}function Q(e,r){return{scope:e,name:r}}function J(e,r,n,t,o,a){(A("calc.lang.functionType",e),0===n.length&&r.length<e)&&C("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:n,returnType:t,staticPrecs:o,flags:a}}function X(e,r,n,t){return{cells:e,names:r,special:n,isExact:t}}function Y(e){return{kind:w.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(w||(w={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(B||(B={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(x||(x={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=9]="FIELD"}(V||(V={})),function(e){e[e.First=1]="First",e[e.Last=9]="Last"}(W||(W={}));var q=Y(V.NULL),z=Y(V.DIV0),Z=Y(V.VALUE),$=Y(V.REF),ee=Y(V.NAME),re=Y(V.NUM),ne=Y(V.NA),te=Y(V.GETTING_DATA),oe=Y(V.FIELD);function ae(e,r,n){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),n.length!==e?C("calc.lang.arrayOper: Inconsistent row number"):{kind:w.Array,rows:e,cols:r,opers:n}}function ie(e,r){return N("calc.lang.rangeSeqOper",r.length),{kind:w.Range,sheets:e,ranges:r}}function ue(e,r){return{kind:w.Range,sheets:e,ranges:[r]}}var ce,le,se,fe,de,pe,Ee={kind:w.Missing},he={kind:w.Blank};function ve(e){return void 0===e&&(e=0),{kind:le.Error,isQuoted:!1,label:e}}function ge(e){return void 0===e&&(e=0),{kind:le.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(ce||(ce={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(le||(le={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(se||(se={})),function(e){e.Abs="Abs",e.Rel="Rel"}(fe||(fe={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(de||(de={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(pe||(pe={}));var me=ve(),Te=ge();function Se(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.Document,isQuoted:n,label:t,document:e,path:r}}function Re(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.Sheet,isQuoted:n,label:t,sheet:e,document:r}}function Ie(e,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:le.Ident,isQuoted:r,label:n,name:e}}function Ce(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.SheetRange,isQuoted:n,label:t,sheet1:e,sheet2:r}}function Ae(e,r){return{kind:e,index:r}}function Ne(e){return void 0===e&&(e=0),{kind:se.Error,label:e}}var Oe,ye=Ne();function Le(e,r,n){return void 0===n&&(n=0),{kind:se.Single,label:n,row:e,col:r}}function ke(e,r,n){return void 0===n&&(n=0),{kind:se.Range,label:n,ref1:e,ref2:r}}function De(e,r,n){return void 0===n&&(n=0),{kind:se.Row,label:n,row1:e,row2:r}}function Me(e,r,n){return void 0===n&&(n=0),{kind:se.Col,label:n,col1:e,col2:r}}function _e(e,r){return{node:e,spans:r}}function Fe(e,r,n,t){var o,a;return A("calc.lang.formulaSpan",e),o="calc.lang.formulaSpan",f(a=r)||C(o+": expected integer; given "+h(a)),r<e&&C("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:n,post:t}}function be(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Literal,label:n,oper:e,isClosed:r}}function Ue(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Array,label:n,nodes:e,isClosed:r}}function we(e,r,n,t){return void 0===n&&(n=!0),void 0===t&&(t=0),{kind:de.App,label:t,head:e,args:r,isClosed:n}}function Pe(e,r){return void 0===r&&(r=0),{kind:de.Operator,label:r,id:e}}function Be(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Paren,label:n,node:e,isClosed:r}}function xe(e,r,n){return void 0===n&&(n=0),{kind:de.Name,label:n,whole:e,qualifier:r}}function Ve(e,r,n){return void 0===n&&(n=0),{kind:de.CellRef,label:n,ref:e,qualifier:r}}function We(e,r,n){return void 0===n&&(n=0),{kind:de.Bad,label:n,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.RECORDTEST=614]="RECORDTEST",e[e.GRF=615]="GRF",e[e.UNIT=616]="UNIT",e[e.RICHERROR=617]="RICHERROR",e[e.FILTER=618]="FILTER",e[e.FUN=619]="FUN",e[e.LET=620]="LET",e[e.ARRAYMAKE=621]="ARRAYMAKE",e[e.APPLY=622]="APPLY",e[e.ISFUN=623]="ISFUN",e[e.ARITY=624]="ARITY",e[e.RECURSE=625]="RECURSE",e[e.FIELDVALUE=626]="FIELDVALUE"}(Oe||(Oe={}));var Ge=[];Ge[Oe.COUNT]=J(1,[],[57],1,0,0),Ge[Oe.IF]=J(1,[36,575,575],[],567,0,0),Ge[Oe.ISNA]=J(1,[15],[],4,0,0),Ge[Oe.ISERROR]=J(1,[15],[],4,0,0),Ge[Oe.SUM]=J(1,[],[49],1,0,0),Ge[Oe.AVERAGE]=J(1,[],[49],1,0,0),Ge[Oe.MIN]=J(1,[],[49],1,0,0),Ge[Oe.MAX]=J(1,[],[49],1,0,0),Ge[Oe.ROW]=J(0,[16],[],33,0,0),Ge[Oe.COLUMN]=J(0,[16],[],33,0,0),Ge[Oe.NA]=J(0,[],[],3,0,0),Ge[Oe.NPV]=J(2,[1],[49],1,0,0),Ge[Oe.STDEV]=J(1,[],[49],1,0,0),Ge[Oe.DOLLAR]=J(1,[1,1],[],2,0,0),Ge[Oe.FIXED]=J(1,[1,65,4],[],2,0,0),Ge[Oe.SIN]=J(1,[1],[],1,0,0),Ge[Oe.COS]=J(1,[1],[],1,0,0),Ge[Oe.TAN]=J(1,[1],[],1,0,0),Ge[Oe.ATAN]=J(1,[1],[],1,0,0),Ge[Oe.PI]=J(0,[],[],1,0,0),Ge[Oe.SQRT]=J(1,[1],[],1,0,0),Ge[Oe.EXP]=J(1,[1],[],1,0,0),Ge[Oe.LN]=J(1,[1],[],1,0,0),Ge[Oe.LOG10]=J(1,[1],[],1,0,0),Ge[Oe.ABS]=J(1,[1],[],1,0,0),Ge[Oe.INT]=J(1,[1],[],1,0,0),Ge[Oe.SIGN]=J(1,[1],[],1,0,0),Ge[Oe.ROUND]=J(2,[1,1],[],1,0,0),Ge[Oe.LOOKUP]=J(2,[7,48,48],[],7,0,0),Ge[Oe.INDEX]=J(2,[48,1,1,1],[],55,0,0),Ge[Oe.REPT]=J(2,[2,1],[],2,0,0),Ge[Oe.MID]=J(3,[2,1,1],[],2,0,0),Ge[Oe.LEN]=J(1,[2],[],1,0,0),Ge[Oe.VALUE]=J(1,[7],[],1,0,0),Ge[Oe.TRUE]=J(0,[],[],4,0,0),Ge[Oe.FALSE]=J(0,[],[],4,0,0),Ge[Oe.AND]=J(1,[],[52],4,0,0),Ge[Oe.OR]=J(1,[],[52],4,0,0),Ge[Oe.NOT]=J(1,[4],[],4,0,0),Ge[Oe.MOD]=J(2,[1,1],[],1,0,0),Ge[Oe.DCOUNT]=J(3,[16,83,18],[],1,0,0),Ge[Oe.DSUM]=J(3,[16,19,18],[],1,0,0),Ge[Oe.DAVERAGE]=J(3,[16,19,18],[],1,0,0),Ge[Oe.DMIN]=J(3,[16,19,18],[],1,0,0),Ge[Oe.DMAX]=J(3,[16,19,18],[],1,0,0),Ge[Oe.DSTDEV]=J(3,[16,19,18],[],1,0,0),Ge[Oe.VAR]=J(1,[],[49],1,0,0),Ge[Oe.DVAR]=J(3,[16,19,18],[],1,0,0),Ge[Oe.TEXT]=J(2,[7,2],[],2,0,0),Ge[Oe.LINEST]=J(1,[48,112,84,84],[],32,0,0),Ge[Oe.TREND]=J(1,[48,112,112,84],[],32,0,0),Ge[Oe.LOGEST]=J(1,[48,112,84,84],[],32,0,0),Ge[Oe.GROWTH]=J(1,[48,112,112,84],[],32,0,0),Ge[Oe.GOTO]=J(1,[16],[],512,0,2),Ge[Oe.HALT]=J(0,[4],[],512,0,2),Ge[Oe.RETURN]=J(0,[575],[],512,0,2),Ge[Oe.PV]=J(3,[1,1,1,1,1],[],1,0,0),Ge[Oe.FV]=J(3,[1,1,1,1,1],[],1,0,0),Ge[Oe.NPER]=J(3,[1,1,1,1,1],[],1,0,0),Ge[Oe.PMT]=J(3,[1,1,1,1,1],[],1,0,0),Ge[Oe.RATE]=J(3,[1,1,1,1,1,1],[],1,0,0),Ge[Oe.MIRR]=J(3,[48,1,1],[],1,0,0),Ge[Oe.IRR]=J(1,[48,1],[],1,0,0),Ge[Oe.RAND]=J(0,[],[],1,4095,0),Ge[Oe.MATCH]=J(2,[7,49,17],[],1,0,0),Ge[Oe.DATE]=J(3,[1,1,1],[],1,0,0),Ge[Oe.TIME]=J(3,[1,1,1],[],1,0,0),Ge[Oe.DAY]=J(1,[1],[],1,0,0),Ge[Oe.MONTH]=J(1,[1],[],1,0,0),Ge[Oe.YEAR]=J(1,[1],[],1,0,0),Ge[Oe.WEEKDAY]=J(1,[1,1],[],1,0,0),Ge[Oe.HOUR]=J(1,[1],[],1,0,0),Ge[Oe.MINUTE]=J(1,[1],[],1,0,0),Ge[Oe.SECOND]=J(1,[1],[],1,0,0),Ge[Oe.NOW]=J(0,[],[],1,4095,0),Ge[Oe.AREAS]=J(1,[16],[],1,0,0),Ge[Oe.ROWS]=J(1,[48],[],1,0,0),Ge[Oe.COLUMNS]=J(1,[48],[],1,0,0),Ge[Oe.OFFSET]=J(3,[16,65,65,65,65],[],16,4095,0),Ge[Oe.ABSREF]=J(2,[2,16],[],16,0,2),Ge[Oe.RELREF]=J(2,[16,16],[],2,0,2),Ge[Oe.ARGUMENT]=J(0,[66,81,16],[],4,0,2),Ge[Oe.SEARCH]=J(2,[2,2,1],[],1,0,0),Ge[Oe.TRANSPOSE]=J(1,[39],[],32,0,0),Ge[Oe.ERROR]=J(0,[1,24],[],4,0,2),Ge[Oe.STEP]=J(0,[],[],4,0,2),Ge[Oe.TYPE]=J(1,[47],[],1,0,0),Ge[Oe.ECHO]=J(0,[4],[],4,0,2),Ge[Oe.SET_NAME]=J(1,[2,63],[],4,0,2),Ge[Oe.CALLER]=J(0,[],[],50,0,2),Ge[Oe.DEREF]=J(1,[16],[],47,0,2),Ge[Oe.WINDOWS]=J(0,[65,66],[],32,0,2),Ge[Oe.SERIES]=J(4,[87,117,117,1,117],[],4,0,0),Ge[Oe.DOCUMENTS]=J(0,[1,66],[],32,0,2),Ge[Oe.ACTIVE_CELL]=J(0,[],[],16,0,2),Ge[Oe.SELECTION]=J(0,[],[],16,0,2),Ge[Oe.RESULT]=J(0,[1],[],4,0,2),Ge[Oe.ATAN2]=J(2,[1,1],[],1,0,0),Ge[Oe.ASIN]=J(1,[1],[],1,0,0),Ge[Oe.ACOS]=J(1,[1],[],1,0,0),Ge[Oe.CHOOSE]=J(2,[33],[575],567,0,0),Ge[Oe.HLOOKUP]=J(3,[7,49,49,4],[],39,0,0),Ge[Oe.VLOOKUP]=J(3,[7,49,49,4],[],39,0,0),Ge[Oe.LINKS]=J(0,[66,65],[],32,0,2),Ge[Oe.INPUT]=J(1,[2,65,66,67,65,65,2],[],575,0,2),Ge[Oe.ISREF]=J(1,[63],[],4,0,0),Ge[Oe.GET_FORMULA]=J(1,[18],[],2,0,2),Ge[Oe.GET_NAME]=J(1,[2,4],[],6,0,2),Ge[Oe.SET_VALUE]=J(2,[16,47],[],4,0,2),Ge[Oe.LOG]=J(1,[1,1],[],1,0,0),Ge[Oe.EXEC]=J(1,[2,1,4,4],[],7,0,2),Ge[Oe.CHAR]=J(1,[1],[],2,0,0),Ge[Oe.LOWER]=J(1,[2],[],2,0,0),Ge[Oe.UPPER]=J(1,[2],[],2,0,0),Ge[Oe.PROPER]=J(1,[2],[],2,0,0),Ge[Oe.LEFT]=J(1,[2,9],[],2,0,0),Ge[Oe.RIGHT]=J(1,[2,9],[],2,0,0),Ge[Oe.EXACT]=J(2,[2,2],[],4,0,0),Ge[Oe.TRIM]=J(1,[2],[],2,0,0),Ge[Oe.REPLACE]=J(4,[2,1,1,2],[],2,0,0),Ge[Oe.SUBSTITUTE]=J(3,[2,2,2,2],[],2,0,0),Ge[Oe.CODE]=J(1,[2],[],1,0,0),Ge[Oe.NAMES]=J(0,[66,65,66],[],32,0,2),Ge[Oe.DIRECTORY]=J(0,[2],[],2,0,2),Ge[Oe.FIND]=J(2,[2,2,1],[],1,0,0),Ge[Oe.CELL]=J(1,[2,16],[],47,4095,0),Ge[Oe.ISERR]=J(1,[15],[],4,0,0),Ge[Oe.ISTEXT]=J(1,[143],[],4,0,0),Ge[Oe.ISNUMBER]=J(1,[143],[],4,0,0),Ge[Oe.ISBLANK]=J(1,[143],[],4,0,0),Ge[Oe.T]=J(1,[23],[],2,0,0),Ge[Oe.N]=J(1,[23],[],1,0,0),Ge[Oe.FOPEN]=J(1,[2,1],[],1,0,2),Ge[Oe.FCLOSE]=J(1,[1],[],1,0,2),Ge[Oe.FSIZE]=J(1,[1],[],1,0,2),Ge[Oe.FREADLN]=J(1,[1],[],2,0,2),Ge[Oe.FREAD]=J(2,[1,1],[],2,0,2),Ge[Oe.FWRITELN]=J(2,[1,2],[],1,0,2),Ge[Oe.FWRITE]=J(2,[1,2],[],1,0,2),Ge[Oe.FPOS]=J(1,[1,1],[],1,0,2),Ge[Oe.DATEVALUE]=J(1,[3],[],1,0,0),Ge[Oe.TIMEVALUE]=J(1,[3],[],1,0,0),Ge[Oe.SLN]=J(3,[1,1,1],[],1,0,0),Ge[Oe.SYD]=J(4,[1,1,1,1],[],1,0,0),Ge[Oe.DDB]=J(4,[1,1,1,1,1],[],1,0,0),Ge[Oe.GET_DEF]=J(1,[2,66,65],[],2,0,2),Ge[Oe.REFTEXT]=J(1,[16,4],[],2,0,2),Ge[Oe.TEXTREF]=J(1,[2,4],[],16,0,2),Ge[Oe.INDIRECT]=J(1,[2,4],[],16,4095,0),Ge[Oe.REGISTER]=J(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),Ge[Oe.CALL]=J(1,[3],[127],575,0,2),Ge[Oe.ADD_BAR]=J(0,[3],[],1,0,2),Ge[Oe.ADD_MENU]=J(2,[3,115,83,3],[],1,0,2),Ge[Oe.ADD_COMMAND]=J(3,[3,83,115,83,3],[],1,0,2),Ge[Oe.ENABLE_COMMAND]=J(4,[3,3,3,4,3],[],4,0,2),Ge[Oe.CHECK_COMMAND]=J(4,[3,3,3,4,3],[],4,0,2),Ge[Oe.RENAME_COMMAND]=J(4,[3,3,3,3,3],[],4,0,2),Ge[Oe.SHOW_BAR]=J(0,[3],[],4,0,2),Ge[Oe.DELETE_MENU]=J(2,[3,3,3],[],4,0,2),Ge[Oe.DELETE_COMMAND]=J(3,[3,3,3,3],[],4,0,2),Ge[Oe.GET_CHART_ITEM]=J(1,[1,67,66],[],1,0,2),Ge[Oe.DIALOG_BOX]=J(1,[52],[],36,0,2),Ge[Oe.CLEAN]=J(1,[2],[],2,0,0),Ge[Oe.MDETERM]=J(1,[32],[],1,0,0),Ge[Oe.MINVERSE]=J(1,[32],[],32,0,0),Ge[Oe.MMULT]=J(2,[32,32],[],32,0,0),Ge[Oe.FILES]=J(0,[2,2],[],32,0,2),Ge[Oe.IPMT]=J(4,[1,1,1,1,1,1],[],1,0,0),Ge[Oe.PPMT]=J(4,[1,1,1,1,1,1],[],1,0,0),Ge[Oe.COUNTA]=J(1,[],[121],1,0,0),Ge[Oe.CANCEL_KEY]=J(0,[1,16],[],4,0,2),Ge[Oe.FOR]=J(3,[2,1,1,1],[],512,0,2),Ge[Oe.WHILE]=J(1,[4],[],512,0,2),Ge[Oe.BREAK]=J(0,[],[],512,0,2),Ge[Oe.NEXT]=J(0,[],[],512,0,2),Ge[Oe.INITIATE]=J(2,[2,2],[],1,0,2),Ge[Oe.REQUEST]=J(2,[1,2],[],32,0,2),Ge[Oe.POKE]=J(3,[1,18,18],[],4,0,2),Ge[Oe.EXECUTE]=J(2,[1,2],[],4,0,2),Ge[Oe.TERMINATE]=J(1,[1],[],4,0,2),Ge[Oe.RESTART]=J(0,[1],[],512,0,2),Ge[Oe.HELP]=J(0,[2],[],4,0,2),Ge[Oe.GET_BAR]=J(0,[3,3,3,3],[],3,0,2),Ge[Oe.PRODUCT]=J(1,[],[113],1,0,0),Ge[Oe.FACT]=J(1,[1],[],1,0,0),Ge[Oe.GET_CELL]=J(1,[1,16],[],47,0,2),Ge[Oe.GET_WORKSPACE]=J(1,[1],[],47,0,2),Ge[Oe.GET_WINDOW]=J(1,[1,2],[],47,0,2),Ge[Oe.GET_DOCUMENT]=J(1,[1,2],[],63,0,2),Ge[Oe.DPRODUCT]=J(3,[16,19,18],[],1,0,0),Ge[Oe.ISNONTEXT]=J(1,[143],[],4,0,0),Ge[Oe.GET_NOTE]=J(0,[82,65,65],[],2,0,2),Ge[Oe.NOTE]=J(0,[66,82,17,17],[],1,0,2),Ge[Oe.STDEVP]=J(1,[],[49],1,0,0),Ge[Oe.VARP]=J(1,[],[49],1,0,0),Ge[Oe.DSTDEVP]=J(3,[16,19,18],[],1,0,0),Ge[Oe.DVARP]=J(3,[16,19,18],[],1,0,0),Ge[Oe.TRUNC]=J(1,[1,1],[],1,0,0),Ge[Oe.ISLOGICAL]=J(1,[143],[],4,0,0),Ge[Oe.DCOUNTA]=J(3,[16,83,18],[],1,0,0),Ge[Oe.DELETE_BAR]=J(1,[3],[],4,0,2),Ge[Oe.UNREGISTER]=J(1,[3],[],4,0,2),Ge[Oe.USDOLLAR]=J(1,[1,1],[],2,0,0),Ge[Oe.FINDB]=J(2,[2,2,1],[],1,0,0),Ge[Oe.SEARCHB]=J(2,[2,2,1],[],1,0,0),Ge[Oe.REPLACEB]=J(4,[2,1,1,2],[],2,0,0),Ge[Oe.LEFTB]=J(1,[2,9],[],2,0,0),Ge[Oe.RIGHTB]=J(1,[2,9],[],2,0,0),Ge[Oe.MIDB]=J(3,[2,1,1],[],2,0,0),Ge[Oe.LENB]=J(1,[2],[],1,0,0),Ge[Oe.ROUNDUP]=J(2,[1,1],[],1,0,0),Ge[Oe.ROUNDDOWN]=J(2,[1,1],[],1,0,0),Ge[Oe.ASC]=J(1,[2],[],2,0,0),Ge[Oe.DBCS]=J(1,[2],[],2,0,0),Ge[Oe.RANK]=J(2,[1,16,4],[],1,0,0),Ge[Oe.ADDRESS]=J(2,[1,65,65,68,66],[],2,0,0),Ge[Oe.DAYS360]=J(2,[1,1,4],[],1,0,0),Ge[Oe.TODAY]=J(0,[],[],1,4095,0),Ge[Oe.VDB]=J(5,[1,1,1,1,1,1,4],[],1,0,0),Ge[Oe.ELSE]=J(0,[],[],512,0,2),Ge[Oe.ELSE_IF]=J(1,[12],[],512,0,2),Ge[Oe.END_IF]=J(0,[],[],512,0,2),Ge[Oe.FOR_CELL]=J(1,[2,82,84],[],512,0,2),Ge[Oe.MEDIAN]=J(1,[],[49],1,0,0),Ge[Oe.SUMPRODUCT]=J(1,[],[32],1,0,0),Ge[Oe.SINH]=J(1,[1],[],1,0,0),Ge[Oe.COSH]=J(1,[1],[],1,0,0),Ge[Oe.TANH]=J(1,[1],[],1,0,0),Ge[Oe.ASINH]=J(1,[1],[],1,0,0),Ge[Oe.ACOSH]=J(1,[1],[],1,0,0),Ge[Oe.ATANH]=J(1,[1],[],1,0,0),Ge[Oe.DGET]=J(3,[16,19,18],[],7,0,0),Ge[Oe.CREATE_OBJECT]=J(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),Ge[Oe.VOLATILE]=J(0,[4],[],4,0,2),Ge[Oe.LAST_ERROR]=J(0,[],[],16,0,2),Ge[Oe.CUSTOM_UNDO]=J(0,[2,2],[],4,0,2),Ge[Oe.CUSTOM_REPEAT]=J(0,[2,2,2],[],4,0,2),Ge[Oe.FORMULA_CONVERT]=J(2,[2,23,23,23,23],[],2,0,2),Ge[Oe.GET_LINK_INFO]=J(2,[2,1,1,2],[],1,0,2),Ge[Oe.TEXT_BOX]=J(1,[2,66,65,65],[],1,0,2),Ge[Oe.INFO]=J(1,[2],[],3,4095,0),Ge[Oe.GROUP]=J(0,[],[],2,0,2),Ge[Oe.GET_OBJECT]=J(1,[1,2,1,1,1],[],47,0,2),Ge[Oe.DB]=J(4,[1,1,1,1,1],[],1,0,0),Ge[Oe.PAUSE]=J(0,[4],[],512,0,2),Ge[Oe.ERROR_CODE]=J(0,[],[],2,0,2),Ge[Oe.ALLOC_COUNT]=J(0,[],[],1,0,2),Ge[Oe.RESUME]=J(0,[1],[],512,0,2),Ge[Oe.FREQUENCY]=J(2,[48,48],[],32,0,0),Ge[Oe.ADD_TOOLBAR]=J(0,[66,96],[],2,0,2),Ge[Oe.DELETE_TOOLBAR]=J(1,[2],[],4,0,2),Ge[Oe._UDF]=J(1,[17],[127],575,0,0),Ge[Oe.RESET_TOOLBAR]=J(1,[3],[],4,0,2),Ge[Oe.EVALUATE]=J(1,[2],[],63,0,2),Ge[Oe.GET_TOOLBAR]=J(1,[1,3],[],47,0,2),Ge[Oe.GET_TOOL]=J(1,[1,3,1],[],47,0,2),Ge[Oe.SPELLING_CHECK]=J(1,[2,66,4],[],4,0,2),Ge[Oe.ERROR_TYPE]=J(1,[15],[],1,0,0),Ge[Oe.APP_TITLE]=J(0,[2],[],4,0,2),Ge[Oe.WINDOW_TITLE]=J(0,[2],[],4,0,2),Ge[Oe.SAVE_TOOLBAR]=J(0,[99,66],[],4,0,2),Ge[Oe.ENABLE_TOOL]=J(3,[3,1,4],[],4,0,2),Ge[Oe.PRESS_TOOL]=J(3,[3,1,4],[],4,0,2),Ge[Oe.REGISTER_ID]=J(2,[2,3,66],[],1,0,2),Ge[Oe.GET_PROJECT]=J(1,[1,2],[],35,0,2),Ge[Oe.AVEDEV]=J(1,[],[49],1,0,0),Ge[Oe.BETADIST]=J(3,[1,1,1,65,65],[],1,0,0),Ge[Oe.GAMMALN]=J(1,[1],[],1,0,0),Ge[Oe.BETAINV]=J(3,[1,1,1,65,65],[],1,0,0),Ge[Oe.BINOMDIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.CHIDIST]=J(2,[1,1],[],1,0,0),Ge[Oe.CHIINV]=J(2,[1,1],[],1,0,0),Ge[Oe.COMBIN]=J(2,[1,1],[],1,0,0),Ge[Oe.CONFIDENCE]=J(3,[1,1,1],[],1,0,0),Ge[Oe.CRITBINOM]=J(3,[1,1,1],[],1,0,0),Ge[Oe.EVEN]=J(1,[1],[],1,0,0),Ge[Oe.EXPONDIST]=J(3,[1,1,4],[],1,0,0),Ge[Oe.FDIST]=J(3,[1,1,1],[],1,0,0),Ge[Oe.FINV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.FISHER]=J(1,[1],[],1,0,0),Ge[Oe.FISHERINV]=J(1,[1],[],1,0,0),Ge[Oe.FLOOR]=J(2,[1,1],[],1,0,0),Ge[Oe.GAMMADIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.GAMMAINV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.CEILING]=J(2,[1,1],[],1,0,0),Ge[Oe.HYPGEOMDIST]=J(4,[1,1,1,1],[],1,0,0),Ge[Oe.LOGNORMDIST]=J(3,[1,1,1],[],1,0,0),Ge[Oe.LOGINV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.NEGBINOMDIST]=J(3,[1,1,1],[],1,0,0),Ge[Oe.NORMDIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.NORMSDIST]=J(1,[1],[],1,0,0),Ge[Oe.NORMINV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.NORMSINV]=J(1,[1],[],1,0,0),Ge[Oe.STANDARDIZE]=J(3,[1,1,1],[],1,0,0),Ge[Oe.ODD]=J(1,[1],[],1,0,0),Ge[Oe.PERMUT]=J(2,[1,1],[],1,0,0),Ge[Oe.POISSON]=J(3,[1,1,4],[],1,0,0),Ge[Oe.TDIST]=J(3,[1,1,1],[],1,0,0),Ge[Oe.WEIBULL]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.SUMXMY2]=J(2,[32,32],[],1,0,0),Ge[Oe.SUMX2MY2]=J(2,[32,32],[],1,0,0),Ge[Oe.SUMX2PY2]=J(2,[32,32],[],1,0,0),Ge[Oe.CHITEST]=J(2,[32,32],[],1,0,0),Ge[Oe.CORREL]=J(2,[32,32],[],1,0,0),Ge[Oe.COVAR]=J(2,[32,32],[],1,0,0),Ge[Oe.FORECAST]=J(3,[1,32,32],[],1,0,0),Ge[Oe.FTEST]=J(2,[32,32],[],1,0,0),Ge[Oe.INTERCEPT]=J(2,[32,32],[],1,0,0),Ge[Oe.PEARSON]=J(2,[32,32],[],1,0,0),Ge[Oe.RSQ]=J(2,[32,32],[],1,0,0),Ge[Oe.STEYX]=J(2,[32,32],[],1,0,0),Ge[Oe.SLOPE]=J(2,[32,32],[],1,0,0),Ge[Oe.TTEST]=J(4,[32,32,1,1],[],1,0,0),Ge[Oe.PROB]=J(3,[32,32,1,65],[],1,0,0),Ge[Oe.DEVSQ]=J(1,[],[49],1,0,0),Ge[Oe.GEOMEAN]=J(1,[],[49],1,0,0),Ge[Oe.HARMEAN]=J(1,[],[49],1,0,0),Ge[Oe.SUMSQ]=J(1,[],[49],1,0,0),Ge[Oe.KURT]=J(1,[],[49],1,0,0),Ge[Oe.SKEW]=J(1,[],[49],1,0,0),Ge[Oe.ZTEST]=J(2,[49,1,1],[],1,0,0),Ge[Oe.LARGE]=J(2,[49,1],[],1,0,0),Ge[Oe.SMALL]=J(2,[49,1],[],1,0,0),Ge[Oe.QUARTILE]=J(2,[49,1],[],1,0,0),Ge[Oe.PERCENTILE]=J(2,[49,1],[],1,0,0),Ge[Oe.PERCENTRANK]=J(2,[49,1,65],[],1,0,0),Ge[Oe.MODE]=J(1,[],[32],1,0,0),Ge[Oe.TRIMMEAN]=J(2,[49,1],[],1,0,0),Ge[Oe.TINV]=J(2,[1,1],[],1,0,0),Ge[Oe.MOVIE_COMMAND]=J(3,[2,1,1,1],[],1,0,2),Ge[Oe.GET_MOVIE]=J(2,[2,1,1],[],1,0,2),Ge[Oe.CONCATENATE]=J(1,[],[2],2,0,0),Ge[Oe.POWER]=J(2,[1,1],[],1,0,0),Ge[Oe.SPREADBASE_DATA_FIELD]=J(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),Ge[Oe.GET_VIEW]=J(1,[1,2],[],35,0,2),Ge[Oe.GET_FIELD]=J(1,[1,66,2],[],35,0,2),Ge[Oe.GET_ITEM]=J(1,[1,66,66,2],[],7,0,2),Ge[Oe.RADIANS]=J(1,[1],[],1,0,0),Ge[Oe.DEGREES]=J(1,[1],[],1,0,0),Ge[Oe.SUBTOTAL]=J(2,[1],[16],1,0,0),Ge[Oe.SUMIF]=J(2,[16,15,16],[],1,0,0),Ge[Oe.COUNTIF]=J(2,[16,15],[],1,0,0),Ge[Oe.COUNTBLANK]=J(1,[16],[],1,0,0),Ge[Oe.SCENARIO_GET]=J(1,[1,2],[],19,0,2),Ge[Oe.OPTIONS_LISTS]=J(1,[33],[],33,0,2),Ge[Oe.ISPMT]=J(4,[1,1,1,1],[],1,0,0),Ge[Oe.DATEDIF]=J(3,[1,1,2],[],1,0,0),Ge[Oe.DATESTRING]=J(1,[1],[],2,0,0),Ge[Oe.NUMBERSTRING]=J(2,[1,1],[],2,0,0),Ge[Oe.ROMAN]=J(1,[1,5],[],2,0,0),Ge[Oe.OPENDIALOG]=J(0,[66,66,66,65],[],6,0,2),Ge[Oe.SAVEDIALOG]=J(0,[66,66,66,66,65],[],6,0,2),Ge[Oe.VIEW_GET]=J(1,[1,2],[],19,0,2),Ge[Oe.GETPIVOTDATA]=J(2,[18,18],[2,79],15,0,0),Ge[Oe.HYPERLINK]=J(1,[2,39],[],39,0,0),Ge[Oe.FURIGANA]=J(1,[16],[],2,0,0),Ge[Oe.AVERAGEA]=J(1,[],[49],1,0,0),Ge[Oe.MAXA]=J(1,[],[49],1,0,0),Ge[Oe.MINA]=J(1,[],[49],1,0,0),Ge[Oe.STDEVPA]=J(1,[],[49],1,0,0),Ge[Oe.VARPA]=J(1,[],[49],1,0,0),Ge[Oe.STDEVA]=J(1,[],[49],1,0,0),Ge[Oe.VARA]=J(1,[],[49],1,0,0),Ge[Oe.BAHTTEXT]=J(1,[1],[],2,0,0),Ge[Oe.THAIDOW]=J(1,[1],[],2,0,0),Ge[Oe.THAIDIGIT]=J(1,[3],[],2,0,0),Ge[Oe.THAIMOY]=J(1,[1],[],2,0,0),Ge[Oe.THAINUMSOUND]=J(1,[1],[],2,0,0),Ge[Oe.THAINUMSTRING]=J(1,[1],[],2,0,0),Ge[Oe.THAISTRINGLENGTH]=J(1,[2],[],1,0,0),Ge[Oe.ISTHAIDIGIT]=J(1,[2],[],4,0,0),Ge[Oe.ROUNDBAHTDOWN]=J(1,[1],[],1,0,0),Ge[Oe.ROUNDBAHTUP]=J(1,[1],[],1,0,0),Ge[Oe.THAIYEAR]=J(1,[1],[],1,0,0),Ge[Oe.RTD]=J(3,[],[2],2,0,0),Ge[Oe.CUBEVALUE]=J(1,[2],[50],15,0,0),Ge[Oe.CUBEMEMBER]=J(2,[2,50,2],[],10,0,0),Ge[Oe.CUBEMEMBERPROPERTY]=J(3,[2,2,2],[],15,0,0),Ge[Oe.CUBERANKEDMEMBER]=J(3,[2,2,1,2],[],10,0,0),Ge[Oe.HEX2BIN]=J(1,[95,95],[],9,0,0),Ge[Oe.HEX2DEC]=J(1,[95],[],9,0,0),Ge[Oe.HEX2OCT]=J(1,[95,95],[],9,0,0),Ge[Oe.DEC2BIN]=J(1,[95,95],[],9,0,0),Ge[Oe.DEC2HEX]=J(1,[95,95],[],9,0,0),Ge[Oe.DEC2OCT]=J(1,[95,95],[],9,0,0),Ge[Oe.OCT2BIN]=J(1,[95,95],[],9,0,0),Ge[Oe.OCT2HEX]=J(1,[95,95],[],9,0,0),Ge[Oe.OCT2DEC]=J(1,[95],[],9,0,0),Ge[Oe.BIN2DEC]=J(1,[95],[],9,0,0),Ge[Oe.BIN2OCT]=J(1,[95,95],[],9,0,0),Ge[Oe.BIN2HEX]=J(1,[95,95],[],9,0,0),Ge[Oe.IMSUB]=J(2,[95,95],[],9,0,0),Ge[Oe.IMDIV]=J(2,[95,95],[],9,0,0),Ge[Oe.IMPOWER]=J(2,[95,95],[],9,0,0),Ge[Oe.IMABS]=J(1,[95],[],9,0,0),Ge[Oe.IMSQRT]=J(1,[95],[],9,0,0),Ge[Oe.IMLN]=J(1,[95],[],9,0,0),Ge[Oe.IMLOG2]=J(1,[95],[],9,0,0),Ge[Oe.IMLOG10]=J(1,[95],[],9,0,0),Ge[Oe.IMSIN]=J(1,[95],[],9,0,0),Ge[Oe.IMCOS]=J(1,[95],[],9,0,0),Ge[Oe.IMEXP]=J(1,[95],[],9,0,0),Ge[Oe.IMARGUMENT]=J(1,[95],[],9,0,0),Ge[Oe.IMCONJUGATE]=J(1,[95],[],9,0,0),Ge[Oe.IMAGINARY]=J(1,[95],[],9,0,0),Ge[Oe.IMREAL]=J(1,[95],[],9,0,0),Ge[Oe.COMPLEX]=J(2,[95,95,95],[],9,0,0),Ge[Oe.IMSUM]=J(1,[],[127],9,0,0),Ge[Oe.IMPRODUCT]=J(1,[],[127],9,0,0),Ge[Oe.SERIESSUM]=J(4,[95,95,95,127],[],9,0,0),Ge[Oe.FACTDOUBLE]=J(1,[95],[],9,0,0),Ge[Oe.SQRTPI]=J(1,[95],[],9,0,0),Ge[Oe.QUOTIENT]=J(2,[95,95],[],9,0,0),Ge[Oe.DELTA]=J(1,[95,95],[],9,0,0),Ge[Oe.GESTEP]=J(1,[95,95],[],9,0,0),Ge[Oe.ISEVEN]=J(1,[95],[],9,0,0),Ge[Oe.ISODD]=J(1,[95],[],9,0,0),Ge[Oe.MROUND]=J(2,[95,95],[],9,0,0),Ge[Oe.ERF]=J(1,[95,95],[],9,0,0),Ge[Oe.ERFC]=J(1,[95],[],9,0,0),Ge[Oe.BESSELJ]=J(2,[95,95],[],9,0,0),Ge[Oe.BESSELK]=J(2,[95,95],[],9,0,0),Ge[Oe.BESSELY]=J(2,[95,95],[],9,0,0),Ge[Oe.BESSELI]=J(2,[95,95],[],9,0,0),Ge[Oe.XIRR]=J(2,[127,127,95],[],9,0,0),Ge[Oe.XNPV]=J(3,[95,127,127],[],9,0,0),Ge[Oe.PRICEMAT]=J(5,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.YIELDMAT]=J(5,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.INTRATE]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.RECEIVED]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.DISC]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.PRICEDISC]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.YIELDDISC]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.TBILLEQ]=J(3,[95,95,95],[],9,0,0),Ge[Oe.TBILLPRICE]=J(3,[95,95,95],[],9,0,0),Ge[Oe.TBILLYIELD]=J(3,[95,95,95],[],9,0,0),Ge[Oe.PRICE]=J(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.YIELD]=J(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.DOLLARDE]=J(2,[95,95],[],9,0,0),Ge[Oe.DOLLARFR]=J(2,[95,95],[],9,0,0),Ge[Oe.NOMINAL]=J(2,[95,95],[],9,0,0),Ge[Oe.EFFECT]=J(2,[95,95],[],9,0,0),Ge[Oe.CUMPRINC]=J(6,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.CUMIPMT]=J(6,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.EDATE]=J(2,[95,95],[],9,0,0),Ge[Oe.EOMONTH]=J(2,[95,95],[],9,0,0),Ge[Oe.YEARFRAC]=J(2,[95,95,95],[],9,0,0),Ge[Oe.COUPDAYBS]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.COUPDAYS]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.COUPDAYSNC]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.COUPNCD]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.COUPNUM]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.COUPPCD]=J(3,[95,95,95,95],[],9,0,0),Ge[Oe.DURATION]=J(5,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.MDURATION]=J(5,[95,95,95,95,95,95],[],9,0,0),Ge[Oe.ODDLPRICE]=J(7,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.ODDLYIELD]=J(7,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.ODDFPRICE]=J(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.ODDFYIELD]=J(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.RANDBETWEEN]=J(2,[95,95],[],9,4095,0),Ge[Oe.WEEKNUM]=J(1,[95,95],[],9,0,0),Ge[Oe.AMORDEGRC]=J(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.AMORLINC]=J(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.CONVERT]=J(3,[95,95,95],[],9,0,0),Ge[Oe.ACCRINT]=J(6,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[Oe.ACCRINTM]=J(4,[95,95,95,95,95],[],9,0,0),Ge[Oe.WORKDAY]=J(2,[95,95,127],[],9,0,0),Ge[Oe.NETWORKDAYS]=J(2,[95,95,127],[],9,0,0),Ge[Oe.GCD]=J(1,[],[127],9,0,0),Ge[Oe.MULTINOMIAL]=J(1,[],[127],9,0,0),Ge[Oe.LCM]=J(1,[],[127],9,0,0),Ge[Oe.FVSCHEDULE]=J(2,[95,127],[],9,0,0),Ge[Oe.CUBEKPIMEMBER]=J(3,[2,2,1,2],[],10,0,0),Ge[Oe.CUBESET]=J(2,[2,50,2,1,2],[],10,0,0),Ge[Oe.CUBESETCOUNT]=J(1,[2],[],9,0,0),Ge[Oe.IFERROR]=J(2,[47,575],[],47,0,0),Ge[Oe.COUNTIFS]=J(2,[],[16,15],1,0,0),Ge[Oe.SUMIFS]=J(3,[16],[16,15],1,0,0),Ge[Oe.AVERAGEIF]=J(2,[16,15,16],[],1,0,0),Ge[Oe.AVERAGEIFS]=J(3,[16],[16,15],1,0,0),Ge[Oe.AGGREGATE]=J(3,[1,1,48,17],[16],1,0,0),Ge[Oe.BINOM_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.BINOM_INV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.CONFIDENCE_NORM]=J(3,[1,1,1],[],1,0,0),Ge[Oe.CONFIDENCE_T]=J(3,[1,1,1],[],1,0,0),Ge[Oe.CHISQ_TEST]=J(2,[32,32],[],1,0,0),Ge[Oe.F_TEST]=J(2,[32,32],[],1,0,0),Ge[Oe.COVARIANCE_P]=J(2,[32,32],[],1,0,0),Ge[Oe.COVARIANCE_S]=J(2,[32,32],[],1,0,0),Ge[Oe.EXPON_DIST]=J(3,[1,1,4],[],1,0,0),Ge[Oe.GAMMA_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.GAMMA_INV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.MODE_MULT]=J(1,[],[32],32,0,0),Ge[Oe.MODE_SNGL]=J(1,[],[32],1,0,0),Ge[Oe.NORM_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.NORM_INV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.PERCENTILE_EXC]=J(2,[49,1],[],1,0,0),Ge[Oe.PERCENTILE_INC]=J(2,[49,1],[],1,0,0),Ge[Oe.PERCENTRANK_EXC]=J(2,[49,1,65],[],1,0,0),Ge[Oe.PERCENTRANK_INC]=J(2,[49,1,65],[],1,0,0),Ge[Oe.POISSON_DIST]=J(3,[1,1,4],[],1,0,0),Ge[Oe.QUARTILE_EXC]=J(2,[49,1],[],1,0,0),Ge[Oe.QUARTILE_INC]=J(2,[49,1],[],1,0,0),Ge[Oe.RANK_AVG]=J(2,[1,16,4],[],1,0,0),Ge[Oe.RANK_EQ]=J(2,[1,16,4],[],1,0,0),Ge[Oe.STDEV_S]=J(1,[],[49],1,0,0),Ge[Oe.STDEV_P]=J(1,[],[49],1,0,0),Ge[Oe.T_DIST]=J(3,[1,1,4],[],1,0,0),Ge[Oe.T_DIST_2T]=J(2,[1,1],[],1,0,0),Ge[Oe.T_DIST_RT]=J(2,[1,1],[],1,0,0),Ge[Oe.T_INV]=J(2,[1,1],[],1,0,0),Ge[Oe.T_INV_2T]=J(2,[1,1],[],1,0,0),Ge[Oe.VAR_S]=J(1,[],[49],1,0,0),Ge[Oe.VAR_P]=J(1,[],[49],1,0,0),Ge[Oe.WEIBULL_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.NETWORKDAYS_INTL]=J(2,[95,95,75,127],[],9,0,0),Ge[Oe.WORKDAY_INTL]=J(2,[95,95,75,127],[],9,0,0),Ge[Oe.ECMA_CEILING]=J(2,[1,1],[],1,0,0),Ge[Oe.ISO_CEILING]=J(1,[1,65],[],1,0,0),Ge[Oe.DEBUG]=J(1,[2],[1151],1087,0,0),Ge[Oe.BETA_DIST]=J(4,[1,1,1,4,65,65],[],1,0,0),Ge[Oe.BETA_INV]=J(3,[1,1,1,65,65],[],1,0,0),Ge[Oe.CHISQ_DIST]=J(3,[1,1,4],[],1,0,0),Ge[Oe.CHISQ_DIST_RT]=J(2,[1,1],[],1,0,0),Ge[Oe.CHISQ_INV]=J(2,[1,1],[],1,0,0),Ge[Oe.CHISQ_INV_RT]=J(2,[1,1],[],1,0,0),Ge[Oe.F_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.F_DIST_RT]=J(3,[1,1,1],[],1,0,0),Ge[Oe.F_INV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.F_INV_RT]=J(3,[1,1,1],[],1,0,0),Ge[Oe.HYPGEOM_DIST]=J(5,[1,1,1,1,4],[],1,0,0),Ge[Oe.LOGNORM_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.LOGNORM_INV]=J(3,[1,1,1],[],1,0,0),Ge[Oe.NEGBINOM_DIST]=J(4,[1,1,1,4],[],1,0,0),Ge[Oe.NORM_S_DIST]=J(2,[1,4],[],1,0,0),Ge[Oe.NORM_S_INV]=J(1,[1],[],1,0,0),Ge[Oe.T_TEST]=J(4,[32,32,1,1],[],1,0,0),Ge[Oe.Z_TEST]=J(2,[49,1,1],[],1,0,0),Ge[Oe.ERF_PRECISE]=J(1,[95],[],9,0,0),Ge[Oe.ERFC_PRECISE]=J(1,[95],[],9,0,0),Ge[Oe.GAMMALN_PRECISE]=J(1,[1],[],1,0,0),Ge[Oe.CEILING_PRECISE]=J(1,[1,65],[],1,0,0),Ge[Oe.FLOOR_PRECISE]=J(1,[1,65],[],1,0,0),Ge[Oe.ACOT]=J(1,[1],[],1,0,0),Ge[Oe.ACOTH]=J(1,[1],[],1,0,0),Ge[Oe.COT]=J(1,[1],[],1,0,0),Ge[Oe.COTH]=J(1,[1],[],1,0,0),Ge[Oe.CSC]=J(1,[1],[],1,0,0),Ge[Oe.CSCH]=J(1,[1],[],1,0,0),Ge[Oe.SEC]=J(1,[1],[],1,0,0),Ge[Oe.SECH]=J(1,[1],[],1,0,0),Ge[Oe.IMTAN]=J(1,[95],[],9,0,0),Ge[Oe.IMCOT]=J(1,[95],[],9,0,0),Ge[Oe.IMCSC]=J(1,[95],[],9,0,0),Ge[Oe.IMCSCH]=J(1,[95],[],9,0,0),Ge[Oe.IMSEC]=J(1,[95],[],9,0,0),Ge[Oe.IMSECH]=J(1,[95],[],9,0,0),Ge[Oe.BITAND]=J(2,[1,1],[],1,0,0),Ge[Oe.BITOR]=J(2,[1,1],[],1,0,0),Ge[Oe.BITXOR]=J(2,[1,1],[],1,0,0),Ge[Oe.BITLSHIFT]=J(2,[1,1],[],1,0,0),Ge[Oe.BITRSHIFT]=J(2,[1,1],[],1,0,0),Ge[Oe.PERMUTATIONA]=J(2,[1,1],[],1,0,0),Ge[Oe.COMBINA]=J(2,[1,1],[],1,0,0),Ge[Oe.XOR]=J(1,[],[52],4,0,0),Ge[Oe.PDURATION]=J(3,[1,1,1],[],1,0,0),Ge[Oe.BASE]=J(2,[1,1,65],[],2,0,0),Ge[Oe.DECIMAL]=J(2,[2,1],[],1,0,0),Ge[Oe.DAYS]=J(2,[3,3],[],1,0,0),Ge[Oe.BINOM_DIST_RANGE]=J(3,[1,1,1,65],[],1,0,0),Ge[Oe.GAMMA]=J(1,[1],[],1,0,0),Ge[Oe.SKEW_P]=J(1,[],[49],1,0,0),Ge[Oe.GAUSS]=J(1,[1],[],1,0,0),Ge[Oe.PHI]=J(1,[1],[],1,0,0),Ge[Oe.RRI]=J(3,[1,1,1],[],1,0,0),Ge[Oe.UNICHAR]=J(1,[1],[],2,0,0),Ge[Oe.UNICODE]=J(1,[2],[],1,0,0),Ge[Oe.MUNIT]=J(1,[1],[],32,0,0),Ge[Oe.ARABIC]=J(1,[2],[],1,0,0),Ge[Oe.ISOWEEKNUM]=J(1,[1],[],1,0,0),Ge[Oe.NUMBERVALUE]=J(1,[2,66,66],[],1,0,0),Ge[Oe.SHEET]=J(0,[50],[],1,4095,0),Ge[Oe.SHEETS]=J(0,[48],[],1,4095,0),Ge[Oe.FORMULATEXT]=J(1,[16],[],2,4095,0),Ge[Oe.ISFORMULA]=J(1,[16],[],4,0,0),Ge[Oe.IFNA]=J(2,[47,575],[],47,0,0),Ge[Oe.CEILING_MATH]=J(1,[1,65,65],[],1,0,0),Ge[Oe.FLOOR_MATH]=J(1,[1,65,65],[],1,0,0),Ge[Oe.IMSINH]=J(1,[95],[],9,0,0),Ge[Oe.IMCOSH]=J(1,[95],[],9,0,0),Ge[Oe.FILTERXML]=J(2,[2,2],[],47,0,0),Ge[Oe.WEBSERVICE]=J(1,[2],[],10,0,0),Ge[Oe.ENCODEURL]=J(1,[2],[],10,0,0),Ge[Oe.FORECAST_ETS]=J(3,[1,48,48,65,65,65],[],1,0,0),Ge[Oe.FORECAST_ETS_CONFINT]=J(3,[1,48,48,65,65,65,65],[],1,0,0),Ge[Oe.FORECAST_ETS_SEASONALITY]=J(2,[48,48,65,65],[],1,0,0),Ge[Oe.FORECAST_LINEAR]=J(3,[1,32,32],[],1,0,0),Ge[Oe.FORECAST_ETS_STAT]=J(3,[48,48,1,65,65,65],[],1,0,0),Ge[Oe.MAXIFS]=J(3,[16],[16,15],1,0,0),Ge[Oe.MINIFS]=J(3,[16],[16,15],1,0,0),Ge[Oe.TEXTJOIN]=J(3,[114,68],[114],2,0,0),Ge[Oe.CONCAT]=J(1,[],[114],2,0,0),Ge[Oe.IFS]=J(2,[],[44,575],575,0,0),Ge[Oe.SWITCH]=J(3,[47,575],[575,575],575,0,0),Ge[Oe.SINGLE]=J(1,[1079,4],[],1055,0,1),Ge[Oe.AVERAGE_WEIGHTED]=J(2,[],[113,113],1,0,1),Ge[Oe.ANCHORARRAY]=J(1,[16],[],48,0,1),Ge[Oe.IMAGE]=J(1,[2],[],2,0,1),Ge[Oe.RECORD]=J(2,[],[2,303],256,0,1),Ge[Oe.RECORDTEST]=J(3,[15],[2,47],256,0,1),Ge[Oe.GRF]=J(1,[15,2],[],15,0,1),Ge[Oe.UNIT]=J(2,[15,2],[],15,0,1),Ge[Oe.RICHERROR]=J(1,[1],[],10,0,1),Ge[Oe.FILTER]=J(2,[48,48],[],32,0,1),Ge[Oe.FUN]=J(1,[],[63],63,0,1),Ge[Oe.LET]=J(3,[63,63,63],[],63,0,1),Ge[Oe.ARRAYMAKE]=J(3,[1,1,63],[],32,0,1),Ge[Oe.APPLY]=J(1,[],[63],63,0,1),Ge[Oe.ISFUN]=J(1,[63],[],4,0,1),Ge[Oe.ARITY]=J(1,[63],[],9,0,1),Ge[Oe.RECURSE]=J(0,[],[],63,0,1),Ge[Oe.FIELDVALUE]=J(2,[263,2],[],295,0,1);var He,Ke=J(0,[],[P.All],P.All,B.All,x.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot"}(He||(He={}));var je,Qe,Je=w.Number|w.String|w.Boolean,Xe=w.Number|w.String|w.Boolean|w.Blank,Ye=J(2,[w.Number,w.Number],[],w.Number,B.None,x.None),qe=J(1,[w.Number],[],w.Number,B.None,x.None),ze=J(1,[Je],[],Je,B.None,x.None),Ze=J(2,[w.String,w.String],[],w.String,B.None,x.None),$e=J(2,[Xe,Xe],[],w.Boolean,B.None,x.None),er=J(2,[w.Range,w.Range],[],w.Range,B.AllCells,x.None),rr=J(2,[w.Range,w.Range],[],w.Range,B.None,x.None),nr=J(2,[w.Boolean,w.Boolean],[],w.Boolean,B.None,x.None),tr=[];function or(e){var r=tr[e];return null!=r?r:Ke}function ar(e){var r=Ge[e];return null!=r?r:Ke}function ir(e,r){var n=Ge[e];null!=n&&(n.staticPrecs=r)}function ur(e){return 1===e.length}function cr(e){return 1===e.rows&&1===e.cols}function lr(e){return ur(e.sheet)}function sr(e){return cr(e.range)}function fr(e){return cr(e)?e:_(e.row,e.col,1,1)}function dr(e){return sr(e)?e:K(e.sheet,fr(e.range))}function pr(e,r){var n=e.row,t=e.col,o=r.row,a=r.col;return _(Math.min(n,o),Math.min(t,a),Math.abs(o-n)+1,Math.abs(a-t)+1)}function Er(e,r){function n(n){var t=e.spans[n.label];return void 0!==t&&t.start<=r&&r<t.end}for(var t=e.node,o=!0;o;)switch(o=!1,t.kind){case de.Array:for(var a=t.nodes,i=a.length-1;!o&&i>=0;i-=1)for(var u=a[i],c=u.length-1;!o&&c>=0;c-=1){n(s=u[c])&&(t=s,o=!0)}break;case de.App:var l=t.args;for(c=l.length-1;!o&&c>=0;c-=1){n(s=l[c])&&(t=s,o=!0)}break;case de.Paren:var s;n(s=t.node)&&(t=s,o=!0);break;case de.Bad:case de.Name:case de.CellRef:case de.Literal:break;default:I("getSubExpressionFromPosition",t)}return t}function hr(e,r){var n=-1,t=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(n=o.offset);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,r))&&(n=o.startOffset)}else try{var o;(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(t),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}for(;null!=t&&"SPAN"===t.nodeName;)null!=(t=t.previousSibling)&&null!=t.textContent&&(n+=t.textContent.length);return n}function vr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===de.Literal&&Tr(r.oper)===w.Missing)return 0}return e.args.length}(e)?[]:e.args}function gr(e,r){A("calc.runtime.getArgType",r);var n=e.headTypes,t=n.length;if(r<t)return n[r];var o=e.restTypes,a=o.length;return a>0?o[(r-t)%a]:P.None}function mr(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function Tr(e){switch(typeof e){case"number":return w.Number;case"string":return w.String;case"boolean":return w.Boolean;default:return e.kind}}function Sr(e){return"number"==typeof e&&isFinite(e)}function Rr(e){return{kind:je.Success,value:e}}function Ir(e){return{kind:je.Failure,reason:e}}function Cr(e){return null!=e&&e.kind===je.Success}function Ar(e){return{kind:Qe.NotImplemented,features:e}}function Nr(e){return 0===e.length&&C("calc.lang.unavailable: expected nonempty array"),{kind:Qe.Unavailable,objects:e}}function Or(e){if(null!=e){var r=e.path,n=e.name;return null!=r&&"string"!=typeof r?(S.ULS.traceTag(595969803,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Illegal document path: type is "+typeof r),y):"string"!=typeof n?(S.ULS.traceTag(595969804,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Illegal document name: type is "+typeof n),y):e}}tr[He.Add]=Ye,tr[He.Sub]=Ye,tr[He.Mul]=Ye,tr[He.Div]=Ye,tr[He.Pow]=Ye,tr[He.Percent]=qe,tr[He.Neg]=qe,tr[He.Pos]=ze,tr[He.Concat]=Ze,tr[He.Eq]=$e,tr[He.Ne]=$e,tr[He.Lt]=$e,tr[He.Le]=$e,tr[He.Gt]=$e,tr[He.Ge]=$e,tr[He.Range]=er,tr[He.Isect]=rr,tr[He.Union]=rr,tr[He.And]=nr,tr[He.Or]=nr,tr[He.Xor]=nr,tr[He.Min]=Ye,tr[He.Max]=Ye,ir(Oe.ROW,B.OwnRow),ir(Oe.COLUMN,B.OwnCol),ir(Oe.SHEET,B.OwnDocSheets),ir(Oe.SHEETS,B.OwnDocSheets),ir(Oe.OFFSET,B.AllCells),ir(Oe.INDIRECT,B.AllCells),ir(Oe.SUMIF,B.AllCells),ir(Oe.NOW,B.Time),ir(Oe.TODAY,B.Time),ir(Oe.RAND,B.Calc),ir(Oe.RANDBETWEEN,B.Calc),ir(Oe.SUBTOTAL,B.CellProps),ir(Oe.CELL,B.CellProps|B.AllCells),ir(Oe.INFO,B.Calc),ir(Oe.FORMULATEXT,B.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(je||(je={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Qe||(Qe={}));var yr=65;function Lr(e){for(var r=e+1,n="";r>0;){var t=(r-1)%26;n=String.fromCharCode(yr+t)+n,r=Math.floor((r-t)/26)}return n}function kr(e,r,n){var t=n.kind,o=n.index;return t===fe.Abs?r+e.formatNumber(o+1):0===o?r:r+e.leftBracket+e.formatNumber(o)+e.rightBracket}function Dr(e,r,n,t){if(r===ce.A1){if(null==n){return S.ULS.assertTag(595935437,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,r,n){var t=n.kind===fe.Abs,o=e.formatNumber(n.index+(t?0:r)+1);return t?"$"+o:o}(e,n,t)}return kr(e,e.rowLetter,t)}function Mr(e,r,n,t){if(r===ce.A1){if(null==n){return S.ULS.assertTag(595935438,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,r){var n=r.kind===fe.Abs,t=Lr(r.index+(n?0:e));return n?"$"+t:t}(n,t)}return kr(e,e.columnLetter,t)}function _r(e){return function(r,n,t,o,a){var i=e(r,n,t,o);return n===ce.R1C1&&o.kind===a.kind&&o.index===a.index?i:i+":"+e(r,n,t,a)}}var Fr=_r(Dr),br=_r(Mr);function Ur(e,r,n,t,o){var a=Dr(e,r,null!=n?n.row:void 0,t),i=Mr(e,r,null!=n?n.col:void 0,o);return r===ce.A1?i+a:a+i}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var wr=function(e,r){return(wr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])})(e,r)};function Pr(e,r){function n(){this.constructor=e}wr(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var Br=function(){return(Br=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function xr(e,r,n,t){return new(n||(n=Promise))(function(o,a){function i(e){try{c(t.next(e))}catch(e){a(e)}}function u(e){try{c(t.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(r){r(e.value)}).then(i,u)}c((t=t.apply(e,r||[])).next())})}function Vr(e,r){var n,t,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,t&&(o=2&a[0]?t.return:a[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,t=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],t=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var Wr,Gr={ULS:new s.NulLogger},Hr=Object(s.initStopwatchFactory)(function(e){return Gr.ULS.traceTag(595948114,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,e)});function Kr(e,r){return xr(this,void 0,void 0,function(){var n;return Vr(this,function(t){switch(t.label){case 0:n=Hr(e),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,r()];case 2:return[2,t.sent()];case 3:return n.stop(),[7];case 4:return[2]}})})}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch"}(Wr||(Wr={}));var jr=function(e){return!1},Qr={};function Jr(e){return void 0===Qr[e]&&(Qr[e]=jr(e)),Qr[e]}function Xr(e,r){return{wrap:e,unwrap:r}}function Yr(e){return e}function qr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function zr(e){var r=qr();for(var n in e)r[n]=e[n];return r}function Zr(e){return null!=e}function $r(e){return null==e}function en(e,r){return void 0!==e?e:r}var rn=100;function nn(e,r,n){return void 0===n&&(n=rn),r.maxDepth=n,r.level=0,tn(e,r)}function tn(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var n;switch(r.level+=1,e.kind){case de.Literal:n=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===w.Missing)return r.visitMissing(e);if(e.kind===w.Error)switch(e.type){case V.NULL:return r.visitNullError(e);case V.DIV0:return r.visitDiv0Error(e);case V.VALUE:return r.visitValueError(e);case V.REF:return r.visitRefError(e);case V.NAME:return r.visitNameError(e);case V.NUM:return r.visitNumError(e);case V.NA:return r.visitNAError(e);case V.GETTING_DATA:return r.visitDataError(e);case V.FIELD:return r.visitFieldError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case de.Array:n=r.visitArray(e);break;case de.App:n=r.visitApp(e);break;case de.Paren:n=r.visitParen(e);break;case de.Name:n=r.visitName(e);break;case de.CellRef:n=r.visitCellRef(e);break;case de.Bad:n=r.visitBad(e);break;case de.Operator:n=r.visitOperator(e);break;case se.Error:n=r.visitRefError(e);break;case se.Single:n=r.visitSingle(e);break;case se.Range:n=r.visitRange(e);break;case se.Row:n=r.visitRow(e);break;case se.Col:n=r.visitCol(e);break;case le.Error:n=r.visitNameError(e);break;case le.Relative:n=r.visitRelative(e);break;case le.Document:n=r.visitDocument(e);break;case le.Sheet:n=r.visitSheet(e);break;case le.Ident:n=r.visitIdent(e);break;case le.SheetRange:n=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,n}function on(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e,visitFieldError:e}}function an(e,r,n){return{level:0,operVisitor:e,visitArray:en(n.vArray,r),visitApp:en(n.vApp,r),visitParen:en(n.vParen,r),visitName:en(n.vName,r),visitCellRef:en(n.vCellRef,r),visitBad:en(n.vBad,r),visitOperator:en(n.vOperator,r),visitRefError:en(n.vRefError,r),visitSingle:en(n.vSingle,r),visitRange:en(n.vRange,r),visitRow:en(n.vRow,r),visitCol:en(n.vCol,r),visitNameError:en(n.vNameError,r),visitRelative:en(n.vRelative,r),visitDocument:en(n.vDocument,r),visitSheet:en(n.vSheet,r),visitIdent:en(n.vIdent,r),visitSheetRange:en(n.vSheetRange,r)}}var un=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","];var cn={level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"},visitFieldError:function(e){return"#FIELD"}},visitArray:function(e){var r=[];return e.nodes.forEach(function(e){var n=[];e.forEach(function(e){n.push(tn(e,cn))}),r.push(n.join(","))}),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach(function(e){r.push(tn(e,cn))});var n=tn(e.head,cn);if(e.head.kind===de.Operator){if(e.head.id===He.Percent)return r[0]+"%";if(1===r.length)return n+r[0];if(2===r.length)return r[0]+n+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return n+"("+r.join(",")+")"},visitParen:function(e){return"("+tn(e.node,cn)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=tn(e.qualifier,this)+"!"),r+tn(e.ref,this)},visitBad:function(e){if(e.type===pe.Sequence){var r=[];return e.contents.forEach(function(e){r.push(tn(e,cn))}),r.join("")}return e.contents},visitOperator:function(e){return un[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){return r=e.row.index,n=e.row.kind===fe.Abs,t=e.col.index,(e.col.kind===fe.Abs?"$":"")+Lr(t)+(n?"$":"")+(r+1);var r,n,t},visitRange:function(e){return tn(e.ref1,cn)+":"+tn(e.ref2,cn)},visitRow:function(e){var r=e.row1.index+1,n=e.row1.kind===fe.Abs,t=e.row2.index+1;return(n?"$":"")+r+":"+(e.row2.kind===fe.Abs?"$":"")+t},visitCol:function(e){var r=e.col1.index,n=e.col1.kind===fe.Abs,t=e.col2.index,o=e.col2.kind===fe.Abs;return(n?"$":"")+Lr(r)+":"+(o?"$":"")+Lr(t)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?tn(e.document,cn):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function ln(e){var r=function(e){try{return Rr("="+nn(e,cn))}catch(e){return S.ULS.traceTag(595964180,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"PrettyPrinter failed: "+e),cn.level=0,Ir(e)}}(e);if(r.kind===je.Success){return r.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp('[^/=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*/g/\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9/g/\\s\\ua0c2/gd]',"g"),"w")}}function sn(e){return ln(e.node)}function fn(e){return T.FormulaNode=ln,T.Formula=sn,{localeInfo:e}}var dn=!1,pn=void 0;function En(e,r,n){if(dn){var t="calc.config.initCalc: Calc is already initialized";S.ULS.traceTag(595910878,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)}else{var o;if(R(e),function(e){Gr.ULS=e}(e),"function"==typeof(o=r)&&(jr=o),null!=n&&!/(^https:\/\/)|(^http:\/\/)/.test(n)){t="calc.config.initCalc: calcAbsUrl is not absolute: "+n;S.ULS.traceTag(595910879,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)}pn=n,dn=!0}}function hn(){return dn}function vn(){return pn}function gn(e,r,n,t,o,a,i,u,c,l,s,f,d,p,E,h,v,g,m,T,S,R){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:n,getWorksheetFuncName:t,isNumeral:o,getOrdinal:a,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:l,trueName:s,falseName:f,rowLetter:d,columnLetter:p,leftBrace:E,rightBrace:h,leftBracket:v,rightBracket:g,decimalSeparator:m,listSeparator:T,columnSeparator:S,rowSeparator:R}}function mn(e){return Number(e)}function Tn(e){return String(e)}function Sn(e){return yn[e.toLocaleUpperCase()]}function Rn(e){var r=Ln[e];return null==r?C("calc.config.getWorksheetFuncName: unknown function ID "+e):r}function In(e){return e>="0"&&e<="9"}function Cn(e){return In(e)||C("calc.config.getOrdinal: expected numeral; given "+h(e)),e.charCodeAt(0)-"0".charCodeAt(0)}function An(e){return O("calc.config.getNumeral",e,10),String(e)}function Nn(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function On(e,r){return e.toLocaleUpperCase().localeCompare(r.toLocaleUpperCase())}var yn,Ln,kn=[void 0,"#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA","#FIELD"];function Dn(){return void 0!==yn&&void 0!==Ln||(yn={},Ln=[],Object.keys(Oe).forEach(function(e){var r=Oe[e];if("number"==typeof r){var n=e.replace("_",".");yn[n]=r,Ln[r]=n}})),gn(mn,Tn,Sn,Rn,In,Cn,An,Nn,On,kn,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")}var Mn,_n,Fn,bn,Un,wn,Pn,Bn,xn,Vn,Wn,Gn,Hn=se,Kn=fe,jn=le,Qn=Se,Jn=b,Xn=M,Yn=D,qn=G,zn=j,Zn=Q,$n=pr,et=Cr,rt=Qe,nt=Ar;function tt(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case rt.NotImplemented:case rt.Unavailable:return!0}return!1}function ot(e,r,n){return function(t,o){return void 0===o?r(t):tt(o)?n(o,t):e(o)}}function at(e,r){return function(n){if(Array.isArray(n)){for(var t=void 0,o=0;o<n.length;o+=1){var a=n[o];if(void 0!==(t=e(a)))return[a,t]}return r}var i=e(n);return void 0===i?r:[n,i]}}function it(e,r){return r.kind===Kn.Abs?r.index:e+r.index}function ut(e,r){var n=it(e.row,r.row),t=it(e.col,r.col);return Jn(n,t)}function ct(e,r){switch(r.kind){case Hn.Error:return;case Hn.Single:var n=ut(e,r);return Jn(n.row,n.col);case Hn.Range:var t=ut(e,r.ref1),o=ut(e,r.ref2);return $n(t,o);case Hn.Row:return nt(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case Hn.Col:return nt(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function lt(e){function r(r){var n=e.getDocumentLoc(r.path,r.document);return Zr(n)?n:void 0}function n(n,t){var o=Zr(t.document)?r(t.document):n;if(!$r(o)){var a=e.getSheetIndex(o,t.sheet);return et(a)?Zr(a.value)?Xn(o,a.value):void 0:a.reason}}return{resolveName:function(t,o,a){if($r(o)||o.kind===jn.Relative)return[Zn(t.sheet,a),Zn(zn(t.sheet.document),a)];var i=function(t,o){switch(o.kind){case jn.Document:var a=r(o);return Zr(a)?zn(a):a;case jn.Sheet:return n(t.sheet.document,o);case jn.Ident:var i=t.sheet.document,u=e.getSheetIndex(i,o.name);if(et(u)){if(Zr(u.value))return Xn(i,u.value);var c=r(Qn(o.name));return Zr(c)?zn(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",o)}}(t,o);return tt(i)?i:Zn(i,a)},resolveGridRef:ct,resolveCellRef:function(r,t,o){var a=ct(r.range,o);if(tt(a))return a;var i=$r(t)?r.sheet:function(r,t){switch(t.kind){case jn.Error:return;case jn.Sheet:return n(r.document,t);case jn.SheetRange:var o=r.document,a=e.getSheetIndex(o,t.sheet1);if(!et(a))return a.reason;var i=e.getSheetIndex(o,t.sheet2);if(!et(i))return i.reason;var u=a.value,c=i.value;if($r(u)||$r(c))return;return u===c?Xn(o,u):Yn(o,Math.min(u,c),Math.abs(c-u)+1);case jn.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",t)}}(r.sheet,t);return tt(i)?i:qn(i,a)}}}(_n=Mn||(Mn={})).FormulaSource=v,_n.documentLoc=L,_n.sheetIndex=M,_n.sheetRange=D,_n.gridCell=b,_n.gridRange=F,_n.sheetGridCell=K,_n.sheetGridRange=H,_n.sheetGridCube=G,_n.documentScope=j,_n.nameLoc=Q,(bn=Fn||(Fn={})).SpecialPrecs=B,bn.OperKind=w,bn.ErrorType=V,bn.ErrorTypeBounds=W,bn.precedents=X,bn.errorOper=Y,bn.nullErrorOper=q,bn.div0ErrorOper=z,bn.valueErrorOper=Z,bn.refErrorOper=$,bn.nameErrorOper=ee,bn.numErrorOper=re,bn.naErrorOper=ne,bn.gettingDataErrorOper=te,bn.fieldErrorOper=oe,bn.arrayOper=ae,bn.rangeSeqOper=ie,bn.range3DOper=ue,bn.missingOper=Ee,bn.blankOper=he,(wn=Un||(Un={})).RefStyle=ce,wn.QualifierKind=le,wn.CellRefKind=se,wn.PosKind=fe,wn.NodeKind=de,wn.BadType=pe,wn.errorQualifierLabeled=ve,wn.relativeQualifierLabeled=ge,wn.errorQualifier=me,wn.relativeQualifier=Te,wn.documentQualifier=Se,wn.sheetQualifier=Re,wn.identQualifier=Ie,wn.sheetRangeQualifier=Ce,wn.pos=Ae,wn.cellRefErrorLabeled=Ne,wn.cellRefError=ye,wn.cellRefSingle=Le,wn.cellRefRange=ke,wn.cellRefRow=De,wn.cellRefCol=Me,wn.formula=_e,wn.formulaSpan=Fe,wn.literalNode=be,wn.arrayNode=Ue,wn.appNode=we,wn.operatorNode=Pe,wn.parenNode=Be,wn.nameNode=xe,wn.cellRefNode=Ve,wn.badNode=We,(Bn=Pn||(Pn={})).SignatureType=P,Bn.FunctionFlags=x,Bn.OperatorId=He,Bn.WorksheetFuncId=Oe,Bn.SpecialPrecs=B,Bn.functionType=J,Bn.unknownFunctionType=Ke,Bn.getOperatorType=or,Bn.getWorksheetFuncType=ar,(Vn=xn||(xn={})).isSheetIndex=ur,Vn.isSheetGridRange=lr,Vn.isGridCell=cr,Vn.isSheetGridCell=sr,Vn.gridRangeAnchor=fr,Vn.sheetGridRangeAnchor=dr,Vn.gridCellRange=pr,Vn.getArguments=vr,Vn.getArgType=gr,Vn.isValidArgsLength=mr,Vn.operKind=Tr,Vn.ResultKind=je,Vn.success=Rr,Vn.failure=Ir,Vn.isSuccess=Cr,Vn.ReasonKind=Qe,Vn.notImplemented=Ar,Vn.unavailable=Nr,Vn.columnName=Lr,Vn.formatRow=Dr,Vn.formatCol=Mr,Vn.formatRowRange=Fr,Vn.formatColRange=br,Vn.formatCellPos=Ur,Vn.getSubExpressionFromPosition=Er,Vn.getFormulaCharIndexFromPoint=hr,Vn.createResolver=lt,Vn.createResolutionHandler=ot,Vn.createNameFinder=at,Vn.defaultLiteralVisitor=on,Vn.defaultFormulaVisitor=an,Vn.dispatch=tn,Vn.startVisit=nn,(Gn=Wn||(Wn={})).localeInfo=gn,Gn.calcConfig=fn,Gn.initCalc=En,Gn.createSimpleLocaleInfo=Dn,Gn.isCalcInit=hn,Gn.getCalcAbsUrl=vn;var st,ft=xn.ReasonKind,dt=xn.notImplemented;function pt(e){return{config:e}}!function(e){e.BadFormulaString="BadFormulaString"}(st||(st={}));var Et=Br({},ft,st);function ht(e){return{kind:Et.BadFormulaString,message:e}}var vt=" \t\n\r";function gt(e){return vt.indexOf(e)>=0}function mt(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Tt(e,r){return"."===r||mt(e,r)||e.isNumeral(r)}function St(e,r){var n=r-1;return function(r){if(r<=n){var t=e+": internal error: no progress made at index "+r;return S.ULS.assertTag(595980821,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}n=r}}function Rt(e,r,n){for(var t=r;t<e.length&&n(e[t]);t+=1);return[e.substring(r,t),t]}function It(e,r,n,t,o){var a=e[r];return n(a)?1:a===t&&o(e[r+1])?2:0}function Ct(e,r,n,t,o){for(var a=[],i=r,u=r;u<e.length;){var c=It(e,u,n,t,o);if(0===c)break;2===c&&(i!==u&&a.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&a.push(e.substring(i,u)),[a.join(""),u]}var At,Nt,Ot,yt,Lt=Fn.nullErrorOper,kt=Fn.div0ErrorOper,Dt=Fn.valueErrorOper,Mt=Fn.refErrorOper,_t=Fn.nameErrorOper,Ft=Fn.numErrorOper,bt=Fn.naErrorOper,Ut=Fn.gettingDataErrorOper,wt=Fn.fieldErrorOper,Pt=Pn.OperatorId;function Bt(e,r,n){return{kind:e,start:r,chars:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(At||(At={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Nt||(Nt={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Ot||(Ot={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(yt||(yt={}));var xt=function(e){return Bt(At.End,e,"")},Vt=function(e,r){return Bt(At.Spaces,e,r)},Wt=function(e,r){return Bt(At.Unexpected,e,r)},Gt=function(e,r){return Bt(At.Ident,e,r)};function Ht(e,r,n,t){return{kind:e,start:r,chars:n,value:t}}var Kt=function(e){return Ht(At.Left,e,"(",Nt.Paren)},jt=function(e,r){return Ht(At.Left,e,r,Nt.Bracket)},Qt=function(e,r){return Ht(At.Left,e,r,Nt.Brace)},Jt=function(e){return Ht(At.Left,e,"'",Nt.SQuote)},Xt=function(e){return Ht(At.Right,e,")",Nt.Paren)},Yt=function(e,r){return Ht(At.Right,e,r,Nt.Bracket)},qt=function(e,r){return Ht(At.Right,e,r,Nt.Brace)},zt=function(e){return Ht(At.Right,e,"'",Nt.SQuote)},Zt=function(e,r){return Ht(At.Sep,e,r,Ot.List)},$t=function(e,r){return Ht(At.Sep,e,r,Ot.Col)},eo=function(e,r){return Ht(At.Sep,e,r,Ot.Row)},ro=function(e){return Ht(At.Sep,e,"!",Ot.Qual)},no={"#ALL":function(e,r){return Ht(At.SpecialRef,e,r,yt.All)},"#DATA":function(e,r){return Ht(At.SpecialRef,e,r,yt.Data)},"#HEADERS":function(e,r){return Ht(At.SpecialRef,e,r,yt.Headers)},"#TOTALS":function(e,r){return Ht(At.SpecialRef,e,r,yt.Totals)},"#THIS ROW":function(e,r){return Ht(At.SpecialRef,e,r,yt.ThisRow)}};function to(e,r,n,t,o,a,i,u){return{kind:At.CellRef,start:e,chars:r,row:n,col:t,refStyle:o,isName:a,isNumber:i,isQualPart:u}}function oo(e,r,n,t){void 0===t&&(t=!0);var o="number"==typeof n&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:At.Literal,start:e,chars:r,oper:n,hasRight:t,isQualPart:o}}var ao=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return oo(e,r,Lt)},function(e,r){return oo(e,r,kt)},function(e,r){return oo(e,r,Dt)},function(e,r){return oo(e,r,Mt)},function(e,r){return oo(e,r,_t)},function(e,r){return oo(e,r,Ft)},function(e,r){return oo(e,r,bt)},function(e,r){return oo(e,r,Ut)},function(e,r){return oo(e,r,wt)}];function io(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?oo(r,n,!1):0===e.stringCompareCI(e.trueName,n)?oo(r,n,!0):Gt(r,n)}var uo=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function co(e){var r=uo[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(n){return{kind:At.Operator,start:n,chars:r,value:e}}}var lo=co(Pt.Add),so=co(Pt.Sub),fo=co(Pt.Mul),po=co(Pt.Div),Eo=co(Pt.Pow),ho=co(Pt.Percent),vo=co(Pt.Concat),go=co(Pt.Eq),mo=co(Pt.Lt),To=co(Pt.Gt),So=co(Pt.Ne),Ro=co(Pt.Le),Io=co(Pt.Ge),Co=co(Pt.Range);co(Pt.And),co(Pt.Or),co(Pt.Xor),co(Pt.Dot);function Ao(e,r,n){return n.push(r),r.start+e}var No=Un.PosKind,Oo=Un.pos,yo=Un.RefStyle;function Lo(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function ko(e){return e.toUpperCase().charCodeAt(0)-65+1}function Do(e,r,n,t){for(var o=0,a=t,i=Math.min(n.length,t+r);a<i;a+=1){var u=n[a];if(!e.isNumeral(u))break;o=10*o+e.getOrdinal(u)}return a===i&&e.isNumeral(n[a])?[0,t]:[o,a]}function Mo(e,r,n){return function(t,o,a,i){var u=function(e,r){return"$"===e[r]?[No.Abs,r+1]:[No.Rel,r]}(a,i),c=u[0],l=u[1],s=e(t,n,a,l),f=s[0],d=s[1];if(d>l){if(f<1||f>r)return;var p=c===No.Rel?f-o:f;return[Oo(c,p-1),!1,d]}return[void 0,!1,i]}}function _o(e,r,n){return function(t,o,a,i){var u=e?t.rowLetter:t.columnLetter;if(i>=a.length||0!==t.stringCompareCI(u,a[i]))return[void 0,!1,i];var c=i+1,l=Do(t,n,a,c),s=l[0],f=l[1];if(f>c){if(s<1||s>r)return;return[Oo(No.Abs,s-1),!1,f]}if(a[c]===t.leftBracket){var d=1;"+"===a[c+=1]?c+=1:"-"===a[c]&&(d=-1,c+=1);var p=Do(t,n,a,c),E=p[0],h=p[1];if(h>c&&E<r&&a[h]===t.rightBracket)return[Oo(No.Rel,E*d),!0,h+1]}return[!1,!1,f]}}function Fo(e,r,n,t,o,a,i){var u=t(e,r,a,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],l=u[1],s=u[2];if(s>i){var f=o(e,n,a,s);if(null==f)return l?[c,void 0,!0,s]:[void 0,void 0,!1,i];var d=f[0],p=f[1],E=f[2];return E>s?[c,d,p,E]:[c,void 0,l,s]}var h=o(e,n,a,i);if(null==h)return[void 0,void 0,!1,i];var v=h[0],g=h[1],m=h[2];return m>i?[void 0,v,g,m]:[void 0,void 0,!1,i]}var bo=Mo(Do,1048576,7),Uo=Mo(function(e,r,n,t){return function(e,r,n){for(var t=0,o=n,a=Math.min(r.length,n+e);o<a;o+=1){var i=r[o];if(!Lo(i))break;t=26*t+ko(i)}return o===a&&Lo(r[o])?[0,n]:[t,o]}(r,n,t)},16384,3),wo=_o(!0,1048576,7),Po=_o(!1,16384,5);function Bo(e,r,n,t,o,a){var i,u,c,l,s,f=function(e,r,n,t,o){if(r===yo.A1&&null!=n){var a=n.range,i=Fo(e,a.col,a.row,Uo,bo,t,o),u=i[0],c=i[1],l=i[2],s=i[3];if((null!=c&&null!=u||null!=c&&c.kind===No.Abs||null!=u&&u.kind===No.Abs||(null!=c||null!=u)&&(":"===t[o-1]||":"===t[s]))&&(l||s>=t.length||!Tt(e,t[s])))return[yo.A1,c,u,s]}var f=Fo(e,void 0,void 0,wo,Po,t,o),d=f[0],p=f[1],E=f[2],h=f[3];if((null!=d||null!=p)&&(E||h>=t.length||!Tt(e,t[h])))return[yo.R1C1,d,p,h]}(e,r,n,t,o);if(null!=f){var d=f[0],p=f[1],E=f[2],h=f[3],v=t.substring(h,o);return Ao(h-o,d===yo.A1?function(e,r,n,t){var o=null==n&&null!=t&&t.kind===Un.PosKind.Rel,a=null==t&&null!=n&&n.kind===Un.PosKind.Rel,i=!(null!=n&&n.kind!==Un.PosKind.Rel||null!=t&&t.kind!==Un.PosKind.Rel);return to(e,r,n,t,Un.RefStyle.A1,o,a,i)}(o,v,p,E):(i=o,u=v,l=E,s=!(!1!==(c=p)&&null!=c&&c.kind!==Un.PosKind.Abs||!1!==l&&null!=l&&l.kind!==Un.PosKind.Abs),to(i,u,!1===c?Un.pos(Un.PosKind.Rel,0):c,!1===l?Un.pos(Un.PosKind.Rel,0):l,Un.RefStyle.R1C1,!1,!1,s)),a)}}var xo=Fn.numErrorOper,Vo="+-*/^%&=<>:";function Wo(e){return Vo.indexOf(e)>=0}var Go={"+":lo,"-":so,"*":fo,"/":po,"^":Eo,"%":ho,"&":vo,"=":go,"<":mo,">":To,":":Co},Ho={"<>":So,"<=":Ro,">=":Io};function Ko(e,r,n){if(r<e.length-1){var t=Ho[e.substr(r,2)];if(null!=t)return Ao(2,t(r),n)}var o=Go[e[r]];if(null!=o)return Ao(1,o(r),n);return S.ULS.assertTag(595980822,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function jo(e,r,n,t){function o(n){var t=n,o=r[t];if("e"!==o&&"E"!==o)return n;if((t+=1)>=r.length)return n;if("+"===(o=r[t])||"-"===o){if((t+=1)>=r.length)return n;o=r[t]}if(!e.isNumeral(o))return n;for(t+=1;t<r.length&&e.isNumeral(r[t]);t+=1);return t}function a(n,t){var a=n,i=r[a];if(i===e.decimalSeparator){if((a+=1)>=r.length)return t?n:a;i=r[a]}if(!e.isNumeral(i))return t?n:o(a);for(a+=1;a<r.length;a+=1)if(!e.isNumeral(r[a]))return o(a);return a}for(var i=n;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=a(i,i===n);break}if(i>n){var u=r.substring(n,i),c=e.parseNumber(u);return Ao(i-n,oo(n,u,Sr(c)?c:xo,!0),t),i}}function Qo(e,r,n){var t=Ct(e,r+1,function(e){return'"'!==e},'"',function(e){return'"'===e}),o=t[0],a=t[1],i=e.substring(r,a+1);return a<e.length?Ao(a+1-r,oo(r,i,o,!0),n):Ao(a-r,oo(r,i,o,!1),n)}function Jo(e,r,n,t){for(var o=1;o<e.errorNames.length;o+=1){var a=e.errorNames[o],i=r.substr(n,a.length),u=ao[o];if(0===e.stringCompareCI(a,i)&&null!=u)return Ao(a.length,u(n,i),t)}}var Xo=Object.getOwnPropertyNames(no);function Yo(e,r,n,t){for(var o=0;o<Xo.length;o+=1){var a=Xo[o],i=r.substr(n,a.length);if(i.toUpperCase()===a)return Ao(a.length,no[a](n,i),t)}}function qo(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function zo(e,r,n,t){var o=Ao(1,jt(n,r[n]),t);"#"===r[o]&&(null!=(l=Yo(0,r,o,t))&&(o=l));for(var a=function(r){return qo(e,r)},i=function(r){return!qo(e,r)},u=St("calc.parse.tokenizeBracketedColRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Ao(1,Yt(o,c),t);if(It(r,o,a,"'",i)>0){var l,s=Ct(r,o,a,"'",i),f=s[0];o=Ao((l=s[1])-o,Gt(o,f),t)}else o=Ao(1,Wt(o,c),t)}return o}function Zo(e,r){return!gt(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function $o(e,r,n,t){var o=Ao(1,jt(n,r[n]),t);"#"===r[o]&&(null!=(f=Yo(0,r,o,t))&&(o=f));for(var a=function(r){return Zo(e,r)},i=function(r){return!Zo(e,r)},u=St("calc.parse.tokenizeBracketedRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Ao(1,Yt(o,c),t);if(It(r,o,a,"'",i)>0){var l=Ct(r,o,a,"'",i),s=l[0];o=Ao((f=l[1])-o,Gt(o,s),t)}else if(gt(c)){var f,d=Rt(r,o,gt);s=d[0];o=Ao((f=d[1])-o,Vt(o,s),t)}else o=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Ao(1,Wt(o,c),t):zo(e,r,o,t):Ao(1,Zt(o,c),t):Ao(1,Co(o),t)}return o}var ea,ra="':*?";function na(e,r,n,t){for(var o=Ao(1,Jt(n),t),a=function(r){return function(e,r){return ra.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=St("calc.parse.tokenizeQuotedQualifier",o);o<r.length;){u(o);var c=r[o];if("'"===c&&"'"!==r[o+1])return Ao(1,zt(o),t);if(":"!==c)if(c!==e.leftBracket)if(It(r,o,a,"'",i)>0){var l=Ct(r,o,a,"'",i),s=l[0];o=Ao(l[1]-o,Gt(o,s),t)}else o=Ao(1,Wt(o,c),t);else o=$o(e,r,o,t);else o=Ao(1,Co(o),t)}return o}function ta(e,r,n,t){for(var o=e[r],a=r+1;a<e.length;a+=1){var i=e[a];if(i.kind!==n)break;o=t(o,i)}return[o,a]}function oa(e,r){return Wt(e.start,e.chars+r.chars)}function aa(e,r,n,t,o){for(var a=function(e,r,n,t,o){for(var a=[],i=[],u=ea.Decimal,c=o,l=St("calc.parse.tokenize",c);c<t.length;){l(c);var f=Bo(e,r,n,t,c,a);if(null==f){var d=t[c];if(u===ea.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var p=jo(e,t,c,a);if(null!=p){c=p,u=ea.FieldAccess;continue}if(d!==e.decimalSeparator){var E="calc.parse.tokenize: failed to tokenize numeral at "+c;return S.ULS.assertTag(595980823,s.LogCategory.msoulscat_ES_EWAJS,!1,E)}}if('"'!==d)if(mt(e,d)){var h=Rt(t,c,function(r){return Tt(e,r)}),v=h[0];c=Ao(h[1]-c,io(e,c,v),a),u=ea.FieldAccess}else if("#"!==d)if(Wo(d))c=Ko(t,c,a),u=ea.Decimal;else if(gt(d)){var g=Rt(t,c,gt);v=g[0],c=Ao(g[1]-c,Vt(c,v),a),u=ea.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===Nt.Brace){if(d===e.columnSeparator){c=Ao(1,$t(c,d),a),u=ea.Decimal;continue}if(d===e.rowSeparator){c=Ao(1,eo(c,d),a),u=ea.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(c=Ao(1,Wt(c,d),a),u=ea.Decimal):(c=na(e,t,c,a),u=ea.Decimal):(c=Ao(1,ro(c),a),u=ea.Decimal):(c=Ao(1,Zt(c,d),a),u=ea.Decimal)}else c=Ao(1,Yt(c,d),a),u=ea.FieldAccess;else c=$o(e,t,c,a),u=ea.FieldAccess;else i.length>0&&i[i.length-1]===Nt.Brace&&i.pop(),c=Ao(1,qt(c,d),a),u=ea.FieldAccess;else i.push(Nt.Brace),c=Ao(1,Qt(c,d),a),u=ea.Decimal;else i.length>0&&i[i.length-1]===Nt.Paren&&i.pop(),c=Ao(1,Xt(c),a),u=ea.FieldAccess;else i.push(Nt.Paren),c=Ao(1,Kt(c),a),u=ea.Decimal;else{var m=Jo(e,t,c,a);if(null!=m){c=m,u=ea.FieldAccess;continue}c=Ao(1,Wt(c,d),a),u=ea.Decimal}else c=Qo(t,c,a),u=ea.FieldAccess}else c=f,u=ea.FieldAccess}return a}(e.config.localeInfo,r,n,t,o),i=[],u=0;u<a.length;){var c=a[u];if(c.kind!==At.Unexpected)i.push(c),u+=1;else{var l=ta(a,u,At.Unexpected,oa),f=l[0],d=l[1];i.push(f),u=d}}return i.push(xt(t.length)),i}function ia(e,r,n,t){var o=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,n,t,function(e,r){o=[e,r]},function(){o=!1})),null==o){var a="calc.parse.runParser: internal error: parser did not call resolve or reject on "+h(r);return S.ULS.assertTag(595980827,s.LogCategory.msoulscat_ES_EWAJS,!1,a)}return o}function ua(e){return function(r,n,t,o,a){return o(e,n)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(ea||(ea={}));var ca,la=function(e,r,n,t,o){return o};function sa(e,r){return function(n,t,o,a,i){return e(n,t,o,function(e,t){return r(o,e)(n,t,o,a,i)},i)}}function fa(e,r){return function(n,t,o,a,i){return e(n,t,o,a,function(){return r(n,t,o,a,i)})}}function da(e){return 0===e.length?la:e.reduce(fa)}function pa(e,r){return function(n,t,o,a,i){return e(n,t,o,a,function(){return a(r,t)})}}function Ea(e,r){return function(n,t,o,a,i){var u=n[t];if(null==u)return i;var c=e(o,u);return null==c?i:a(c,t+r)}}function ha(e){return Ea(e,1)}function va(e){return Ea(e,0)}function ga(e){return function(r,n,t,o,a){var i=r[n],u=r[n+1];if(null==i||null==u)return a;var c=e(t,i,u);return null==c?a:o(c,n+1)}}function ma(e,r,n){return function(t,o,a,i,u){var c=n,l=o;function f(){return e(t,l,a,d,p)}function d(e,n){if(n<=l){var o=h(t),i="calc.parse.reduce: internal error: no progress made at index "+l+" on "+o;return S.ULS.assertTag(595980829,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return c=r(a,e,c),l=n,f}function p(){return i(c,l)}return f}}function Ta(e,r){return ma(e,function(e,r,n){return n.push(r),n},r)}function Sa(e){return function(r,n,t,o,a){return Ta(e,[])(r,n,t,o,a)}}function Ra(e,r){return sa(e,function(e,n){return Ta(r,[n])})}function Ia(e){var r=e.length;return function(n,t,o,a,i){var u=t,c=[];function l(){return e[c.length](n,u,o,s,i)}function s(e,n){return u=n,c.push(e),c.length<r?l:a(c,u)}return l}}function Ca(e,r){return Ia([e,r])}function Aa(e,r,n,t,o){return Ia([e,r,n,t,o])}function Na(e,r){return function(n,t,o,a,i){return e(n,t,o,function(e,n){return a(r(o,e),n)},i)}}function Oa(e,r,n){return Na(Ia([e,r]),function(e,r){return n(e,r[0],r[1])})}function ya(e,r,n,t){return Na(Ia([e,r,n]),function(e,r){return t(e,r[0],r[1],r[2])})}function La(e,r,n,t,o){return Na(Ia([e,r,n,t]),function(e,r){return o(e,r[0],r[1],r[2],r[3])})}function ka(e,r,n,t,o,a){return Na(Ia([e,r,n,t,o]),function(e,r){return a(e,r[0],r[1],r[2],r[3],r[4])})}function Da(e,r){return Oa(e,r,function(e,r,n){return r})}function Ma(e,r){return Oa(e,r,function(e,r,n){return n})}function _a(e,r){var n=e.spans[r.label];if(null==n){var t="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+h(r);return S.ULS.assertTag(595980824,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}return n}function Fa(e,r,n,t,o){var a=e.label;return e.label+=1,e.spans[a]=Un.formulaSpan(r,n,t,o),a}function ba(e,r,n,t){var o=_a(e,n);return o.pre=r,o.post=t,n}function Ua(e,r,n){return function(t,o,a,i,u){var c=a.leftDelim,l=a.listSep;return a.leftDelim=e,a.listSep=r,n(t,o,a,function(e,r){return a.leftDelim=c,a.listSep=l,i(e,r)},function(){return a.leftDelim=c,a.listSep=l,u})}}function wa(e,r){return r.kind===At.Spaces||r.kind===At.End?r.start:_a(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(ca||(ca={}));var Pa=pa(ha(function(e,r){return r.kind===At.Spaces?r.chars:void 0}),"");function Ba(e){return ya(Pa,ha(e),Pa,ba)}var xa=Ba(function(e,r){return r.kind!==Un.NodeKind.Operator||r.id!==Pn.OperatorId.Add&&r.id!==Pn.OperatorId.Sub?void 0:r}),Va=Oa(ha(function(e,r){if(r.kind===Un.NodeKind.Operator){if(r.id===Pn.OperatorId.Add)return Un.operatorNode(Pn.OperatorId.Pos,r.label);if(r.id===Pn.OperatorId.Sub)return Un.operatorNode(Pn.OperatorId.Neg,r.label)}}),Pa,function(e,r,n){return ba(e,"",r,n)}),Wa=Ba(function(e,r){return r.kind!==Un.NodeKind.Operator||r.id!==Pn.OperatorId.Mul&&r.id!==Pn.OperatorId.Div?void 0:r}),Ga=Ba(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id===Pn.OperatorId.Pow?r:void 0}),Ha=function(e){return Oa(Pa,ha(e),function(e,r,n){return ba(e,r,n,"")})}(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id===Pn.OperatorId.Percent?r:void 0}),Ka=Ba(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id===Pn.OperatorId.Concat?r:void 0}),ja=Ba(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id>=Pn.OperatorId.Eq&&r.id<=Pn.OperatorId.Ge?r:void 0}),Qa=Ba(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id===Pn.OperatorId.Range?r:void 0}),Ja=Ba(function(e,r){return r.kind===Un.NodeKind.Operator&&r.id===Pn.OperatorId.Union?r:void 0}),Xa=ga(function(e,r,n){if(r.kind===At.Spaces&&n.kind!==At.End&&n.kind!==Un.NodeKind.Operator){var t=Fa(e,r.start,wa(e,n),r.chars,"");return Un.operatorNode(Pn.OperatorId.Isect,t)}});function Ya(e,r,n){return Oa(e,Sa(Ca(r,e)),function(e,r,t){return 0===t.length?r:t.reduce(n(e),r)})}function qa(e){return function(r,n){var t=n[0],o=n[1],a=_a(e,r).start,i=_a(e,o).end,u=Fa(e,a,i,"","");return Un.appNode(t,[r,o],!0,u)}}function za(e,r){var n=Fa(e,_a(e,r[0]).start,_a(e,r[r.length-1]).end,"","");return Un.badNode(Un.BadType.Sequence,r,n)}var Za,$a,ei=Ya(Oa(function(e,r,n,t,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+h(e);return S.ULS.assertTag(595980864,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(wa(n,a),r)},Sa(ha(function(e,r){return r.kind!==Un.NodeKind.Operator&&r.kind!==At.Spaces&&r.kind!==At.End?r:void 0})),function(e,r,n){return 0===n.length?Un.literalNode(Fn.missingOper,!0,Fa(e,r,r,"","")):1===n.length?n[0]:za(e,n)}),Qa,qa),ri=Ya(ei,Xa,qa),ni=Ya(ri,Ja,qa),ti=Ya((Za=ni,$a=function(e){var r=!0;return function(n,t){var o=_a(e,t).start,a=_a(e,n).end,i=Fa(e,o,a,"","");if(r&&(r=!1,n.kind===Un.NodeKind.Literal&&"number"==typeof n.oper)){var u=t.id===Pn.OperatorId.Pos?n.oper:-n.oper;return Un.literalNode(u,!0,i)}return Un.appNode(t,[n],!0,i)}},Oa(Sa(Va),Za,function(e,r,n){return 0===r.length?n:r.reduceRight($a(e),n)})),Ha,function(e){return function(r,n){var t=n[0],o=n[1],a=_a(e,r).start,i=_a(e,t).end,u=Fa(e,a,i,"",""),c=Un.appNode(t,[r],!0,u);return o.kind===Un.NodeKind.Literal&&xn.operKind(o.oper)===Fn.OperKind.Missing?c:za(e,[c,o])}}),oi=Ya(ti,Ga,qa),ai=Ya(oi,Wa,qa),ii=Ya(ai,xa,qa),ui=Ya(ii,Ka,qa),ci=Ya(ui,ja,qa);var li=pa(ha(function(e,r){return r.kind===At.Spaces?r.chars:void 0}),""),si=function(e,r,n,t,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+h(e);return S.ULS.assertTag(595980830,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(a.start,r)};function fi(e){return ha(function(r,n){return n.kind===At.Sep&&n.value===e||void 0})}function di(e){return ha(function(r,n){return n.kind===At.Left&&n.value===e?n.start:void 0})}function pi(e){return ha(function(r,n){return n.kind===At.Right&&n.value===e||void 0})}var Ei,hi=fi(Ot.List),vi=fi(Ot.Row),gi=fi(Ot.Col),mi=fi(Ot.Qual),Ti=di(Nt.Paren),Si=pi(Nt.Paren),Ri=di(Nt.Brace),Ii=pi(Nt.Brace),Ci=di(Nt.SQuote),Ai=pi(Nt.SQuote),Ni=ha(function(e,r){return r.kind===At.Operator&&r.value===Pn.OperatorId.Range||void 0}),Oi=Ei={impl:function(e,r,n,t,o){return S.ULS.assertTag(595980828,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,r,n,t,o){return function(){return Ei.impl(e,r,n,t,o)}}},yi=ya(li,Oi.parser,li,ba),Li=La(Ti,Ua(Nt.Paren,ca.Union,yi),pa(Si,!1),si,function(e,r,n,t,o){var a=Fa(e,r,o,"","");return Un.parenNode(n,t,a)}),ki=Ra(yi,Ma(gi,yi)),Di=Ra(ki,Ma(vi,ki)),Mi=La(Ri,Ua(Nt.Brace,ca.Union,Di),pa(Ii,!1),si,function(e,r,n,t,o){var a=Fa(e,r,o,"","");return Un.arrayNode(n,t,a)}),_i=ha(function(e,r){if(r.kind===At.Ident||r.kind===At.CellRef&&r.isQualPart||r.kind===At.Literal&&r.isQualPart||r.kind===At.Operator&&r.value===Pn.OperatorId.Dot)return r.chars}),Fi=Ra(_i,_i),bi=ha(function(e,r){return r.kind===At.Ident?r.chars:void 0});function Ui(e){return e.kind===At.Literal&&"object"==typeof e.oper&&e.oper.kind===Fn.OperKind.Error&&e.oper.type===Fn.ErrorType.REF}function wi(e,r,n,t){return null==r?[Un.identQualifier(e,n,t),n?"'"+e+"'":e]:[Un.sheetRangeQualifier(e,r,n,t),n?"'"+e+":"+r+"'":e+":"+r]}var Pi=La(si,Fi,pa(Ma(Ni,Fi),void 0),si,function(e,r,n,t,o){var a=Fa(e,r,o,"","");return wi(n.join(""),null!=t?t.join(""):void 0,!1,a)}),Bi=ka(Ci,bi,pa(Ma(Ni,bi),void 0),Ai,si,function(e,r,n,t,o,a){return wi(n,t,!0,Fa(e,r,a,"",""))}),xi=La(Ci,Sa(ha(function(e,r){return r.kind===At.End||r.kind===At.Right&&r.value===Nt.SQuote?void 0:r.chars})),pa(Ca(Ai,pa(Da(mi,li),!1)),[!1,!1]),si,function(e,r,n,t,o){var a=t[0],i=t[1],u="'"+n.join("")+(a?"'":"")+(i?"!":""),c=Fa(e,r,o,"","");return[Un.badNode(Un.BadType.Qualifier,u,c),u]}),Vi=ga(function(e,r,n){if(Ui(r)){var t=Fa(e,r.start,n.start,"","");return[Un.errorQualifierLabeled(t),r.chars]}}),Wi=Oa(da([Pi,Bi,va(function(e,r){var n=Fa(e,r.start,r.start,"","");return[Un.relativeQualifierLabeled(n),""]})]),Da(mi,li),function(e,r,n){return[r[0],r[1]+"!"]}),Gi=da([Vi,Wi,xi]);function Hi(e,r){return r.kind===At.CellRef&&e.refStyle===r.refStyle}var Ki=ga(function(e,r,n){return Hi(e,r)?[r,n.start]:void 0});function ji(e,r){if(null!=e.row&&null!=e.col)return Un.cellRefSingle(e.row,e.col,r);if(null!=e.row)return Un.cellRefRow(e.row,e.row,r);if(null!=e.col)return Un.cellRefCol(e.col,e.col,r);var n="calc.parse.cellRefToken2cellRef: bad token "+h(e);return S.ULS.assertTag(595980831,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var Qi=ga(function(e,r,n){if(Hi(e,r)&&(r.refStyle!==Un.RefStyle.A1||null!=r.row&&null!=r.col))return ji(r,t=Fa(e,r.start,n.start,"",""));if(Ui(r)){var t=Fa(e,r.start,n.start,"","");return Un.cellRefErrorLabeled(t)}}),Ji=fa(sa(Aa(Ki,li,Ni,li,Ki),function(e,r){var n=r[0],t=n[0],o=n[1],a=r[1],i=(r[2],r[3]),u=r[4],c=u[0],l=u[1],s=Fa(e,t.start,o,"",a),f=Fa(e,c.start,l,i,""),d=ji(t,s),p=ji(c,f),E=void 0;if(d.kind===Un.CellRefKind.Single&&p.kind===Un.CellRefKind.Single){var h=Fa(e,t.start,l,"","");E=Un.cellRefRange(d,p,h)}else if(0===a.length&&0===i.length)if(d.kind===Un.CellRefKind.Row&&p.kind===Un.CellRefKind.Row){h=Fa(e,t.start,l,"","");E=Un.cellRefRow(d.row1,p.row1,h)}else if(d.kind===Un.CellRefKind.Col&&p.kind===Un.CellRefKind.Col){h=Fa(e,t.start,l,"","");E=Un.cellRefCol(d.col1,p.col1,h)}return null==E?la:t.isQualPart&&c.isQualPart?va(function(e,r){return r.kind===At.Sep&&r.value===Ot.Qual?void 0:E}):ua(E)}),Qi),Xi=ha(function(e,r){return r.kind===At.Ident||r.kind===At.CellRef&&r.isName?r.chars:void 0}),Yi=sa(Aa(si,Gi,si,pa(fa(Ji,Xi),void 0),si),function(e,r){var n=r[0],t=r[1],o=t[0],a=t[1],i=r[2],u=r[3],c=r[4];if(null==u)return o.kind!==Un.QualifierKind.SheetRange||o.isQuoted?o.kind===Un.QualifierKind.Error?ua(Un.literalNode(Fn.refErrorOper,!0,o.label)):ua(o.kind===Un.NodeKind.Bad?o:Un.badNode(Un.BadType.Qualifier,a,o.label)):la;if("string"==typeof u){if(o.kind===Un.QualifierKind.SheetRange&&!o.isQuoted)return la;var l=Fa(e,n,c,"","");if(o.kind===Un.NodeKind.Bad||o.kind===Un.QualifierKind.Error||o.kind===Un.QualifierKind.SheetRange){var s=o.kind===Un.NodeKind.Bad?o:Un.badNode(Un.BadType.Qualifier,a,o.label),f=Un.nameNode(u,void 0,Fa(e,i,c,"",""));return ua(Un.badNode(Un.BadType.Sequence,[s,f],l))}return ua(Un.nameNode(u,o,l))}var d=Fa(e,n,c,"","");if(o.kind===Un.NodeKind.Bad||o.kind===Un.QualifierKind.Document){var p=o.kind===Un.NodeKind.Bad?o:Un.badNode(Un.BadType.Qualifier,a,o.label);f=Un.cellRefNode(u,void 0,Fa(e,i,c,"",""));return ua(Un.badNode(Un.BadType.Sequence,[p,f],d))}var E=o.kind===Un.QualifierKind.Ident?Un.sheetQualifier(o.name,void 0,o.isQuoted,o.label):o;return ua(Un.cellRefNode(u,E,d))}),qi=ya(si,fa(Ji,Xi),si,function(e,r,n,t){var o=Fa(e,r,t,"","");return"string"==typeof n?Un.nameNode(n,void 0,o):n.kind===Un.CellRefKind.Error?Un.literalNode(Fn.refErrorOper,!0,o):Un.cellRefNode(n,void 0,o)}),zi=ga(function(e,r,n){if(r.kind===At.Literal)return Un.literalNode(r.oper,r.hasRight,Fa(e,r.start,n.start,"",""));if(r.kind===At.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var t=r.row.index+e.range.range.row+1;return Un.literalNode(t,!0,Fa(e,r.start,n.start,"",""))}});function Zi(e){return ga(function(r,n,t){if(e(n)){var o=Fa(r,n.start,t.start,"","");return Un.badNode(Un.BadType.Unexpected,n.chars,o)}})}var $i=Zi(function(e){return e.kind===At.Left&&e.value===Nt.Bracket}),eu=Zi(function(e){return e.kind===At.Right&&e.value===Nt.Bracket}),ru=ka(si,$i,Ua(Nt.Bracket,ca.Union,yi),pa(eu,void 0),si,function(e,r,n,t,o,a){var i=[n,t];null!=o&&i.push(o);var u=Fa(e,r,a,"","");return Un.badNode(Un.BadType.Sequence,i,u)}),nu=ga(function(e,r,n){switch(r.kind){case At.End:case At.Operator:case At.Spaces:return;case At.Sep:if(r.value!==Ot.Qual&&(e.leftDelim===Nt.Brace||r.value!==Ot.Col&&r.value!==Ot.Row))return;break;case At.Right:if(r.value===e.leftDelim)return}var t=r.kind===At.CellRef?Un.BadType.CellRef:Un.BadType.Unexpected,o=Fa(e,r.start,n.start,"","");return Un.badNode(t,r.chars,o)}),tu=ga(function(e,r,n){if((r.kind===At.Ident||r.kind===At.CellRef||r.kind===At.Literal&&"boolean"==typeof r.oper)&&n.kind===At.Left&&n.value===Nt.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var t=Fa(e,r.start,n.start,"","");return Un.nameNode(r.chars,void 0,t)}}),ou=La(Ti,Ua(Nt.Paren,ca.Arg,Ra(yi,Ma(hi,yi))),pa(Si,!1),si,function(e,r,n,t,o){return[n,t,o]}),au=Oa(tu,ou,function(e,r,n){var t=n[0],o=n[1],a=n[2],i=Fa(e,_a(e,r).start,a,"","");return Un.appNode(r,t,o,i)}),iu=Oa(da([au,Yi,qi,zi,Li,Mi,ru,nu]),Sa(ou),function(e,r,n){var t=_a(e,r).start;return n.reduce(function(r,n){var o=n[0],a=n[1],i=n[2],u=Fa(e,t,i,"","");return Un.appNode(r,o,a,u)},r)}),uu=ga(function(e,r,n){var t=void 0;if(r.kind===At.Operator&&(t=r.value),r.kind===At.Sep&&r.value===Ot.List&&e.listSep===ca.Union&&(t=Pn.OperatorId.Union),null!=t){var o=Fa(e,r.start,n.start,"","");return Un.operatorNode(t,o)}}),cu=ha(function(e,r){return r.kind===At.Spaces?r:void 0}),lu=fa(iu,uu),su=sa(lu,function(e,r){return ma(Ca(pa(cu,void 0),lu),function(e,r,n){var t=r[0],o=r[1];return null!=t&&n.push(t),n.push(o),n},[r])}),fu=Oa(pa(su,void 0),si,function(e,r,n){if(null==r){var t=Fa(e,n,n,"","");return Un.literalNode(Fn.missingOper,!0,t)}if(1===r.length){var o=r[0];if(o.kind!==Un.NodeKind.Operator&&o.kind!==At.Spaces)return o}return r.push(xt(n)),function(e,r){var n=e.length-1;if(n<0){var t="calc.parse.parseTerms: internal error: expected at least 1 term";return S.ULS.assertTag(595980865,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}if(e[0].kind===At.Spaces)return t="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+h(e),S.ULS.assertTag(595980866,s.LogCategory.msoulscat_ES_EWAJS,!1,t);if(n-1>=0&&e[n-1].kind===At.Spaces)return t="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+h(e),S.ULS.assertTag(595980867,s.LogCategory.msoulscat_ES_EWAJS,!1,t);if(e[n].kind!==At.End)return t="calc.parse.parseTerms: internal error: array[n].kind !== End in "+h(e),S.ULS.assertTag(595980868,s.LogCategory.msoulscat_ES_EWAJS,!1,t);var o=ia(ci,e,0,r);if(!1===o)return t="calc.parse.parseTerms: internal error: failed to parse "+h(e),S.ULS.assertTag(595980869,s.LogCategory.msoulscat_ES_EWAJS,!1,t);var a=o[0],i=o[1];if(i<n)return t="calc.parse.parseTerms: internal error: consumed "+i+" out of "+n+" in "+h(e),S.ULS.assertTag(595980870,s.LogCategory.msoulscat_ES_EWAJS,!1,t);return a}(r,e)});function du(e,r,n,t,o){var a=o.length-1;if(a<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return S.ULS.assertTag(595980832,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(o[a].kind!==At.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+h(o);return S.ULS.assertTag(595980833,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,n,t){return{localeInfo:e,refStyle:r,range:n,source:t,leftDelim:void 0,listSep:ca.Union,label:1,spans:{}}}(e.config.localeInfo,r,n,t),c=ia(yi,o,0,u);if(!1===c){i="calc.parse.parseTokens: internal error: failed to parse "+h(o);return S.ULS.assertTag(595980834,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}var l=c[0],f=c[1];if(f<a){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+a+" in "+h(o);return S.ULS.assertTag(595980835,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return Un.formula(l,u.spans)}Oi.impl=fu;var pu={"=":1,"+":0,"-":0,"@":-1};function Eu(e){return{parseFormula:function(r,n,t,o){return function(e,r,n,t,o){var a=o[0],i=null!=a?pu[a]:void 0;if(null==i)return xn.failure(ht("first character is not '=', '+', '-' or '@'"));if(i<0)return xn.failure(dt(["Lotus 1-2-3 syntax"]));if(r===Un.RefStyle.A1&&null==n)return S.ULS.assertTag(595980825,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined");var u=du(e,r,n,t,aa(e,r,n,o,i));return xn.success(u)}(e,r,n,t,o)},formatFormula:function(e,r,n,t){return function(e,r,n,t,o){if(r===Un.RefStyle.A1&&null==n)return S.ULS.assertTag(595980826,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.formatFormula: in A1 style, expected range to be defined");return xn.failure(dt(["formatFormula"]))}(0,e,r)}}}var hu=Un.QualifierKind,vu=Un.CellRefKind,gu=Un.NodeKind,mu=xn.ResultKind;function Tu(e){return e.kind===mu.Success}function Su(e,r){var n=e[r];return null==n?C("ParseResultHelper.getFormulaSpan: expected span for label "+r+" to be defined"):n}function Ru(e,r,n){return!!Tu(e)&&(function(e,r,n){if(null==e||null==n)return;var t={};null!=r?r.forEach(function(e){t[e]=!0}):t["*"]=!0;var o=[];o.push(e.node);for(;o.length>0;){var a=o.pop();if(null!=a)switch(a.kind){case gu.Literal:c("literal")&&n("literal",{label:a.label,value:a});break;case gu.Array:a.nodes.map(function(e){return e.map(function(e){o.push(e)})});break;case gu.App:if("object"!=typeof a.head)c("literal")&&n("literal",{label:a.label,value:a.head});else{var i=a.head;switch(i.kind){case gu.Operator:c("operator")&&n("operator",{label:a.label,value:i.id});break;case gu.Name:c("function")&&n("function",{label:a.label,name:i.whole,isClosed:a.isClosed,args:a.args});break;default:o.push(i)}}a.args.map(function(e){o.push(e)});break;case gu.Paren:o.push(a.node);break;case gu.Name:if(c("namedRange")){var u=a.whole.split(".");n("namedRange",{label:a.label,name:u[0],names:u.slice(1),qualifier:l(a)})}break;case gu.CellRef:c("range")&&s(a);break;case gu.Bad:break;default:return I("calc.parse.traverseFormula",a)}}function c(e){return t[e]||t["*"]}function l(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case hu.Sheet:var n=e.qualifier;r.type=hu.Sheet,r.sheet=n.sheet,null!=n.document&&(r.document=n.document.document,null!=n.document.path&&(r.documentPath=n.document.path));break;case hu.SheetRange:var t=e.qualifier;r.type=hu.SheetRange,r.sheet1=t.sheet1,r.sheet2=t.sheet2;break;case hu.Ident:var o=e.qualifier;r.type=hu.Ident,r.name=o.name;break;case hu.Document:var a=e.qualifier;r.document=a.document,null!=a.path&&(r.documentPath=a.path)}return r}}function s(r){if(null!=e&&null!=n)switch(r.ref.kind){case vu.Error:break;case vu.Col:var t=r.ref;n("range",{label:r.label,type:"col",startIndex:t.col1,endIndex:t.col2,span:Su(e.spans,t.label),qualifier:l(r)});break;case vu.Row:var o=r.ref;n("range",{label:r.label,type:"row",startIndex:o.row1,endIndex:o.row2,span:Su(e.spans,o.label),qualifier:l(r)});break;case vu.Single:var a=r.ref;n("range",{label:r.label,type:"cell",row:a.row,col:a.col,span:Su(e.spans,a.label),qualifier:l(r)});break;case vu.Range:var i=r.ref;n("range",{label:r.label,type:"range",top:i.ref1.row,left:i.ref1.col,bottom:i.ref2.row,right:i.ref2.col,topLeftSpan:Su(e.spans,i.ref1.label),bottomRightSpan:Su(e.spans,i.ref2.label),qualifier:l(r)})}}}(e.value,r,n),!0)}var Iu,Cu={isSuccess:Tu,traverse:Ru,extractReferences:function(e){if(Tu(e)){var r=[];return Ru(e,["range","namedRange"],function(n,t){var o={kind:n,ref:t,span:Su(e.value.spans,t.label)};r.push(o)}),r.sort(function(e,r){return e.span.start-r.span.start}),r}}};function Au(e){return{config:e}}!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Iu||(Iu={}));var Nu={Unclosed_expression:{code:1,category:Iu.SyntaxError},Illegal_array_literal_element:{code:2,category:Iu.SyntaxError},Empty_array_literal:{code:3,category:Iu.SyntaxError},Irregular_array_shape:{code:4,category:Iu.SyntaxError},Empty_parenthesis:{code:5,category:Iu.SyntaxError},Missing_operation_argument:{code:6,category:Iu.SyntaxError},Bad_node:{code:7,category:Iu.SyntaxError},Invalid_binder:{code:8,category:Iu.SyntaxError},Empty_formula:{code:9,category:Iu.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Iu.SyntaxError},Types_not_related:{code:1001,category:Iu.TypeError},Unexpected_application_head:{code:1002,category:Iu.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Iu.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Iu.TypeError},Excess_function_arguments:{code:1005,category:Iu.TypeError},Insufficient_function_arguments:{code:1006,category:Iu.TypeError}},Ou=Un.NodeKind,yu=Un.QualifierKind,Lu=Un.BadType,ku=Un.CellRefKind,Du=Mn.FormulaSource,Mu=Fn.OperKind,_u=Fn.ErrorType,Fu=Pn.SignatureType,bu=Pn.SpecialPrecs,Uu=Pn.getOperatorType,wu=Pn.WorksheetFuncId,Pu=Pn.getWorksheetFuncType,Bu=xn.operKind,xu=xn.getArguments,Vu=xn.getArgType,Wu=xn.defaultLiteralVisitor,Gu=xn.defaultFormulaVisitor,Hu=xn.dispatch,Ku=xn.startVisit,ju={};function Qu(e,r){return{context:e,result:r}}function Ju(e){return function(r){return r.kind===Ou.Literal&&e(r.oper)}}var Xu=Ju(function(e){return Bu(e)===Mu.Missing}),Yu=Ju(function(e){return Bu(e)===Mu.Error&&e.type===_u.REF}),qu=Ju(function(e){return 0!=(Bu(e)&(Mu.String|Mu.Error|Mu.Boolean))});function zu(e){return e.kind===Ou.Name&&void 0===e.qualifier}function Zu(e,r,n,t){void 0===t&&(t=!1),t||(e.errorData=e.reportError(r,n,e.errorData))}function $u(e,r){return r!==Mu.Range||0!=(e&Mu.Range)}function ec(e,r){if(r.kind===Ou.Literal)switch(Zu(e,r,Nu.Unclosed_expression,r.isClosed),Bu(r.oper)){case Mu.Number:case Mu.Boolean:case Mu.String:case Mu.Error:return;default:return void Zu(e,r,Nu.Illegal_array_literal_element)}Zu(e,r,Nu.Illegal_array_literal_element)}function rc(e,r,n){Zu(e,r,Nu.Types_not_related,$u(Mu.Array,n)),Zu(e,r,Nu.Unclosed_expression,r.isClosed);var t=r.nodes.length>0;if(Zu(e,r,Nu.Empty_array_literal,t),!t)return Qu(e,n);for(var o=r.nodes[0].length,a=0;a<r.nodes.length;a+=1){var i=r.nodes[a],u=i.length;Zu(e,r,Nu.Irregular_array_shape,u===o);for(var c=0;c<u;c+=1)ec(e,i[c])}return Qu(e,n)}function nc(e,r,n){if(e.earlyExit&&!e.isOk())throw ju;switch(r.kind){case Ou.Array:return rc(e,r,n);case Ou.Paren:return Zu(e,r,Nu.Unclosed_expression,r.isClosed),Zu(e,r,Nu.Empty_parenthesis,!Xu(r.node)),nc(e,r.node,n);case Ou.Bad:case Ou.Name:case Ou.CellRef:case Ou.App:case Ou.Literal:var t=ac(e,r);return Zu(e,r,Nu.Types_not_related,$u(t.result,n)),t.result=n,t;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function tc(e,r,n){var t,o=Pu(r),a=n.args,i=a.length,u=xu(n),c=u.length,l=e.isOk();c<o.minArgs&&Zu(e,void 0===(t=a[i-1])?n:t,Nu.Insufficient_function_arguments);0===o.restTypes.length&&c>o.headTypes.length&&Zu(e,void 0===(t=a[i-1])?n:t,Nu.Excess_function_arguments);o.restTypes.length>1&&r!==wu.SWITCH&&((c-o.headTypes.length)%o.restTypes.length!=0&&Zu(e,void 0===(t=a[i-1])?n:t,Nu.Insufficient_function_arguments));for(var s=0;s<c;s+=1)nc(e,u[s],Vu(o,s));var f=!l||e.isOk();return f&&(e.specialDependencies|=o.staticPrecs,function(e,r,n){switch(r){case wu.LET:var t=n[0];return void 0!==t?Zu(e,t,Nu.Invalid_binder,zu(t)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",t);case wu.FUN:for(var o=0;o<n.length-1;o+=1){var a=n[o];Zu(e,a,Nu.Invalid_binder,zu(a))}}}(e,r,a)),Qu(e,f?o.returnType:Fu.All)}function oc(e,r){Zu(e,r,Nu.Unclosed_expression,r.isClosed);var n=r.args;if(r.head.kind===Ou.Operator)return function(e,r,n){var t=Uu(r.id),o=n.length,a=o===t.minArgs;Zu(e,r,Nu.Incorrect_number_of_operator_arguments,a);for(var i=0;i<o;i+=1){var u=n[i];Xu(u)&&(a=!1,Zu(e,u,Nu.Missing_operation_argument)),nc(e,u,Vu(t,i))}return a?(e.specialDependencies|=t.staticPrecs,Qu(e,t.returnType)):Qu(e,Fu.All)}(e,r.head,n);if(zu(r.head)){var t=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==t)return tc(e,t,r)}for(var o=0;o<n.length;o+=1)nc(e,n[o],Fu.All);var a=r.head,i=ac(e,a);return $u(i.result,Mu.Range)||i.result===Mu.Error&&function(e){for(var r=e;r.kind===Ou.Paren;)r=r.node;return Yu(r)}(a)?Qu(e,Fu.All):(Zu(e,a,qu(a)||a.kind===Ou.Array?Nu.Unexpected_application_head:Nu.Unexpected_application_head_with_fix),Qu(e,Fu.All))}function ac(e,r){if(e.earlyExit&&!e.isOk())throw ju;switch(r.kind){case Ou.App:return oc(e,r);case Ou.Array:return rc(e,r,Mu.Array);case Ou.Bad:return Zu(e,r,Nu.Bad_node),Qu(e,Fu.All);case Ou.CellRef:return e.source!==Du.Cell&&e.source!==Du.Range||void 0===r.qualifier||r.qualifier.kind!==yu.Relative?Qu(e,Mu.Range):(Zu(e,r,Nu.Invalid_rel_sheet_qualifier_in_cell),Qu(e,Fu.All));case Ou.Literal:return Zu(e,r,Nu.Unclosed_expression,r.isClosed),Qu(e,Bu(r.oper));case Ou.Name:return Qu(e,Fu.All);case Ou.Paren:return Zu(e,r,Nu.Unclosed_expression,r.isClosed),Zu(e,r,Nu.Empty_parenthesis,!Xu(r.node)),ac(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var ic={ok:!0,isOk:Yr,collect:function(e,r,n){return!1}};function uc(e,r,n,t,o){void 0===o&&(o=!0);var a={globals:e,location:r,source:n,reportError:t.collect,isOk:function(){return t.isOk(a.errorData)},earlyExit:o,specialDependencies:bu.None,errorData:t.ok};return a}function cc(e,r){try{return Zu(e,r.node,Nu.Empty_formula,!Xu(r.node)),nc(e,r.node,Fu.All)}catch(r){return r!==ju&&S.ULS.traceTag(595952020,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+h(r)),Qu(e,Fu.All)}}function lc(e,r){if(r.kind!==Ou.Bad||r.type!==Lu.Sequence||3!==r.contents.length)return!1;var n=r.contents[0],t=r.contents[2];return n.kind===Ou.Bad&&n.type===Lu.Unexpected&&n.contents===e.leftBracket&&(t.kind===Ou.Bad&&t.type===Lu.Unexpected&&t.contents===e.rightBracket)}function sc(e,r){if(2===r.length){var n,t=r[0],o=r[1];return lc(e,t)?(n=o).kind===Ou.Name&&null!=n.qualifier&&n.qualifier.kind===yu.Ident?Ou.Name:function(e){return e.kind===Ou.CellRef&&null!=e.qualifier&&e.qualifier.kind===yu.Sheet&&null==e.qualifier.document}(o)?Ou.CellRef:void 0:function(e,r){return r.kind===Ou.Bad&&r.type===Lu.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,t)?zu(o)?Ou.Name:function(e){return e.kind===Ou.CellRef&&null==e.qualifier}(o)?Ou.CellRef:void 0:void 0}}function fc(e){if(e.kind===Ou.Literal&&e.isClosed)switch(Bu(e.oper)){case Mu.Number:case Mu.Boolean:case Mu.String:case Mu.Error:return!0;default:return!1}return!1}function dc(e,r){var n=r.head,t=n.kind!==Ou.Operator;if(!r.isClosed||r.args.some(function(r){return!pc(e,r,t)}))return!1;if(n.kind===Ou.Operator)return(a=Uu(n.id)).minArgs===r.args.length;if(!pc(e,n,!1))return!1;if(zu(n)){var o=e.config.localeInfo.getWorksheetFuncId(n.whole.toLocaleUpperCase());if(void 0!==o){var a=Pu(o),i=xu(r).length;if(i<a.minArgs)return!1;if(0===a.restTypes.length&&i>a.headTypes.length)return!1;if(a.restTypes.length>1&&o!==wu.SWITCH)if((i-a.headTypes.length)%a.restTypes.length!=0)return!1;return function(e,r){switch(e){case wu.LET:return zu(r[0]);case wu.FUN:return r.slice(0,r.length-1).every(zu);default:return!0}}(o,r.args)}}return!0}function pc(e,r,n){switch(r.kind){case Ou.Literal:return r.isClosed&&(!!n||Bu(r.oper)!==Mu.Missing);case Ou.Name:case Ou.CellRef:return!0;case Ou.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every(function(e){return n=e,t=r.nodes[0].length,n.length===t&&n.every(fc);var n,t});case Ou.App:return dc(e,r);case Ou.Paren:return r.isClosed&&pc(e,r.node,!1);case Ou.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function Ec(e,r,n){switch(r.kind){case Ou.Literal:case Ou.Name:break;case Ou.CellRef:r.ref.kind===ku.Row&&(n.rowRef+=1),r.ref.kind===ku.Col&&(n.colRef+=1);break;case Ou.Array:r.nodes.forEach(function(r){return r.forEach(function(r){return Ec(e,r,n)})});break;case Ou.App:r.head.kind!==Ou.Operator&&Ec(e,r.head,n),r.args.forEach(function(r){return Ec(e,r,n)});break;case Ou.Paren:Ec(e,r.node,n);break;case Ou.Bad:if(r.type===Lu.Sequence){var t=r.contents;if(function(e,r){return 2===r.length&&zu(r[0])&&lc(e,r[1])}(e,t))n.structRef+=1;else{var o=sc(e,t);null!=o?(o===Ou.Name?n.docQualName+=1:o===Ou.CellRef&&(n.docQualCellRef+=1),Ec(e,t[1],n)):t.forEach(function(r){return Ec(e,r,n)})}}else r.type===Lu.Qualifier&&(n.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var hc=Gu(Wu(function(e){return 1}),function(e){return 1},{vArray:function(e){var r=-1;return e.nodes.forEach(function(e){e.forEach(function(e){var n=Hu(e,hc);r=Math.max(r,n)})}),1+r},vRange:function(e){var r=Hu(e.ref1,hc),n=Hu(e.ref2,hc);return 1+Math.max(r,n)},vBad:function(e){if(e.type===Lu.Sequence){var r=-1;return e.contents.forEach(function(e){var n=Hu(e,hc);r=Math.max(r,n)}),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var n=Hu(e.qualifier,hc);r=Math.max(r,n)}return 1+Math.max(r,Hu(e.ref,hc))},vParen:function(e){return 1+Hu(e.node,hc)},vApp:function(e){var r=-1;return e.args.forEach(function(e){var n=Hu(e,hc);r=Math.max(r,n)}),1+r}});var vc=[];function gc(e,r,n,t,o){var a,i={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(Ec(e.config.localeInfo,t.node,i),i.rowRef+i.colRef+i.structRef+i.docQualName+i.docQualCellRef+i.badQual>0&&S.ULS.traceTag(595961670,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+o+"; anonymize: "+h(t.node)+"; stats = "+JSON.stringify(i)),Jr(Wr.CalcStrictFormulaChecking))if(vc.length<10){var u=(a=t.node,Ku(a,hc,-1));vc.push(u)}else S.ULS.traceTag(595957962,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+vc.join("; ")),vc=[];var c=Jr(Wr.CalcStrictFormulaChecking)?function(e,r,n,t){return cc(uc(e,r,n,ic),t).context.errorData}(e,r,n,t):pc(e,t.node,!1);return c||function(e){e.kind!==Ou.App||e.isClosed||S.ULS.traceTag(595949718,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(t.node),Br({},t,{isWellFormed:c})}var mc,Tc,Sc=Fn.SpecialPrecs,Rc=Fn.precedents;function Ic(e){return{findStaticPrecedents:function(e){return Rc([],[],Sc.All,!1)},checkFormula:function(r,n,t,o){return gc(e,r,n,t,void 0!==o?o:"undefined")},checkFormulaWithCodes:function(r,n,t){return function(e,r,n,t){return cc(uc(e,r,n,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,n){return n.push({label:e.label,errorCode:r.code}),n}},!1),t).context.errorData}(e,r,n,t)},findBestFormat:function(e,r,n){n.node}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(mc||(mc={})),function(e){e.RangeValues="RangeValues"}(Tc||(Tc={}));var Cc=Fn.div0ErrorOper,Ac=Fn.numErrorOper,Nc=Math.pow(2,-52),Oc=Math.pow(2,-1022);function yc(e){return Math.abs(e)<Oc?0:e}function Lc(e){return isFinite(e)?yc(e):Ac}var kc=Math.pow(2,32)-2;function Dc(e,r){var n=Math.pow(e,r);return isFinite(n)?yc(n):r<0?Cc:Ac}var Mc,_c,Fc,bc={sqrt:function(e){return Lc(Math.sqrt(e))},sqrtpi:function(e){return Lc(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return Lc(Math.exp(e))},power:function(e,r){return 0===r?0===e?Ac:1:0===e?r<0?Cc:0:e>0?Dc(e,r):function(e){if(e<-kc||e>kc)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*Nc<=r&&r<=1+2*Nc}(r)?Dc(e,Math.round(r)):Ac},ln:function(e){return Lc(Math.log(e))},log10:function(e){return Lc(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return Ac;var n=Math.log(e)/Math.log(r);return isFinite(n)?yc(n):Cc},sin:function(e){return Math.abs(e)<Math.pow(2,27)?Lc(Math.sin(e)):Ac},cos:function(e){return Math.abs(e)<Math.pow(2,27)?Lc(Math.cos(e)):Ac},tan:function(e){return Math.abs(e)<Math.pow(2,27)?Lc(Math.tan(e)):Ac},asin:function(e){return Lc(Math.asin(e))},acos:function(e){return Lc(Math.acos(e))},atan:function(e){return Lc(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Cc:yc(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(Fc||(Fc={}));var Uc=(Mc=Xr(Yr,Yr)).wrap,wc=Mc.unwrap,Pc=(_c=Xr(function(e){return-e},function(e){return-e})).wrap,Bc=_c.unwrap;function xc(e){return e>0}function Vc(e){return{kind:e,data:void 0,children:void 0}}function Wc(e,r,n){var t=Vc(Fc.Array);return t.children=n,t.data={rows:e,cols:r},t}function Gc(e,r){var n=Vc(Fc.Fun);return n.children=r,n.data=e,n}function Hc(e,r,n){var t=Vc(Fc.Let);return t.children=[r,n],t.data=e,t}function Kc(e,r,n){var t=Vc(Fc.App);return t.children=n,t.data={funName:e,funType:r},t}function jc(e){var r=Vc(Fc.Ident);return r.data=e,r}function Qc(e,r,n){var t=Vc(Fc.If);return t.children=[e,r,n],t}function Jc(e){return"object"!=typeof e||e.kind>0}function Xc(e,r){for(var n,t=0;t<e.length;t+=1){var o=e[t],a=r(o);void 0===n?a!==o&&(n=e.slice(0,t)).push(a):n.push(a)}return void 0!==n?n:e}function Yc(e,r){return Xc(e,function(e){return function(r){return Xc(r,e)}}(r))}function qc(e,r){return r(function(e,r){if(Jc(e))return e;switch(e.kind){case Fc.Let:var n=e.children,t=n[0],o=n[1],a=r(t),i=r(o);return t===a&&o===i?e:Hc(e.data,a,i);case Fc.App:var u=Xc(e.children,r);return u===e.children?e:Kc(e.data.funName,e.data.funType,u);case Fc.If:var c=e.children,l=c[0],s=c[1],f=c[2],d=r(l),p=r(s),E=r(f);return l===d&&s===p&&f===E?e:Qc(d,p,E);case Fc.Fun:var h=r(e.children);return h===e.children?e:Gc(e.data,h);case Fc.Array:var v=Yc(e.children,r);return v===e.children?e:Wc(e.data.rows,e.data.cols,v);case Fc.Name:case Fc.CellRef:case Fc.Ident:return e}}(e,function(e){return qc(e,r)}))}var zc=function(){function e(e,r,n){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var t=n.length;t<e&&C("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+t);for(var o=0;o<t;o+=1){var a=n[o].length;a<r&&C("calc.common.StrictArray2D: expected elements["+o+"].length >= "+e+"; given "+a)}this.rows=e,this.cols=r,this.elements=n}return e.prototype.get=function(e,r){return O("calc.common.StrictArray2D.get",e,this.rows),O("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new Zc(this.rows,this.cols,function(n,t){return e(r.elements[n][t])})},e}();var Zc=function(){function e(e,r,n){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=n}return e.prototype.get=function(e,r){return O("calc.common.NonstrictArray2D.get",e,this.rows),O("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=$c(this.rows,this.cols,this.func);return new zc(this.rows,this.cols,e)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,function(e,t){return r(n.func(e,t))})},e}();function $c(e,r,n){for(var t=[],o=0;o<e;o+=1){for(var a=[],i=0;i<r;i+=1)a[i]=n(o,i);t[o]=a}return t}function el(e){return $c(e.rows,e.cols,e.get.bind(e))}function rl(e,r,n){for(var t=[],o=[],a=0;a<r;a+=1)o[a]=n;for(var i=0;i<e;i+=1)t[i]=o;return t}function nl(e,r,n){return new Zc(e,r,function(e,r){return n})}var tl,ol=Mn.FormulaSource,al=xn.ResultKind,il=xn.isGridCell,ul=xn.ReasonKind,cl=xn.notImplemented,ll=xn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(tl||(tl={}));var sl,fl,dl=Br({},ul,tl);function pl(e,r){return{config:e,mathpack:r}}function El(e){return{kind:dl.IllFormedFormula,message:e}}function hl(e){return{kind:sl.FinalValue,oper:e}}function vl(e){return{kind:sl.PendingValue,anchor:e}}function gl(e,r,n){return r!==ol.Cell||il(e.range)||C("calc.runtime.cellFormula: expected single-cell range; given "+h(e)),{kind:sl.Formula,range:e,source:r,formula:n}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(sl||(sl={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(fl||(fl={}));var ml={kind:dl.Stopped};function Tl(e){return 0===e.length&&C("calc.runtime.unevaluated: expected nonempty array"),{kind:dl.Unevaluated,anchors:e}}function Sl(e,r,n,t,o,a,i,u,c,l,s,f,d,p,E,h){return void 0===h&&(h=function(e){return Ir(cl(["getUsedRange"]))}),{config:e,mathpack:r,getDocumentLoc:function(e,r){return Or(n(e,r))},getSheetIndex:t,getCellValue:o,getCellValues:a,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[fl.Continue],schedulerInfo:null!=E?E:{},setCellValue:l,setCellValues:s,setCellFailure:f,setDynamicPrecs:d,loadObjects:p,getUsedRange:h}}function Rl(e){return{kind:dl.NameCycle,names:e}}function Il(e){return{kind:dl.CellCycle,cells:e}}function Cl(e){return{kind:dl.PreviousFailure,range:e}}function Al(e){return{kind:dl.JavaScriptError,error:e}}function Nl(e){return{kind:al.Paused,reason:dl.Timeout,resume:e}}function Ol(e){if(e.kind===al.Failure)return e.reason.kind}var yl=Mn.gridCell,Ll=Mn.gridRange,kl=Fn.arrayOper,Dl=Fn.naErrorOper,Ml=Fn.OperKind,_l=Ml.Number|Ml.String|Ml.Boolean|Ml.Error|Ml.Rich|Ml.Array,Fl=Ml.Number|Ml.String|Ml.Boolean|Ml.Error|Ml.Blank|Ml.Rich,bl=Fl|Ml.Array;function Ul(e,r,n){var t=e+": generated Excel error, type "+r+"; "+n;S.ULS.traceTag(596120270,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)}function wl(e){return"object"==typeof e&&e.kind===Ml.Error}function Pl(e){return"object"==typeof e&&e.kind===Ml.Blank}function Bl(e){return"object"==typeof e&&e.kind===Ml.Array}function xl(e){return e.kind===je.Success?e.value:void 0}function Vl(e,r){switch(e.kind){case je.Success:return Rr(hl(e.value));case je.Failure:return Ir(Cl(r))}}function Wl(e,r,n){var t=Bl(n)?function(e,r,n,t,o,a){if(e===n&&r===t)return o;if(1===e&&1===r)return rl(n,t,void 0===o[0]?a:o[0][0]);var i,u=[];i=1===e?function(e,n){return n<r?o[0][n]:a}:1===r?function(r,n){return r<e?o[r][0]:a}:function(n,t){return n<e&&t<r?o[n][t]:a};for(var c=0;c<n;c+=1){u.push([]);for(var l=0;l<t;l+=1)u[c][l]=i(c,l)}return u}(n.rows,n.cols,e,r,n.opers,Dl):rl(e,r,n);return kl(e,r,t)}function Gl(e,r){var n=e.row,t=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.min(n,i),f=Math.min(t,u),d=Math.max(n+o,i+c)-s,p=Math.max(t+a,u+l)-f;return Ll(s,f,d,p)}function Hl(e){return 0===e.length&&C("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Gl)}function Kl(e,r){var n=e.row,t=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.max(n,i),f=Math.max(t,u),d=Math.min(n+o,i+c)-s,p=Math.min(t+a,u+l)-f;if(!(d<=0||p<=0))return Ll(s,f,d,p)}function jl(e){return e.rows*e.cols}var Ql,Jl=Un.NodeKind,Xl=xn.getArguments,Yl=Fn.arrayOper,ql=Pn.WorksheetFuncId,zl=xn.success,Zl=(Ql=0,function(){var e=Ql;return Ql+=1,e});function $l(e){return"object"!=typeof e||Jc(e)&&("object"!=typeof(r=e)||r.kind===Ml.Error||r.kind===Ml.Array||r.kind===Ml.Rich);var r}function es(e,r,n){var t=Xl(n).map(function(n){return rs(e,r,n)}),o=Pn.getWorksheetFuncType(ql._UDF);return Kc(Pc(ql._UDF),o,[rs(e,r,n.head)].concat(t))}function rs(e,r,n){switch(n.kind){case Jl.Array:var t=n.nodes.map(function(n){return n.map(function(n){return rs(e,r,n)})});return g=(v=t).length,m=void 0===v[0]?0:v[0].length,v.every(function(e){return e.every($l)})?Yl(g,m,v):Wc(g,m,v);case Jl.App:var o=n.head;if(o.kind===Jl.Operator){var a=Xl(n).map(function(n){return rs(e,r,n)}),i=Pn.getOperatorType(o.id);return Kc(Uc(o.id),i,a)}if(o.kind===Jl.Name&&null==o.qualifier)if(null!=(c=e.config.localeInfo.getWorksheetFuncId(o.whole.toLocaleUpperCase()))){var u=void 0;switch(c){case ql.LET:u=function(e,r,n){if(3===n.args.length){var t=n.args[0];if(t.kind===Jl.Name&&null==t.qualifier){var o=t.whole,a=Zl(),i=zr(r);return i[o]=a,Hc(a,rs(e,r,n.args[1]),rs(e,i,n.args[2]))}}}(e,r,n);break;case ql.FUN:u=function(e,r,n){var t=n.args.slice(0,n.args.length-1);if(t.length>0&&t.every(function(e){return e.kind===Jl.Name&&null==e.qualifier})){for(var o=t.map(function(e){return e.whole}),a=o.map(Zl),i=zr(r),u=0;u<o.length;u+=1)i[o[u]]=a[u];return Gc(a,rs(e,i,n.args[t.length-1]))}}(e,r,n);break;case ql.IF:u=function(e,r,n){var t=n.args;return 3===t.length?Qc(rs(e,r,t[0]),rs(e,r,t[1]),rs(e,r,t[2])):2===t.length?Qc(rs(e,r,t[0]),rs(e,r,t[1]),!1):void 0}(e,r,n);break;default:a=Xl(n).map(function(n){return rs(e,r,n)}),i=Pn.getWorksheetFuncType(c);u=Kc(Pc(c),i,a)}return void 0===u?es(e,r,n):u}return es(e,r,n);case Jl.Paren:return rs(e,r,n.node);case Jl.Name:var c;if(null==n.qualifier)if(void 0!==(c=r[n.whole]))return jc(c);return f=n.whole,d=n.whole.split("."),p=n.qualifier,(E=Vc(Fc.Name)).data={whole:f.toLocaleUpperCase(),split:d.map(function(e){return e.toLocaleUpperCase()}),qualifier:p},E;case Jl.CellRef:return function(e,r){var n=Vc(Fc.CellRef);return n.data={ref:e,qualifier:r},n}(n.ref,n.qualifier);case Jl.Literal:return n.oper;case Jl.Bad:var l="calc.runtime.compile: unexpected bad node "+h(n);return S.ULS.assertTag(595980820,s.LogCategory.msoulscat_ES_EWAJS,!1,l);default:return I("calc.runtime.compile",n)}var f,d,p,E,v,g,m}var ns=function(e){if(!Jc(e)&&e.kind===Fc.App&&!xc(e.data.funName)){var r=Bc(e.data.funName);if(r===ql.IFERROR||r===ql.IFNA){var n=Zl(),t=jc(n),o=r===ql.IFERROR?ql.ISERROR:ql.ISNA,a=Pn.getWorksheetFuncType(o),i=Qc(Kc(Pc(o),a,[t]),e.children[1],t);return Hc(n,e.children[0],i)}}return e};var ts,os="__compiledFormulaBrand__";function as(e,r){return function(e){return e.kind===os}(r)?r.term:I(e+": expected known compiled formula type; given "+h(r),r)}function is(e,r,n,t){var o=rs(e,qr(),t.node),a=qc(o,ns);return zl(function(e){return{kind:os,term:e}}(a))}function us(e){return{compileFormula:function(r,n,t){return is(e,0,0,t)}}}function cs(e,r){return 0==(e&r)}function ls(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(ts||(ts={}));var ss={kind:ts.Empty};function fs(e){return e===ss}function ds(e,r){return{kind:ts.Lf,key:e,value:r}}function ps(e,r,n,t){return{kind:ts.Br,prefix:e,mask:r,l:n,r:t}}function Es(e,r,n,t){var o=function(e,r){return n=e^r,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)^n>>>1;var n}(e,n),a=ls(e,o),i=cs(e,o);return ps(a,o,i?r:t,i?t:r)}var hs,vs=ss,gs=function e(r,n,t){switch(t.kind){case ts.Empty:return ds(r,n);case ts.Lf:var o=ds(r,n);return t.key===r?o:Es(r,o,t.key,t);case ts.Br:return function(e,r,n){return ls(e,n)===r}(r,t.prefix,t.mask)?cs(r,t.mask)?ps(t.prefix,t.mask,e(r,n,t.l),t.r):ps(t.prefix,t.mask,t.l,e(r,n,t.r)):Es(r,ds(r,n),t.prefix,t)}},ms=function(e,r){for(var n=r;n.kind===ts.Br;)n=cs(e,n.mask)?n.l:n.r;if(!fs(n))return e===n.key?n.value:void 0},Ts=Mn.FormulaSource,Ss=xn.isSheetGridCell,Rs=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Is(e){throw new Rs(e)}function Cs(e,r,n,t){return{range:e,source:r,precedents:n,visitedCellMap:t}}function As(e,r,n,t){if(r===Ts.Cell){if(Ss(e))return Cs(e,r,n,t);C("calc.runtime.evalLocals: expected single-cell range; given "+h(e))}return Cs(e,r,n,t)}Rs.prototype=Object.create(Error.prototype),Rs.prototype.constructor=Rs,function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(hs||(hs={}));var Ns={kind:hs.Default},Os=function(){function e(e){this.context=e,this.latestTransition=hs.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=hs.Default,Ns},e.prototype.performDependencyTransition=function(e){return this.latestTransition=hs.Dependency,{kind:hs.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=hs.Call,{kind:hs.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=hs.Write,{kind:hs.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=hs.Return,{kind:hs.Return,result:e}},e}(),ys={newVisitedMap:ks,visit:function(e,r,n){return Ds(Us,e,r,n)},unVisit:function(e,r,n){return Ms(Us,e,r,n)},lookup:function(e,r){return _s(Us,e,r)},runFrom:function(e,r){return Fs(Us,e,r)}},Ls={newVisitedMap:ks,visit:function(e,r,n){return Ds(ws,e,r,n)},unVisit:function(e,r,n){return Ms(ws,e,r,n)},lookup:function(e,r){return _s(ws,e,r)},runFrom:function(e,r){return Fs(ws,e,r)}};function ks(){return{run:[],visited:qr()}}function Ds(e,r,n,t){var o=e(r);t.visited[o]=n,t.run.push([o,r])}function Ms(e,r,n,t){var o=e(r);t.visited[o]=n,t.run.pop()}function _s(e,r,n){return n.visited[e(r)]}function Fs(e,r,n){for(var t=[],o=n.run,a=0;a<o.length;){var i=o[a][0];if(e(r)===i)break;a+=1}for(;a<o.length;)t.push(o[a][1]),a+=1;return t}function bs(e){var r=e.document,n=e.index,t="$";return null!=r.path&&(t+=r.path),t+=";",t+=r.name,t+=";",null!=n&&(t+=n,t+=";"),t}function Us(e){var r=bs(e.scope);return r+=";",r+=e.name}function ws(e){var r=bs(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var Ps=Fn.SpecialPrecs,Bs=Fn.precedents,xs=Fn.OperKind,Vs=xn.failure,Ws=xn.sheetGridRangeAnchor,Gs=xn.success,Hs=xn.ResultKind,Ks=function(e){function r(r,n){var t=e.call(this,r)||this;return t.cell=n,t.locals=void 0,t}return Pr(r,e),r.prototype.getRealReason=function(e){if(e.kind!==dl.PreviousFailure)return e;var r=Ws(e.range),n=Ls.lookup(r,this.context.visitedCellMap);return"object"==typeof n&&n.kind===Hs.Failure?n.reason:e},r.prototype.visitAnchor=function(e){var r=Ws(e.range),n=Ls.lookup(r,this.context.visitedCellMap);if(null!=n){var t="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+h(r)+"; given "+h(n));return S.ULS.assertTag(595980812,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}Ls.visit(r,sl.PendingValue,this.context.visitedCellMap);var o=Bs([],[],Ps.None,!0);return this.locals=As(e.range,e.source,o,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var n=Ws(r.range);return Ls.unVisit(n,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Hs.Failure)return this.performReturnTransition(Vs(this.getRealReason(e.reason)));var r=e.value;if(r.kind===sl.FinalValue)return this.performReturnTransition(Gs(r.oper));var n=this.context.globals.getCellFormula(r.anchor);if(n.kind===Hs.Failure){var t="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return S.ULS.assertTag(595980813,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}var o=n.value;if(null==o){t="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+h(r.anchor)+") != null");return S.ULS.assertTag(595980814,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}var a=this.visitAnchor(o),i=this.context.createFormulaEvaluationMachine(this.context,a,o.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===xs.Range||r.kind===xs.Missing)){var n="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+h(r));return S.ULS.assertTag(595980815,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=this.unVisitAnchor(void 0);if(null==t){n="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return S.ULS.assertTag(595980816,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(e,t)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===dl.Unevaluated){var n="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+h(r));return S.ULS.assertTag(595980817,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=r===e.reason?e:Vs(r),o=this.unVisitAnchor(t);if(null==o){n="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return S.ULS.assertTag(595980818,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(t,o)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(Os);function js(e,r){return new Ks(e,r)}function Qs(e,r){if(0===r.length)return[];for(var n=vd(e),t=[],o=0;o<r.length;o+=1)t.push(js(n.machineContext,r[o]));return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t:Nl(function(t){return e(r,"number"==typeof t?t:n)})}(new Td(n,t),Ed(pd(e.schedulerInfo)))}var Js=Mn.FormulaSource,Xs=Mn.sheetGridCell,Ys=Mn.sheetGridRange,qs=Fn.OperKind,zs=Fn.ErrorType,Zs=Fn.refErrorOper,$s=Fn.valueErrorOper,ef=Fn.arrayOper,rf=xn.ResultKind,nf=xn.isGridCell,tf=xn.isSheetIndex,of=xn.getArgType;function af(e,r){if(Ls.lookup(e,r.visitedCellMap)===sl.PendingValue)return Is(Il(Ls.runFrom(e,r.visitedCellMap)))}function uf(e,r,n,t){r.precedents.cells.push(n);var o=e.getCellValue(n);if(o.kind===rf.Failure)return Is(o.reason);var a=o.value;if(a.kind===sl.FinalValue)return a.oper;af(a.anchor,r),t.push(a.anchor)}function cf(e,r,n,t){r.precedents.cells.push(n);var o=e.getCellValues(n);if(o.kind===rf.Failure)return Is(o.reason);var a=t.length,i=function(e,r,n){for(var t=[],o=r.length,a=0,i=0;i<o;i+=1){t.push([]);var u=r[i].length;a=0===a?u:Math.min(u,a);for(var c=0;c<u;c+=1){var l=r[i][c];sl.FinalValue===l.kind?t[i][c]=l.oper:(af(l.anchor,e),n.push(l.anchor),t[i][c]=Zs)}}return new zc(o,a,t)}(r,o.value,t);return a===t.length?i:void 0}function lf(e,r,n,t){var o=cf(e,r,n,t);if(null!=o)return ef(o.rows,o.cols,el(o.map(function(e){return Pl(e)?0:e})))}function sf(e,r,n,t,o){if(0!=(t&qs.Range))return n;if("object"!=typeof n||n.kind!==qs.Range)return n;var a=n.sheets;if(!tf(a))return Ul("calc.runtime.dereference",zs.REF,"3D range, oper = "+h(n)),Zs;if(1!==n.ranges.length)return Ul("calc.runtime.dereference",zs.VALUE,"union range, oper = "+h(n)),$s;var i=n.ranges[0];if(0!=(t&Fl)){if(nf(i))return uf(e,r,Xs(a,i),o);if(r.source===Js.Cell){var u=function(e,r){var n=e.row,t=e.col,o=r.row,a=r.col,i=r.rows,u=r.cols,c=o<=n&&n<o+i,l=a<=t&&t<a+u;return c&&l?yl(n,t):c&&1===u?yl(n,a):l&&1===i?yl(o,t):void 0}(r.range.range,i);return null==u?(Ul("calc.runtime.dereference",zs.VALUE,"empty intersection, oper = "+h(n)),$s):uf(e,r,Xs(a,u),o)}return lf(e,r,Ys(a,i),o)}return 0!=(t&qs.Array)?lf(e,r,Ys(a,i),o):(Ul("calc.runtime.dereference",zs.VALUE,"bad target type "+t),$s)}function ff(e,r,n,t){for(var o=[],a=0;a<n.length;a+=1){var i=sf(e,r,n[a],of(t,a),o);null!=i&&(n[a]=i)}if(o.length>0)return Is(Tl(o))}var df=Fn.OperKind,pf=Fn.valueErrorOper,Ef=Fn.arrayOper,hf=xn.operKind,vf=[pf,0,"",!1,!1],gf=df.Number|df.String|df.Boolean;function mf(e){var r=e&gf;return vf[r&-r]}function Tf(e,r,n){var t=function e(r,n,t){if("number"==typeof n)return 0!=(t&df.Number)?n:0!=(t&df.String)?r.formatNumber(n):0!=(t&df.Boolean)?0!==n:0!=(t&df.Array)?Ef(1,1,[[n]]):pf;if("string"==typeof n){if(0!=(t&df.String))return n;if(0!=(t&df.Number)){if(0===n.length)return pf;var o=r.parseNumber(n);return Sr(o)?o:pf}return 0!=(t&df.Boolean)?0===r.stringCompareCI(n,r.trueName)||0!==r.stringCompareCI(n,r.falseName)&&pf:pf}if("boolean"==typeof n)return 0!=(t&df.Boolean)?n:0!=(t&df.Number)?n?1:0:0!=(t&df.String)?n?r.trueName:r.falseName:pf;if(0!=(t&n.kind))return n;switch(n.kind){case df.Error:return n;case df.Missing:return 0!=(t&df.Blank)?Fn.blankOper:mf(t);case df.Blank:return mf(t);case df.Rich:return e(r,n.getFallback(),t);default:return pf}}(e.config.localeInfo,r,n);return wl(t)&&!wl(r)&&Ul("calc.runtime.coerceOper",t.type,"kind = "+hf(r)),t}var Sf=Mn.sheetIndex,Rf=Fn.OperKind,If=Fn.rangeSeqOper,Cf=Fn.ErrorType,Af=Fn.valueErrorOper,Nf=Fn.div0ErrorOper,Of=Fn.nullErrorOper,yf=Pn.OperatorId,Lf=xn.operKind,kf=xn.isSheetIndex;function Df(e,r){switch(e){case yf.Eq:return 0===r;case yf.Ne:return 0!==r;case yf.Lt:return r<0;case yf.Gt:return r>0;case yf.Le:return r<=0;case yf.Ge:return r>=0}}function Mf(e,r,n){return Df(e,r-n)}function _f(e,r,n){return Df(e,r.toLocaleUpperCase().localeCompare(n.toLocaleUpperCase()))}function Ff(e,r,n){return Df(e,r<n?-1:r>n?1:0)}function bf(e,r,n){if(kf(r.sheets))if(kf(n.sheets))if(r.sheets.document===n.sheets.document){if(r.sheets.index===n.sheets.index)return Sf(r.sheets.document,r.sheets.index);t="different sheet, range1 = "+h(r)+", range2 = "+h(n);Ul(e,Cf.VALUE,t)}else{var t="different document, range1 = "+h(r)+", range2 = "+h(n);Ul(e,Cf.VALUE,t)}else Ul(e,Cf.VALUE,"3D reference, range2 = "+h(n));else Ul(e,Cf.VALUE,"3D reference, range1 = "+h(r))}function Uf(e,r,n){if(1===n.length){var t=n[0];switch(r){case yf.Percent:return yc(t/100);case yf.Neg:return-t;case yf.Pos:return t;default:var o="bad application of "+r+" to 1 argument";return Ul("calc.runtime.applyOperator",Cf.VALUE,o),Af}}if(2===n.length){t=n[0];var a=n[1];switch(r){case yf.Add:return Lc(t+a);case yf.Sub:return Lc(t-a);case yf.Mul:return Lc(t*a);case yf.Div:return 0===a?(Ul("calc.runtime.applyOperator",Cf.DIV0,"division by zero"),Nf):Lc(t/a);case yf.Pow:return e.mathpack.power(t,a);case yf.Concat:return t+a;case yf.Eq:case yf.Ne:case yf.Lt:case yf.Le:case yf.Gt:case yf.Ge:return function(e,r,n){var t=Lf(r),o=Lf(n);if(t!==o){if(t===Rf.Blank)switch(o){case Rf.Number:return Ff(e,0,n);case Rf.String:return _f(e,"",n);case Rf.Boolean:return Mf(e,!1,n)}if(o===Rf.Blank)switch(t){case Rf.Number:return Ff(e,r,0);case Rf.String:return _f(e,r,"");case Rf.Boolean:return Mf(e,r,!1)}return Df(e,t-o)}switch(t){case Rf.Number:return Ff(e,r,n);case Rf.String:return _f(e,r,n);case Rf.Boolean:return Mf(e,r,n);case Rf.Blank:return Df(e,0);default:return!1}}(r,t,a);case yf.Range:return function(e,r){var n=bf("calc.runtime.applyRangeOp",e,r);if(null==n)return Af;var t=[Gl(Hl(e.ranges),Hl(r.ranges))];return If(n,t)}(t,a);case yf.Isect:return function(e,r){var n=bf("calc.runtime.applyIsectOp",e,r);if(null==n)return Af;for(var t=[],o=0;o<e.ranges.length;o+=1)for(var a=0;a<r.ranges.length;a+=1){var i=Kl(e.ranges[o],r.ranges[a]);null!=i&&t.push(i)}if(0===t.length){var u="empty intersection, range1 = "+h(e)+", range2 = "+h(r);return Ul("calc.runtime.applyIsectOp",Cf.NULL,u),Of}return If(n,t)}(t,a);case yf.Union:return null==(l=bf("calc.runtime.applyUnionOp",u=t,c=a))?Af:If(l,u.ranges.concat(c.ranges));case yf.And:return t&&a;case yf.Or:return t||a;case yf.Xor:return t!==a;case yf.Min:return Math.min(t,a);case yf.Max:return Math.max(t,a);default:var i="bad application of "+r+" to 2 arguments";return Ul("calc.runtime.applyOperator",Cf.VALUE,i),Af}}var u,c,l,s="bad application of "+r+" to "+n.length+" arguments";return Ul("calc.runtime.applyOperator",Cf.VALUE,s),Af}var wf=Mn.sheetIndex,Pf=Mn.sheetGridRange,Bf=Fn.arrayOper,xf=Fn.nameErrorOper,Vf=Fn.naErrorOper,Wf=Fn.numErrorOper,Gf=Fn.valueErrorOper,Hf=Fn.OperKind,Kf=Fn.ErrorType,jf=Fn.SpecialPrecs,Qf=Pn.functionType,Jf=Pn.FunctionFlags,Xf=Pn.SignatureType,Yf=Pn.WorksheetFuncId,qf=Pn.getOperatorType,zf=Pn.getWorksheetFuncType,Zf=xn.operKind,$f=xn.ResultKind,ed=xn.success,rd=xn.getArgType,nd=xn.isValidArgsLength,td=Hf.Number|Hf.String|Hf.Boolean|Hf.Rich|Hf.Error|Hf.Blank,od=Qf(3,[Hf.Boolean,td,td],[],Xf.All,jf.None,Jf.None),ad=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var n=zf(e),t=r.some(function(e){return"object"==typeof e&&e.kind===Hf.Range})?r.slice(0):r;return ff(this.globals,this.locals,t,n),this.runFunctionToCompletion(Pc(e),n,t)},e.prototype.applyOperatorOrFunction=function(e,r){if(xc(e))return Uf(this.globals,wc(e),r);var n=Bc(e);if(n===Yf._UDF)return Is(cl(["call UDF"]));var t=this.globals.getFirstOrderFunc(n);if(t.kind===$f.Failure)return Is(t.reason);var o=t.value;if(null==o){var a="nonexistent worksheet function "+n;return Ul("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Kf.NAME,a),xf}var i=o(this,r);if("object"==typeof i&&i.kind===Hf.Error){a="worksheet function "+n+" return value";Ul("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,a)}return i},e.prototype.arrayLift=function(e,r,n){for(var t=this,o=0,a=0,i=0;i<n.length;i+=1){var u=n[i];Bl(u)&&0==(rd(e,i)&Hf.Array)?(o=Math.max(o,u.rows),a=Math.max(a,u.cols)):(o=Math.max(o,1),a=Math.max(a,1))}var c=n.map(function(r,n){return t.broadcastOper(o,a,r,rd(e,n))}),l=new Zc(o,a,function(e,n){return r(c.map(function(r){return r.get(e,n)}))}).map(function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===mc.WorksheetFunction?t.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case Hf.Range:return Gf;case Hf.Missing:case Hf.Blank:return 0;default:return r}});return Bf(l.rows,l.cols,el(l))},e.prototype.dispatchFunction=function(e,r,n){var t=this;if(!nd(r,n.length)){var o=JSON.stringify(r),a="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+o;return Ul("calc.runtime.FunctionDispatcher.dispatchFunction",Kf.NUM,a),Wf}for(var i=n.length,u=Xf.None,c=0;c<i;c+=1){var l=Zf(n[c]);0==(l&rd(r,c))&&(u|=l)}if(u===Xf.None)return this.applyOperatorOrFunction(e,n);if(0!=(u&Hf.Array)){return this.arrayLift(r,function(n){return t.dispatchFunction(e,r,n)},n)}u&=~Hf.Array;var s=[];for(c=0;c<i;c+=1){var f=n[c];if(0!=(u&Zf(f))){var d=rd(r,c);if(f=this.coerceOper(f,d),Zf(f)===Hf.Error&&0==(d&Hf.Error))return f}s[c]=f}return this.applyOperatorOrFunction(e,s)},e.prototype.dispatchStrictIf=function(e){var r=this,n=e[0];if("object"!=typeof n){var t=this.coerceOper(n,Hf.Boolean);return!0===t?e[1]:!1===t?e[2]:t}switch(n.kind){case Hf.Error:return n;case Hf.Missing:case Hf.Blank:return e[2];case Hf.Array:return this.arrayLift(od,function(e){return r.dispatchStrictIf(e)},e);case Hf.Rich:return Is(cl(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case Hf.Range:var o="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+h(n));return S.ULS.assertTag(595980809,s.LogCategory.msoulscat_ES_EWAJS,!1,o);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",n)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,n,t){var o=[],a=sf(e,r,n,t,o);if(null==a){if(o.length>0)return Is(Tl(o));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+h(n);return S.ULS.assertTag(595980819,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){ff(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],n=[],t=0;t<e.length;t+=1){var o=e[t];if("object"==typeof o&&o.kind===Hf.Range){for(var a=[],i=o.sheets,u=i.index,c=i.length,l=0;l<c;l+=1)for(var s=wf(o.sheets.document,l+u),f=0;f<o.ranges.length;f+=1){var d=Pf(s,o.ranges[f]),p=cf(this.globals,this.locals,d,r);null!=p&&a.push(p)}n.push({kind:Tc.RangeValues,arrays:a})}else n.push(o)}return r.length>0?Is(Tl(r)):n},e.prototype.makeOperatorReducer=function(e,r){var n=this.getBinaryOperator(e);return function(e,t){return void 0===e?null!=r?r(t):t:n(e,t)}},e.prototype.makeBranchOperatorReducer=function(e,r){var n=this;return function(t,o){var a=n.makeOperatorReducer(e,r)(t,o);return void 0!==t&&!0===a?t:o}},e.prototype.reduceDerefOpers=function(e,r,n){function t(n,t){if(Bl(t))return o(n,new zc(t.rows,t.cols,t.opers));var a=r(t);return null==a?n:e(n,a)}function o(e,r){for(var n=e,o=0;o<r.rows;o+=1)for(var a=0;a<r.cols;a+=1)n=t(n,r.get(o,a));return n}return n.reduce(function(e,r){return"object"==typeof r&&r.kind===Tc.RangeValues?r.arrays.reduce(o,e):t(e,r)},void 0)},e.prototype.broadcastOper=function(e,r,n,t){if("object"!=typeof n)return nl(e,r,n);switch(n.kind){case Hf.Missing:case Hf.Blank:return nl(e,r,0);case Hf.Array:return 0!=(t&Hf.Array)?nl(e,r,n):function(e,r,n,t){return n.rows===e&&n.cols===r?n:1===n.rows&&1===n.cols?nl(e,r,n.get(0,0)):1===n.rows?new Zc(e,r,function(e,r){return r<n.cols?n.get(0,r):t}):1===n.cols?new Zc(e,r,function(e,r){return e<n.rows?n.get(e,0):t}):new Zc(e,r,function(e,r){return e<n.rows&&r<n.cols?n.get(e,r):t})}(e,r,new zc(n.rows,n.cols,n.opers),Vf);case Hf.Range:default:return nl(e,r,n)}},e.prototype.coerceOper=function(e,r){return Tf(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,n=qf(e),t=[0,0];return function(o,a){return t[0]=o,t[1]=a,ff(r.globals,r.locals,t,n),r.runFunctionToCompletion(Uc(e),n,t)}},e.prototype.getUnaryOperator=function(e){var r=this,n=qf(e),t=[0];return function(o){return t[0]=o,ff(r.globals,r.locals,t,n),r.runFunctionToCompletion(Uc(e),n,t)}},e.prototype.runFunctionToCompletion=function(e,r,n){var t=this.dispatchFunction(e,r,n);return"object"==typeof t&&t.kind===mc.WorksheetFunction?this.runFunctionMachineToCompletion(t):t},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),id=function(e){function r(r,n){var t=e.call(this,r)||this;return t.func=n,t}return Pr(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(ed(e))},r.prototype.receiveSuccess=function(e){return S.ULS.assertTag(595980810,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case dl.Unevaluated:for(var n=[],t=r.anchors,o=t.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,t[o]);n.push(a)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r}(Os);function ud(e,r){return new id(e,r)}var cd=Mn.FormulaSource,ld=Fn.naErrorOper,sd=xn.failure,fd=xn.ResultKind,dd=xn.createResolver;function pd(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Ed(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var hd={kind:dl.Timeout};function vd(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:gd(e)}}function gd(e){return{globals:e,visitedCellMap:Ls.newVisitedMap(),resolver:dd(e),createCellEvaluationMachine:js,createFormulaEvaluationMachine:Qd,createFunctionEvaluationMachine:ud}}var md,Td=function(){function e(e,r){N("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===fl.Stop)return this.generatePartialResults(),S.ULS.traceTag(595953880,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var n=this.evaluate(Ed(e));return n instanceof Array?(S.ULS.traceTag(595953881,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(n)):(S.ULS.traceTag(595953882,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise(function(n){return e.scheduleFunction(function(){return S.ULS.traceTag(595964228,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),n(r.evaluateAsync(e))})}))}catch(e){return Promise.reject(sd(e))}},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return hd;var r=this.evaluationStack[this.evaluationStack.length-1],n=this.evaluateMachine(r);switch(this.currentResult=void 0,n.kind){case hs.Default:break;case hs.Dependency:for(var t=0;t<n.machines.length;t+=1)this.evaluationStack.push(n.machines[t]);break;case hs.Call:this.evaluationStack.push(n.machine);break;case hs.Return:case hs.Write:this.performResultTransition(n);break;case dl.JavaScriptError:this.stopEvaluatingWithJavaScriptError(n);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",n)}}}catch(e){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return S.ULS.assertTag(595980807,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===fd.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Rs))return Al(e);this.currentResult=sd(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Al(e)}},e.prototype.performResultTransition=function(e){if(e.kind===hs.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Al(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===fd.Success){(n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===hs.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var n;if((n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===hs.Dependency)break;if(n.latestTransition===hs.Call){this.currentResult=e.result;break}var t=this.evaluationStack.pop();null!=t&&t.cleanup()}if(0===this.evaluationStack.length){var o="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+h(e.result));return S.ULS.assertTag(595980808,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case fd.Success:this.setFormulaValue(e,r.value);break;case fd.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var n=Pl(r)?0:r;if(e.source===cd.Cell){if(Bl(n)){var t=void 0===n.opers[0]?ld:n.opers[0][0];return this.context.globals.setCellValue(e.range,t)}return this.context.globals.setCellValue(e.range,n)}var o=e.range.range,a=Wl(o.rows,o.cols,n).opers;return this.context.globals.setCellValues(e.range,a)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(sd(ml))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(sd(e))},e}(),Sd=Mn.documentScope,Rd=Mn.nameLoc,Id=Mn.sheetIndex,Cd=Mn.sheetRange,Ad=Mn.gridCell,Nd=Un.documentQualifier,Od=Un.QualifierKind,yd=Un.PosKind,Ld=Un.CellRefKind,kd=Fn.ErrorType,Dd=Fn.nameErrorOper,Md=Fn.refErrorOper,_d=Fn.OperKind,Fd=Fn.arrayOper,bd=Fn.range3DOper,Ud=Fn.rangeSeqOper,wd=xn.gridCellRange,Pd=xn.ResultKind,Bd=xn.success,xd=xn.failure,Vd=xn.sheetGridRangeAnchor,Wd=xn.createResolutionHandler,Gd=xn.createNameFinder,Hd=[void 0,Dd],Kd=vs;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(md||(md={}));var jd=function(e){function r(r,n,t){var o=e.call(this,r)||this;return o.nameEvaluator=Wd(Gd(function(e){var r=o.getNameFormulaAsTerm(o.locals,e);return void 0!==r&&o.checkForNameCycle(e,o.visitedNameMap),r},Hd),function(e){var r="name resolution; qualifier = "+h(e);return Ul("calc.runtime.FormulaEvaluationMachine.evalName",kd.NAME,r),Hd},Is),o.cellEvaluator=Wd(function(e){return bd(e.sheet,e.range)},function(e){var r="error ref, qualifier = "+h(e.data.qualifier);return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,r),Md},Is),o.term=as("calc.runtime.FormulaEvaluationMachine",t),o.locals=n,o.continuation=[],o.env=Kd,o.visitedNameMap=ys.newVisitedMap(),o.dispatcher=new ad(o.context.globals,n),o}return Pr(r,e),r.prototype.next=function(){if(Jc(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,bl),n=this.dispatcher.coerceOper(r,bl);return this.performReturnTransition(Bd(n))}var t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case dl.Unevaluated:for(var n=[],t=r.anchors,o=t.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,t[o]);n.push(a)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var n=r.context;switch(n.kind){case Fc.App:var t=r.holeIndex,o=n.children.length;if((c=r.locals)[t]=e,t+1<o)return this.nextHoleTransition(r,n.children[t+1]);var a=n.data.funName,i=n.data.funType;this.dispatcher.dereferenceOpers(c,i);var u=this.dispatcher.dispatchFunction(a,i,c);return"object"==typeof u&&u.kind===mc.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case Fc.If:var c;if(0===(t=r.holeIndex)){var l=this.dispatcher.dereferenceOper(e,_d.Boolean);if("object"!=typeof l){var f=this.dispatcher.coerceOper(l,_d.Boolean),d=!0===f?n.children[1]:!1===f?n.children[2]:f;return this.popContextTransition(r.env,d)}switch(l.kind){case _d.Error:return this.popContextTransition(r.env,l);case _d.Missing:case _d.Blank:return this.popContextTransition(r.env,n.children[2]);case _d.Array:return r.locals=[l],this.nextHoleTransition(r,n.children[t+1]);case _d.Rich:return this.performReturnTransition(xd(cl(["IF with a rich value condition"])));case _d.Range:var p="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+h(l));return S.ULS.assertTag(595980811,s.LogCategory.msoulscat_ES_EWAJS,!1,p);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",l)}}if((c=r.locals)[t]=e,1===t)return this.nextHoleTransition(r,n.children[t+1]);this.dispatcher.dereferenceOpers(c,od);var E=this.dispatcher.dispatchStrictIf(c);return this.popContextTransition(r.env,E);case Fc.Name:var v=r.locals;return ys.unVisit(v,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case Fc.Let:var g=n.data,m=e,T=r.env;return this.popContextTransition(gs(g,m,T),n.children[1]);case Fc.Array:var R=this.dispatcher.dereferenceOper(e,_l),C=n.data,A=C.rows,N=C.cols,O=r.holeIndex,y=O%N,L=N===y+1,k=(O-y)/N,D=r.locals;if(D[k][y]=this.dispatcher.coerceOper(R,_l),A===k+1&&L)return this.popContextTransition(r.env,Fd(A,N,D));var M=L?k+1:k,_=L?0:y+1;return this.nextHoleTransition(r,n.children[M][_]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",n)}},r.prototype.reduceFormula=function(e){switch(e.kind){case Fc.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case Fc.App:var r=e.data.funName;if(!xc(r)){var n=this.context.globals.getFirstOrderFunc(Bc(r));if(n.kind===Pd.Failure)return Is(n.reason)}if(0===e.children.length){var t=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof t&&t.kind===mc.WorksheetFunction?this.evaluateFunctionTransition(t,void 0):this.updateTermTransition(t)}return this.pushContextTransition(e,e.children[0],[]);case Fc.If:case Fc.Let:return this.pushContextTransition(e,e.children[0],void 0);case Fc.Name:var o=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==o[0]?this.pushContextTransition(e,o[1],o[0]):this.updateTermTransition(o[1]);case Fc.Ident:var a=ms(e.data,this.env);if(null==a){var i="undefined local "+e.data;Ul("calc.runtime.FormulaEvaluationMachine.reduceFormula",kd.NAME,i)}return this.updateTermTransition(void 0===a?Dd:a);case Fc.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map(function(){return[]}));case Fc.Fun:return this.performReturnTransition(xd(cl(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,n){var t=function(e,r,n){return{context:e,holeIndex:0,env:r,locals:n}}(e,this.env,n);return this.continuation[this.continuation.length]=t,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var n=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(n)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:md.Document},r.prototype.getSheetIndex=function(e,r){var n=this.context.globals.getSheetIndex(e,r);return n.kind===Pd.Failure?Is(n.reason):null==n.value?void 0:n.value},r.prototype.evalSheetQualifier=function(e,r){var n=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof n)return n;var t=this.getSheetIndex(n,r.sheet);return null==t?md.Sheet:Id(n,t)},r.prototype.evalNameQualifier=function(e,r){var n;switch(r.kind){case Od.Document:return"string"!=typeof(n=this.evalDocumentQualifier(r))?Sd(n):n;case Od.Sheet:return this.evalSheetQualifier(e,r);case Od.Ident:n=e.range.sheet.document;var t=this.getSheetIndex(n,r.name);return null!=t?Id(n,t):"string"!=typeof(n=this.evalDocumentQualifier(Nd(r.name)))?Sd(n):md.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var n=this.context.globals.getNameFormula(r);if(n.kind===Pd.Failure)return Is(n.reason);var t=n.value;return null!=t?as("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",t):void 0},r.prototype.checkNameCycle=function(e,r,n){return void 0!==ys.lookup(e,n)?Is(Rl(ys.runFrom(e,n))):(ys.visit(e,!0,n),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==ys.lookup(e,r))return Is(Rl(ys.runFrom(e,r)));ys.visit(e,!0,r)},r.prototype.evalName=function(e,r,n,t){if(Jr(Wr.CalcUnifyRangeResolutionCode)){var o=Vd(e.range),a=this.context.resolver.resolveName(o,r,n);return this.nameEvaluator(r,a)}if(null==r||r.kind===Od.Relative){var i=e.range.sheet,u=Rd(i,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);if(u=Rd(Sd(i.document),n),null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var c="name resolution; qualifier = "+h(r);return Ul("calc.runtime.FormulaEvaluationMachine.evalName",kd.NAME,c),[void 0,Dd]}var l=this.evalNameQualifier(e,r);if("string"!=typeof l){var s;u=Rd(l,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var f=null==l.index?"document":"sheet",d="name resolution, qualifier = "+h(r)+", resolved to "+f;return Ul("calc.runtime.FormulaEvaluationMachine.evalName",kd.NAME,d),[void 0,Dd]}var p="qualifier resolution, qualifier = "+h(r)+", failed on "+l;return Ul("calc.runtime.FormulaEvaluationMachine.evalname",kd.NAME,p),[void 0,Dd]},r.prototype.evalPos=function(e,r){return r.kind===yd.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return Ad(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var n=e.range.range;switch(r.kind){case Ld.Error:return;case Ld.Single:var t=this.evalCellRefSingle(n,r);return wd(t,t);case Ld.Range:var o=this.evalCellRefSingle(n,r.ref1),a=this.evalCellRefSingle(n,r.ref2);return wd(o,a);case Ld.Row:return Is(cl(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case Ld.Col:return Is(cl(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(Jr(Wr.CalcUnifyRangeResolutionCode)){var n=Vd(this.locals.range),t=this.context.resolver.resolveCellRef(n,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,t)}var o=e.range.sheet.document,a=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+h(a);return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,u),Md}if(null!=a&&a.kind===Od.Error){u="qualifier resolution, qualifier = "+h(a);return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,u),Md}if(null!=a&&a.kind===Od.SheetRange){var c=this.getSheetIndex(o,a.sheet1);if(null==c){u="qualifier resolution, qualifier = "+h(a)+", sheet 1";return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,u),Md}var l=this.getSheetIndex(o,a.sheet2);if(null==l){u="qualifier resolution, qualifier = "+h(a)+", sheet 2";return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,u),Md}if(c===l)return Ud(Id(o,c),[i]);var s=Cd(o,Math.min(c,l),Math.abs(l-c)+1);return bd(s,i)}var f=null==a||a.kind===Od.Relative?e.range.sheet:this.evalSheetQualifier(e,a);if("string"==typeof f){u="qualifier resolution, qualifier = "+h(a)+", failed on "+f;return Ul("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",kd.REF,u),Md}return Ud(f,[i])},r}(Os);function Qd(e,r,n){return new jd(e,r,n)}function Jd(e,r,n,t){var o=vd(e),a=Qd(o.machineContext,r,n);return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t[0]:Nl(function(t){return e(r,"number"==typeof t?t:n)})}(new Td(o,[a]),t)}var Xd=Fn.SpecialPrecs,Yd=Fn.precedents;function qd(e){var r=Ls.newVisitedMap();return{evalFormula:function(n,t,o,a){var i=As(n,t,Yd([],[],Xd.None,!0),r);return Jd(e,i,o,a)},evalCells:function(r){return Qs(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);for(var n=vd(e),t=[],o=0;o<r.length;o+=1)t.push(js(n.machineContext,r[o]));var a=new Td(n,t),i=pd(e.schedulerInfo);return a.evaluateAsync(i)}(e,r)}}}var zd=Un.formulaSpan,Zd=Un.RefStyle,$d=Mn.FormulaSource,ep=xn.getSubExpressionFromPosition,rp=xn.isSuccess,np=xn.failure,tp=xn.ResultKind,op=zd(0,0,"","");function ap(e){var r,n,t,o,a=e.config,i=e.mathpack,u=pt(a),c=Au(a),l=pl(a,i),s=Ic(c),f=us(l),d=qd(e),p=Eu(u).parseFormula,E=!1,h=void 0,v=-1,g=!1;function m(){E=!1,t=void 0,v=-1,h=void 0,o=void 0,g=!1}function T(){if(!E){if(E=!0,void 0===r||void 0===n)return;var e=p(Zd.A1,r,$d.Cell,n);rp(e)&&(t=e.value)}}function S(e){if(T(),void 0!==t&&e!==v){var r=h;h=void 0,e>=0&&e<n.length&&(h=ep(t,e)),h!==r&&(o=void 0,g=!1),v=e}}function R(){if(void 0!==h&&!g&&void 0!==t){var e=r,n=s.checkFormula(e,$d.Cell,{node:h,spans:t.spans});if(n.isWellFormed){var a=f.compileFormula(e,$d.Cell,n);if(rp(a)){var i=d.evalFormula(e,$d.Cell,a.value,void 0);i.kind!==tp.Paused&&(o=i)}}g=!0}}return{setCellAndFormula:function(e,t){r=e,n=t,m()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(S(e),void 0!==t&&void 0!==h){var r=t.spans[h.label];if(void 0!==r)return r}return op},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return S(e),R(),void 0!==o?Promise.resolve(o):Promise.resolve(np(Al("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return T(),void 0!==t&&(h=t.node,o=void 0,g=!1),R(),void 0!==o?Promise.resolve(o):Promise.resolve(np(Al("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}var ip=Fn.OperKind,up=Fn.valueErrorOper,cp=Fn.div0ErrorOper,lp=Pn.OperatorId,sp=xn.isSheetIndex,fp=32767;function dp(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case ip.Error:return e;case ip.Missing:case ip.Blank:return;case ip.Rich:return dp(e.getFallback());default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function pp(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(lp.Concat,function(r){return e.coerceOper(r,ip.String)}),function(e){return e},n);if(null==t){var o="calc.funcs.concat: returned undefined; args = "+h(r);return S.ULS.assertTag(595969627,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}return"string"==typeof t&&t.length>fp?Fn.valueErrorOper:t}function Ep(e){var r="object"==typeof e&&e.kind===ip.Blank;return(r=r||""===e)?1:0}function hp(e){return"object"!=typeof e||e.kind!==ip.Blank?1:0}function vp(e,r){var n=r[0];if("object"!=typeof n||n.kind!==ip.Range||!sp(n.sheets)||1!==n.ranges.length)return up;var t=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(lp.Add),a=e.reduceDerefOpers(o,hp,t);return null==a?0:a}function gp(e){return function r(n){if("boolean"==typeof n)return n;if("number"==typeof n)return e.coerceOper(n,ip.Boolean);if("string"!=typeof n)switch(n.kind){case ip.Error:return n;case ip.Missing:case ip.Blank:return;case ip.Rich:return r(n.getFallback());default:return I("funcs.aggregationFuncs: booleanOperationCoerce",n)}}}function mp(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(lp.And),gp(e),n);return null==t?up:t}function Tp(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(lp.Or),gp(e),n);return null==t?up:t}function Sp(e,r){var n=e.dereferenceAllOpers(r),t=[];var o=e.reduceDerefOpers(function(e,r){return void 0===e?r:("number"==typeof e&&t.push(e),wl(e)?e:r)},function(e){if("number"==typeof e)return e;if("boolean"!=typeof e&&"string"!=typeof e)switch(e.kind){case ip.Error:return e;case ip.Missing:case ip.Blank:case ip.Rich:return;default:return I("funcs.makeMedianCoerce",e)}},n);if("number"==typeof o&&t.push(o),null==o)return re;if(wl(o))return o;if(0===t.length)return re;if(1===t.length)return t[0];if((t=t.sort(function(e,r){return e-r})).length%2==0){var a=t.length/2;return(t[a-1]+t[a])/2}var i=(t.length-1)/2;return t[i]}function Rp(e){return function(r,n){return e(r)(n[0])}}function Ip(e){return function(r,n){return e(r)(n[0],n[1])}}var Cp=Fn.numErrorOper,Ap=Fn.div0ErrorOper,Np=180/Math.PI,Op=Math.PI/180;function yp(e,r){return Math.PI}var Lp=Rp(function(e){return e.getMathpack().sqrt}),kp=Rp(function(e){return e.getMathpack().exp}),Dp=Ip(function(e){return e.getMathpack().power}),Mp=Rp(function(e){return e.getMathpack().ln}),_p=Rp(function(e){return e.getMathpack().log10});function Fp(e,r){var n=r[0],t=r.length<2?10:r[1];return e.getMathpack().log(n,t)}var bp=Rp(function(e){return e.getMathpack().sin}),Up=Rp(function(e){return e.getMathpack().cos}),wp=Rp(function(e){return e.getMathpack().tan}),Pp=Rp(function(e){return e.getMathpack().asin}),Bp=Rp(function(e){return e.getMathpack().acos}),xp=Rp(function(e){return e.getMathpack().atan}),Vp=Ip(function(e){return e.getMathpack().atan2});function Wp(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,Math.ceil(o));return t<0?-Math.round(-t*a)/a:Math.round(t*a)/a}function Gp(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return t<0?-Math.ceil(-t*a)/a:Math.ceil(t*a)/a}function Hp(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return t<0?-Math.floor(-t*a)/a:Math.floor(t*a)/a}function Kp(e,r){var n=r,t=n[0],o=n[1];return 0===o?0:o<0&&t>0?Cp:o*Math.ceil(t/o)}function jp(e,r){var n=r,t=n[0],o=n[1];return 0===o?0===t?0:Ap:o<0&&t>0?Cp:o*Math.floor(t/o)}function Qp(e,r){var n=r[0];return 2*(n<0?Math.floor(n/2):Math.ceil(n/2))}function Jp(e,r){var n=r[0];return Math.abs(n)}function Xp(e,r){var n=r[0];return n>0?1:0===n?0:n<0?-1:Cp}function Yp(e,r){return r[0]*Np}function qp(e,r){return r[0]*Op}var zp=170;function Zp(e,r){var n=r[0];if(!isFinite(n)||n<0)return Cp;var t=Math.floor(n+2147483648-2147483648);return t>zp?Cp:function e(r){return A("call just Fact with non Natural value",r),0===r?1:r*e(r-1)}(t)}function $p(e,r){var n=r[0];if(xn.operKind(n)===Fn.OperKind.Range){var t=n.sheets,o=n.ranges[0];if(1!==t.length||1!==o.rows||1!==o.cols)return Fn.valueErrorOper;n=e.dereferenceOper(n,Fn.OperKind.Number)}switch(xn.operKind(n)===Fn.OperKind.String&&(n=e.coerceOper(n,Fn.OperKind.Number)),xn.operKind(n)){case Fn.OperKind.Number:return 0==(1&Math.floor(Math.abs(n)));case Fn.OperKind.Error:return n;case Fn.OperKind.Missing:return Fn.naErrorOper;case Fn.OperKind.Blank:return!0;case Fn.OperKind.Rich:return $p(e,[n.getFallback()]);default:return Fn.valueErrorOper}}var eE=Fn.valueErrorOper;function rE(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function nE(e,r){var n=rE(r),t=n[0],o=n[1];return o<0?eE:o>=t.length?t:t.substr(t.length-o,o)}function tE(e,r){var n=rE(r),t=n[0],o=n[1];return o<0?eE:o>=t.length?t:t.substr(0,o)}function oE(e,r){var n=r[0],t=r[1]-1,o=Math.floor(r[2]);return t<0||o<0?eE:n.substr(t,o)}function aE(e,r){return r[0].length}function iE(e,r){if(2!==r.length)return oe;var n,t=r[0],o=r[1];if("object"==typeof(n=t)&&n.kind===Ml.Rich&&"string"==typeof o){var a=t.getField(o);if(void 0!==a)return a}return oe}function uE(e,r){return cE(e,[Z].concat(r))}function cE(e,r){for(var n=r[0],t={},o=1;o<r.length;o+=2){var a=r[o],i=r[o+1];t[a.toLowerCase()]=i}return new lE(t,n)}var lE=function(){return function(e,r){var n=this;void 0===e&&(e={}),void 0===r&&(r=Z),this._fields=e,this._fallback=r,this.kind=w.Rich,this.getFallback=function(){return n._fallback},this.getField=function(e){var r=e.toLowerCase(),t=n._fields[r];if(void 0!==t)return t}}}(),sE=xn.success,fE=xn.failure,dE={};dE[Pn.WorksheetFuncId.SUM]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(lp.Add),dp,n);return null==t?0:t},dE[Pn.WorksheetFuncId.PRODUCT]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(lp.Mul),dp,n);return null==t?0:t},dE[Pn.WorksheetFuncId.AVERAGE]=function(e,r){var n,t=e.makeOperatorReducer(lp.Add),o=e.dereferenceAllOpers(r),a=e.reduceDerefOpers(t,dp,o),i=e.reduceDerefOpers(t,(n=dp,function(e){if(null!=n(e))return 1}),o);if(null!=a&&null!=i)return e.getBinaryOperator(lp.Div)(a,i);if(null==a&&null==i)return cp;var u="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+h(r);return S.ULS.assertTag(595980871,s.LogCategory.msoulscat_ES_EWAJS,!1,u)},dE[Pn.WorksheetFuncId.CONCAT]=pp,dE[Pn.WorksheetFuncId.CONCATENATE]=pp,dE[Pn.WorksheetFuncId.COUNTBLANK]=function(e,r){var n=r[0];if("object"!=typeof n||n.kind!==ip.Range||!sp(n.sheets)||1!==n.ranges.length)return up;var t=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(lp.Add),a=e.reduceDerefOpers(o,Ep,t);return null==a?0:a},dE[Pn.WorksheetFuncId.MAX]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(lp.Gt,function(e){return!1}),o=e.reduceDerefOpers(t,dp,n);return null==o?0:o},dE[Pn.WorksheetFuncId.MIN]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(lp.Lt,function(e){return!1}),o=e.reduceDerefOpers(t,dp,n);return null==o?0:o},dE[Pn.WorksheetFuncId.ISERROR]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.Error},dE[Pn.WorksheetFuncId.ISERR]=function(e,r){var n=r[0];return xn.operKind(n)===Fn.OperKind.Error&&n.type!==Fn.ErrorType.NA},dE[Pn.WorksheetFuncId.ISBLANK]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.Blank},dE[Pn.WorksheetFuncId.ISLOGICAL]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.Boolean},dE[Pn.WorksheetFuncId.ISNA]=function(e,r){var n=r[0];return xn.operKind(n)===Fn.OperKind.Error&&n.type===Fn.ErrorType.NA},dE[Pn.WorksheetFuncId.ISNONTEXT]=function(e,r){return xn.operKind(r[0])!==Fn.OperKind.String},dE[Pn.WorksheetFuncId.ISTEXT]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.String},dE[Pn.WorksheetFuncId.ISNUMBER]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.Number},dE[Pn.WorksheetFuncId.ISREF]=function(e,r){return xn.operKind(r[0])===Fn.OperKind.Range},dE[Pn.WorksheetFuncId.ISEVEN]=$p,dE[Pn.WorksheetFuncId.ISODD]=function(e,r){var n=$p(e,r);return xn.operKind(n)===Fn.OperKind.Boolean?!n:n};var pE,EE,hE=!1;function vE(e){return hE||(hE=!0,Jr(Wr.CalcNewFunctions)&&(dE[Pn.WorksheetFuncId.AND]=mp,dE[Pn.WorksheetFuncId.OR]=Tp,dE[Pn.WorksheetFuncId.COUNTA]=vp,dE[Pn.WorksheetFuncId.ABS]=Jp,dE[Pn.WorksheetFuncId.CEILING]=Kp,dE[Pn.WorksheetFuncId.DEGREES]=Yp,dE[Pn.WorksheetFuncId.FLOOR]=jp,dE[Pn.WorksheetFuncId.RADIANS]=qp,dE[Pn.WorksheetFuncId.ROUND]=Wp,dE[Pn.WorksheetFuncId.ROUNDUP]=Gp,dE[Pn.WorksheetFuncId.ROUNDDOWN]=Hp,dE[Pn.WorksheetFuncId.EVEN]=Qp,dE[Pn.WorksheetFuncId.SIGN]=Xp,dE[Pn.WorksheetFuncId.PI]=yp,dE[Pn.WorksheetFuncId.SQRT]=Lp,dE[Pn.WorksheetFuncId.EXP]=kp,dE[Pn.WorksheetFuncId.POWER]=Dp,dE[Pn.WorksheetFuncId.LN]=Mp,dE[Pn.WorksheetFuncId.LOG10]=_p,dE[Pn.WorksheetFuncId.LOG]=Fp,dE[Pn.WorksheetFuncId.SIN]=bp,dE[Pn.WorksheetFuncId.COS]=Up,dE[Pn.WorksheetFuncId.TAN]=wp,dE[Pn.WorksheetFuncId.ASIN]=Pp,dE[Pn.WorksheetFuncId.ACOS]=Bp,dE[Pn.WorksheetFuncId.ATAN]=xp,dE[Pn.WorksheetFuncId.ATAN2]=Vp,dE[Pn.WorksheetFuncId.FACT]=Zp,dE[Pn.WorksheetFuncId.LEFT]=tE,dE[Pn.WorksheetFuncId.RIGHT]=nE,dE[Pn.WorksheetFuncId.MID]=oE,dE[Pn.WorksheetFuncId.LEN]=aE),Jr(Wr.CalcWorksheetFunctions)&&(dE[Pn.WorksheetFuncId.MEDIAN]=Sp),Jr(Wr.CalcFieldValueFunction)&&(dE[Pn.WorksheetFuncId.FIELDVALUE]=iE),Jr(Wr.CalcRecordFunctions)&&(dE[Pn.WorksheetFuncId.RECORD]=uE,dE[Pn.WorksheetFuncId.RECORDTEST]=cE)),dE[e]}function gE(e){return function(r){if("number"==typeof r){var n=vE(r);return null!=n?sE(n):fE(cl([e.getWorksheetFuncName(r)]))}return sE(void 0)}}(EE=pE||(pE={})).DerefOperKind=Tc,EE.FuncKind=mc;var mE={},TE=0;function SE(e){var r=mE[e];mE[e]=(void 0===r?0:r)+1,(TE+=1)%100==0&&(S.ULS.traceTag(595858520,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"hashUtils.logCollision: "+JSON.stringify(mE)+"."),mE={})}function RE(e){if(null==e)return"";var r,n=Or(e.sheet.document);n===y?r="illegalDocument":r=(null==n.path?"":"p:"+n.path.toLocaleUpperCase()+",")+"n:"+n.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}function IE(e){var r=1;return r=31*(r=31*(r=31*(r=31*r+e.sheet.index)+e.range.col)+e.range.row)+e.sheet.document.name.length,void 0!==e.sheet.document.path&&(r=31*r+e.sheet.document.path.length),r}function CE(e,r){var n,t,o=e.sheet.document,a=r.sheet.document;return o.name.toLocaleUpperCase()===a.name.toLocaleUpperCase()&&(n=o.path,t=a.path,null==n?null==t:null==t?null==n:n.toLocaleUpperCase()===t.toLocaleUpperCase())&&e.sheet.index===r.sheet.index&&e.range.col===r.range.col&&e.range.row===r.range.row}function AE(){return{map:{},keyToHash:IE,keyEquals:CE,nelements:0,add:function(e){var r=this.keyToHash(e);if($r(this.map[r]))this.map[r]=[e],this.nelements+=1;else{for(var n=this.map[r],t=0;t<n.length;t+=1)if(this.keyEquals(e,n[t]))return;SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),n.push(e),this.nelements+=1}},contains:function(e){var r=this.keyToHash(e),n=this.map[r];if($r(n))return!1;for(var t=0;t<n.length;t+=1)if(this.keyEquals(e,n[t]))return!0;return SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var r=this;Object.keys(this.map).forEach(function(n){r.map[+n].forEach(function(r){e(r)})})},size:function(){return this.nelements},remove:function(e){var r=this,n=this.keyToHash(e),t=this.map[n];if($r(t))return!1;var o=[],a=!1;return t.forEach(function(n){r.keyEquals(e,n)?(r.nelements-=1,a=!0):o.push(n)}),this.map[n]=o,a||SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a}}}var NE=xn.createResolutionHandler,OE=xn.createNameFinder,yE={};function LE(e){Jr(Wr.CalcLogStopWatch)&&(yE[e]=Hr(e))}function kE(e){if(Jr(Wr.CalcLogStopWatch)){var r=yE[e];void 0!==r&&r.stop()}}function DE(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&ME(e.name,r.name)&&ME(e.path,r.path)}function ME(e,r){return null==e&&null==r||null!=e&&null!=r&&e.toLocaleUpperCase()===r.toLocaleUpperCase()}function _E(e,r,n,t){var o=function(e,r){if(void 0===e){var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t)}switch(e.kind){case le.Error:return;case le.Relative:var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t);case le.Sheet:var o=void 0!==e.document?L(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==o)return;var a=r.getSheetIndex(o,e.sheet);if(null==a)return;return M(o,a);case le.SheetRange:if(null==(o=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(o,e.sheet1),u=r.getSheetIndex(o,e.sheet2);if(null==i||null==u)return;return i===u?M(o,i):D(o,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,n);if(void 0!==o)if(DE(r.sheet.document,o.document)||(t.crossDocRefs+=1),ur(o))switch(o.index!==r.sheet.index&&(t.crossSheetRefs+=1),e.ref.kind){case se.Error:return void(t.errRefs+=1);case se.Col:return void(t.columnRefs+=1);case se.Row:return void(t.rowRefs+=1);case se.Range:var a=pr(FE(e.ref.ref1,r),FE(e.ref.ref2,r));return n.maxRangeSize>0&&jl(a)>n.maxRangeSize?void(t.largeRanges+=1):H(o,a);case se.Single:var i=FE(e.ref,r);return K(o,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else t.crossSheetRefs+=1;else t.errRefs+=1}function FE(e,r){return b(bE(e.row,r.range.row),bE(e.col,r.range.col))}function bE(e,r){switch(e.kind){case fe.Abs:return e.index;case fe.Rel:return e.index+r}}function UE(e,r){var n=void 0;if(void 0===e.qualifier){var t=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==t||null==o)return;n=M(t,o)}else switch(e.qualifier.kind){case le.Document:n=j(L(e.qualifier.path,e.qualifier.document));break;case le.Relative:t=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==t||null==o)return;n=M(t,o);break;case le.Ident:var a=r.getCurrentDocumentLoc();if(null==a)return;var i=r.getSheetIndex(a,e.qualifier.name);n=null==i?j(L(void 0,e.qualifier.name)):M(a,i);break;case le.Sheet:if(null==(a=void 0!==e.qualifier.document?L(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(a,e.qualifier.sheet)))return;n=M(a,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return Q(n,e.whole)}function wE(e,r){switch(r.ref.kind){case se.Error:e.errRefs+=1;break;case se.Col:e.columnRefs+=1;break;case se.Row:e.rowRefs+=1}}function PE(e,r){var n=r[e];return void 0===n&&(n=0),n}function BE(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:qr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){if(LE("calc_ts_merge_sets"),Jr(Wr.CalcHashSet)){var n=AE();e.forEach(function(e){n.add(e)}),r.forEach(function(r){n.contains(r)||e.push(r)})}else{var t=qr();e.forEach(function(e){t[RE(e)]=!0}),r.forEach(function(r){var n=RE(r);t[n]||(e.push(r),t[n]=!0)})}kE("calc_ts_merge_sets")}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach(function(n){var t=e.functionsCount[n];void 0===t&&(t=0),e.functionsCount[n]=t+r.functionsCount[n]}),Object.keys(r.operatorsCount).forEach(function(n){var t=Number(n),o=e.operatorsCount[t];void 0===o&&(o=0),e.operatorsCount[t]=o+r.operatorsCount[t]})}};return e}function xE(e){var r={_logger:e,_dependencyGraph:qr(),haveDependents:function(e){return void 0!==r._dependencyGraph[RE(e)]},directDependents:function(e){var n=[],t=r._dependencyGraph[RE(e)];return void 0!==t&&t.forEach(function(e){n.push(e)}),n},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=qr()},add:function(e,n,t){var o=Br({},e);o.getCurrentDocumentLoc=function(){return Or(e.getCurrentDocumentLoc())};var a=BE();if(null==t)return a;var i=void 0,u=void 0;Jr(Wr.CalcUnifyRangeResolutionCode)&&(i=function(e,r,n,t){return NE(OE(function(o){var a=r.nameRefToSheetGridRange(e,o);return null==a?a:(n.addDependency(a,e,r.maxRangeSize,t),a)},void 0),Yr,function(){})}(n,o,r,a),u=function(e,r,n,t){return NE(function(o){ur(o.sheet)||(t.crossSheetRefs+=1),DE(e.sheet.document,o.sheet.document)||(t.crossDocRefs+=1),o.sheet.index!==e.sheet.index&&(t.crossSheetRefs+=1),lr(o)&&n.addDependency(o,e,r.maxRangeSize,t)},function(e){return wE(t,e)},function(e,r){e.kind===Qe.NotImplemented?wE(t,r):t.errRefs+=1})}(n,o,r,a));var c,l,f,d=[];for(d.push(t.node);d.length>0;){var p=d.pop();if(null!=p)switch(p.kind){case de.Literal:break;case de.Array:p.nodes.map(function(e){return e.map(function(e){d.push(e)})});break;case de.App:if("object"==typeof p.head){var E=p.head;switch(E.kind){case de.Operator:a.operatorsCount[E.id]=(c=E.id,l=a.operatorsCount,f=void 0,void 0===(f=l[c])&&(f=0),f+1);break;case de.Name:a.functionsCount[E.whole]=PE(E.whole,a.functionsCount)+1;break;default:d.push(E)}}p.args.map(function(e){d.push(e)});break;case de.Paren:d.push(p.node);break;case de.Name:if(a.nameRefs+=1,Jr(Wr.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,o.resolver.resolveName(n,p.qualifier,p.whole));else if(void 0===i){var h=UE(p,o);if(void 0!==h)null!=(v=o.nameRefToSheetGridRange(n,h))&&r.addDependency(v,n,o.maxRangeSize,a)}else S.ULS.traceTag(595952269,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case de.CellRef:if(Jr(Wr.CalcUnifyRangeResolutionCode)&&void 0!==u)u(p,o.resolver.resolveCellRef(n,p.qualifier,p.ref));else if(void 0===u){var v;void 0!==(v=_E(p,n,o,a))&&r.addDependency(v,n,o.maxRangeSize,a)}else S.ULS.traceTag(595952270,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case de.Bad:a.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",p)}}return a},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=xE(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){LE("calc_ts_merge_graph");var n=function(n){var t=r._dependencyGraph[n],o=e[n];void 0===t&&(t=[]);var a=t;if(Jr(Wr.CalcHashSet)){var i=AE();a.forEach(function(e){i.add(e)}),o.forEach(function(e){i.contains(e)||a.push(e)})}else{var u=qr();a.forEach(function(e){u[RE(e)]=!0}),o.forEach(function(e){u[RE(e)]||a.push(e)})}r._dependencyGraph[n]=a};for(var t in e)n(t);kE("calc_ts_merge_graph")},addDependency:function(e,n,t,o){if(sr(e)){var a=RE(e);r.updateDependency(a,n)&&o.dependents.push(e)}else if(jl(e.range)>t)o.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=K(e.sheet,b(i,u));r.addDependency(c,n,t,o)}},updateDependency:function(e,n){var t=r._dependencyGraph[e];return void 0===t&&(t=[]),!t.some(function(e){return t=n,o=(r=e).sheet,a=t.sheet,o.document===a.document&&o.index===a.index&&function(e,r){return e.row===r.row&&e.col===r.col}(r.range,t.range);var r,t,o,a})&&(t.push(n),r._dependencyGraph[e]=t,!0)},getDependents:function(e,n){if(LE("calc_ts_get_dependents"),Jr(Wr.CalcHashSet)){for(var t=AE(),o=[],a=r.directDependents(e);a.length>0;){if(void 0!==(l=a.shift()))if(!t.contains(l))t.add(l),(s=r.directDependents(l)).length>0&&s.forEach(function(e){a.push(e)}),n&&0!==s.length||o.push(l)}return o}for(var i=qr(),u=[],c=r.directDependents(e);c.length>0;){var l;if(void 0!==(l=c.shift())){var s,f=RE(l);if(!i[f])i[f]=!0,(s=r.directDependents(l)).length>0&&(c=c.concat(s)),n&&0!==s.length||u.push(l)}}return kE("calc_ts_get_dependents"),u},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return VE(0,0);var n=e.length,t=0;return e.forEach(function(e){var n=r._dependencyGraph[e];t+=n.length}),VE(n,t)}};return r}function VE(e,r){return{nodes:e,arcs:r}}var WE=xn.createResolver,GE=xn.success;function HE(e){return R(e),xE(e)}function KE(e,r,n,t,o,a,i,u,c,l){return{maxRangeSize:e,nameRefs:r,rowRefs:n,columnRefs:t,crossSheetRefs:o,crossDocRefs:a,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:l,resolver:WE({getSheetIndex:function(e,r){return GE(c(e,r))},getDocumentLoc:i})}}var jE=Mn.FormulaSource,QE=Mn.sheetGridCell,JE=Mn.gridCell,XE=Mn.documentLoc,YE=Mn.sheetIndex,qE=Un.RefStyle,zE=xn.ResultKind,ZE=xn.failure;function $E(e,r,n,t){return{getNumberFormatCategory:e,getCellFormat:r,knownFormats:n,formatValueTypes:t}}function eh(e,r,n){return{config:e,mathpack:r,formatInfo:n}}function rh(e){var r={globals:e,runtime:function(e){var r=e.config,n=e.mathpack,t={config:r},o=Br({config:r},e.formatInfo),a={config:r,mathpack:n},i=Eu(t),u=Ic(o),c=us(a);return{parser:i,analyzer:u,compiler:c}}(e),cache:qr(),lazyCreateCacheItem:function(e){var n,t=RE(e),o=r.cache[t];return void 0===o&&(o={cell:e,rawValue:n,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},r.cache[t]=o),o},size:function(){var e=0;for(var n in r.cache)e+=1;return e},clear:function(){r.cache=qr()},cells:function(){var e=Object.keys(r.cache);return void 0===e||0===e.length?[]:e.map(function(e){return r.cache[e].cell})},getItem:function(e){var n=RE(e);return r.cache[n]},getValue:function(e){var n=r.getItem(e);if(void 0!==n&&null!==n.rawValue)return n.rawValue},getFormula:function(e,n,t){var o=r.getItem(e);if(void 0!==o&&nh(r.runtime,o,n,t)&&th(o.formula))return o.formula},getFormulaFormat:function(e){var n=r.getItem(e);if(void 0!==n)return n.format},getCompiledFormula:function(e,n){var t=r.getItem(e);if(void 0!==t&&function(e,r,n){if(th(r.compiledFormula))return!0;if(!nh(e,r,n))return!1;if(void 0!==n&&n)return!1;r.compiledFormula=null;try{var t=e.compiler.compileFormula(r.cell,jE.Cell,r.formula);return t.kind===zE.Success&&(r.compiledFormula=t.value,!0)}catch(e){return S.ULS.traceTag(595968586,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+h(e)),!1}}(r.runtime,t,n)&&th(t.compiledFormula))return t.compiledFormula},getEvalResult:function(e){var n=r.getItem(e);if(void 0!==n)return n.evalResult},isEqualValue:function(e,n){var t=r.getItem(e);return void 0!==t&&t.rawValue===n},updateCellValue:function(e,n,t,o,a){if(!r.isEqualValue(e,n)){var i=r.lazyCreateCacheItem(e);if(i.rawValue=n,i.formula=void 0,i.compiledFormula=void 0,i.evalResult=void 0,i.format=void 0,null!=t){var u=t.getValue(e);void 0!==u&&n===u&&(i.formula=t.getFormula(e,!0),i.compiledFormula=t.getCompiledFormula(e,!0),i.evalResult=void 0,i.format=i.format)}null!=a&&(i.format=a),null!=o&&o.forEach(function(e){var n=r.getItem(e);void 0!==n&&(n.evalResult=void 0)})}},updateEvalResult:function(e,n,t){var o=r.lazyCreateCacheItem(e);o.evalResult=n,null!=t&&(o.format=t)},merge:function(e,n){e.cells().forEach(function(t){var o=e.getValue(t);void 0===o||!0!==n&&void 0!==r.getItem(t)||r.updateCellValue(t,o,e)})},parseCompileNameFormula:function(e,n,t){var o,a=void 0===t?qE.A1:t,i=jE.NameManager;if(void 0!==n)o=r.runtime.parser.parseFormula(a,n,i,e);else{var u=YE(XE(void 0,"Doc"),0),c=JE(0,0);o=r.runtime.parser.parseFormula(a,QE(u,c),i,e)}var l=h(e);if(o.kind!==zE.Success){var f="calc.formulaCache.parseCompileNameFormula: couldn't parse "+l;return S.ULS.traceTag(595969230,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,f),ZE(ht(f))}var d=r.runtime.analyzer.checkFormula(n,jE.NameManager,o.value);if(d.isWellFormed)return r.runtime.compiler.compileFormula(n,i,d);var p="calc.formulaCache.parseCompileNameFormula: formula "+l+" is not well-formed.";return S.ULS.traceTag(595969231,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,p),ZE(El(p))}};return r}function nh(e,r,n,t){if(th(r.formula))return!0;if(!th(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==n&&n)return!1;r.formula=null;var o=r.rawValue;try{var a=e.parser.parseFormula(Un.RefStyle.A1,r.cell,jE.Cell,o);if(a.kind!==zE.Success)return!1;var i=e.analyzer.checkFormula(r.cell,jE.Cell,a.value,t);if(!i.isWellFormed)return!1;if(r.formula=i,Jr(Wr.CalcFormatCalculations)){var u=e.analyzer.findBestFormat(r.cell,jE.Cell,i);r.format=void 0===u?void 0:u.iformat}return!0}catch(e){return S.ULS.traceTag(595968585,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+h(e)),!1}}function th(e){return null!=e}var oh,ah=oh=function(e,r){return{functionId:e,functionName:r}},ih=function(e){return e}(function(e,r){return{errorType:e,errorName:r}}),uh=function(e){return e}(function(e,r,n,t,o,a,i,u,c,l,s,f,d,p){var E=[];return r.forEach(function(e,r){"string"==typeof e?E.push(ih(r,e)):Zr(e)&&E.push(e)}),{worksheetFunctionNames:e,errorTypeNames:E,errorNames:[],trueName:n,falseName:t,rowLetter:o,columnLetter:a,leftBrace:i,rightBrace:u,leftBracket:c,rightBracket:l,decimalSeparator:s,listSeparator:f,columnSeparator:d,rowSeparator:p}}),ch=function(e){return e}(function(e,r,n){return{iformat:e,category:r,decimals:n}}),lh=function(e){return e}(function(e,r){return{sheetId:e,sheetName:r}}),sh={kind:"Blank"},fh=function(e){return e}(function(e){return{kind:"Error",type:e}}),dh=function(e){return e}(function(e){return{kind:"Rich",fields:e}}),ph=function(e){return e}(function(e,r){return{row:e,column:r}}),Eh=function(e){return e}(function(e,r,n,t){return{row:e,column:r,lastRow:n,lastColumn:t}}),hh=function(e){return e}(function(e,r,n,t,o){return{sheetId:e,row:r,column:n,lastRow:t,lastColumn:o}}),vh=function(e){return e}(function(e,r,n){return{formulaBarText:e,value:r,iformat:n}}),gh=function(e){return e}(function(e,r,n,t,o){return{range:e,data:r,fromStateId:n,excludeRows:t,excludeColumns:o}}),mh=function(e){return e}(function(e,r,n,t){return gh(e,r,void 0,n,t)});function Th(e,r,n,t){return gh(e,void 0,r,n,t)}var Sh=function(e){return e}(function(e,r){return{isSpilled:e,formulaBarText:r}}),Rh=function(e){return e}(function(e,r,n){return{range:e,data:r,fromStateId:n}});function Ih(e,r){return Rh(e,r,void 0)}function Ch(e,r){return Rh(e,void 0,r)}var Ah,Nh,Oh,yh,Lh=function(e){return e}(function(e,r,n,t){return{range:e,formulaBarText:r,value:n,origin:t}}),kh=function(e){return e}(function(e,r){return{range:e,formulaBarText:r}}),Dh=function(e){return e}(function(e,r,n,t,o){return{isExact:e,iformat:r,hasHyperlink:n,category:t,decimals:o}}),Mh=function(e){return e}(function(e,r,n){return{formulaBarText:e,value:r,format:n}}),_h=function(e){return e}(function(e,r){return{range:e,data:r}}),Fh=function(e){return e}(function(e,r){return{range:e,data:r}}),bh=function(e){return e}(function(e,r,n){return{range:e,task:r,reason:n}}),Uh=function(e){return e}(function(e,r,n,t,o,a){return{stateId:e,priorityGroup:r,isFinished:n,rangeDeltas:t,arrayDeltas:o,rangeFailures:a}}),wh=function(e){return e}(function(e,r){return{rangeUpdateRanges:e,arrayUpdateRanges:r}}),Ph=6e4,Bh=3e4;function xh(e,r){var n,t=[new Promise(function(e,r){return n=[e,r]}),n],o=t[0],a=t[1],i=a[0],u=a[1],c=setTimeout(r,Math.max(0,e));return[o,[function(e){clearTimeout(c),i(e)},function(e){clearTimeout(c),u(e)}]]}function Vh(e,r,n){var t=xh(e,function(){return l(r())}),o=t[0],a=t[1],i=a[0],u=a[1],c=!1;function l(e){u(e),c=!0}var s=Promise.resolve().then(function(e){return n(l,function(){return c})});return function(e,r){return e.then(function(e){return r(),e},function(e){return r(),Promise.reject(e)})}(Promise.race([o,s]),i)}function Wh(e,r){var n;return new Promise(function(t,o){Promise.resolve(r).then(function r(a){if(void 0!==a){n=a;try{Promise.resolve(e(n)).then(r,o)}catch(e){o(e)}}else t(n)},o)})}function Gh(e,r){return{setMessageListeners:function(r){e.onmessage=function(e){return r.onMessage(e.data)},e.onmessageerror=function(e){return r.onMessageError(e.data)}},postMessage:function(r){return e.postMessage(r)},close:function(){return r.call(e)}}}function Hh(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(Ah||(Ah={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(Nh||(Nh={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(Oh||(Oh={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(yh||(yh={}));var Kh,jh={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function Qh(e){return[e.name,e.message,e.stack]}function Jh(e){var r,n=e[0],t=e[1],o=e[2],a=jh[n];return null!=a?r=new a(t):(r=new Error(t)).name=n,void 0!==o&&(r.stack=o),r}function Xh(e){return Hh(e)?[Kh.Error,Qh(e)]:[Kh.Unknown,e]}function Yh(e,r,n,t){var o=new Error(e);return o.stack=e+"\n    at "+r+":"+n+":"+t,o}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(Kh||(Kh={}));var qh="__START_ERROR__",zh="__END_ERROR__";function Zh(e){var r=e.message.indexOf(qh),n=e.message.indexOf(zh);return r>=0&&n>=0?Jh(JSON.parse(e.message.substring(r+qh.length,n))):null!=e.error?e.error:Yh(e.message,e.filename,e.lineno,e.colno)}function $h(e,r,n,t,o,a){var i={port:r,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==i)throw new Error("endpoint is closed");return i}function c(e,r,n){if(null!=i){var t=i.callbacks[e];null!=t&&(delete i.callbacks[e],t[r](n))}}function l(e,r,n,t,o){var a;try{a=u()}catch(e){return Promise.reject(e)}var i=a.lastAppId+1,c=[Oh.App,i,e,r,n,o],l=xh(t,function(){f(c,new Error("exceeded timeout; callTimeout = "+t+"ms"))}),s=l[0],d=l[1];a.callbacks[i]=d,a.lastAppId=i;try{a.port.postMessage(c)}catch(e){f(c,e)}return s}function s(e,r,n,t){var o=u(),a=[Oh.App,-1,e,r,n,t];try{o.port.postMessage(a)}catch(e){f(a,e)}}function f(e,r){var n=e[1],t=e[5];null!=i&&(n>=0&&c(n,yh.Rejected,r),t?g(n>=0?Nh.PostCallError:Nh.PostNotifyError,r,!0):(n<0&&g(Nh.PostNotifyError,r,!1),l("","",[],Math.max(m.callTimeout,m.initTimeout),!0).catch(function(e){})))}function d(e){var r=e[1],n=e[2],t=e[3],o=e[4],a=e[5];if(null!=i)if(""!==n||""!==t){var u=Promise.resolve().then(function(e){if(null!=i){var r=n,a=t,u=i.modules[r],c=null!=u?u[a]:void 0;if(null==c)throw new Error("method "+r+"."+a+" has not been exported");return c.apply(u,o)}});r>=0?u.then(function(e){return p(r,yh.Fulfilled,e,a)},function(e){return p(r,yh.Rejected,e,a)}):u.catch(function(e){g(Nh.UnhandledNotifyError,function(e,r,n){var t=r+"."+n+".notify: ";if(Hh(e))return e.message=t+e.message,null!=e.stack&&(e.stack=t+e.stack),e;var o=new Error(t+e);return o.stack=void 0,o}(e,n,t),!1)})}else p(r,yh.Fulfilled,void 0,a)}function p(e,r,n,t){if(null!=i){var o=[Oh.Result,e,r,Xh(n),t];try{i.port.postMessage(o)}catch(e){E(o,e)}}}function E(e,r){var n=e[1],t=e[4];null!=i&&(t?g(Nh.PostResultError,r,!0):p(n,yh.Rejected,Xh(r),!0))}function h(e){var r=e[1],n=e[2],t=e[3];null!=i&&c(r,n,function(e){return e[0]===Kh.Unknown?e[1]:Jh(e[1])}(t))}function v(e){if(void 0===e&&(e=!0),null!=i){var r=i.port,n=i.callbacks;if(i=void 0,e)try{r.postMessage([Oh.Close])}catch(e){}var t=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var o in n)c(Number(o),yh.Rejected,t);try{r.close()}catch(e){}if(null!=a)try{a(m)}catch(t){var u=null!=t.stack?t.stack:t.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,r,n){if(null!=i){var t=void 0;try{o(m,{kind:e,closing:n,error:r})||(t=[r])}catch(r){t=[r]}if(n&&v(),null!=t){var a=t[0],u=null!=a.stack?a.stack:a.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var m={workerKind:e,initTimeout:n,callTimeout:t,setExports:function(e,r){return u().modules[e]=r},getImports:function(e,r){var n={};return r.forEach(function(r){return n[r]=function(e,r){var n={callTimeout:void 0,isCritical:!1,call:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var a=null!=n.callTimeout?n.callTimeout:m.callTimeout;return l(e,r,t,a,n.isCritical)},notify:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];s(e,r,t,n.isCritical)}};return n}(e,r)}),n},close:v,dispatchError:g};return i.port.setMessageListeners({onMessage:function(e){switch(e[0]){case Oh.App:return d(e);case Oh.Result:return h(e);case Oh.Close:return v(!1);default:return I("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var r=new Error("failed to send "+e[0]+" message");switch(e[0]){case Oh.App:return f(e,r);case Oh.Result:return E(e,r);case Oh.Close:return;default:return I("calc.worker.createPortEndpoint.onMessageError",e)}}}),m}function ev(e,r,n){var t=this,o=null!=r.initTimeout?r.initTimeout:Ph,a=null!=r.callTimeout?r.callTimeout:Bh;return Vh(o,function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")},function(i,u){return xr(t,void 0,void 0,function(){function t(e){return function(r,n){return l?null!=e.onError&&(e.onError(r,n),!0):(i(n.error),!0)}}function c(e){return function(r){l&&null!=e.onClosed&&e.onClosed(r)}}var l,s,f;return Vr(this,function(i){switch(i.label){case 0:return l=!1,s=$h(e,n.outside,o,a,t(r.outside),c(r.outside)),f=$h(e,n.inside,o,a,t(r.inside),c(r.inside)),u()||null==r.inside.onInit?[3,2]:[4,r.inside.onInit(f)];case 1:i.sent(),i.label=2;case 2:return u()||null==r.outside.onInit?[3,4]:[4,r.outside.onInit(s)];case 3:i.sent(),i.label=4;case 4:return l=!0,[2,s]}})})})}function rv(){return"undefined"!=typeof MessageChannel}var nv=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return C("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var tv,ov,av=100;function iv(){if(null==Wn.getCalcAbsUrl()){return S.ULS.traceTag(595907587,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function uv(e){setTimeout(function(){try{e.terminate()}catch(e){}},av)}function cv(){var e={};for(var r in Wr){var n=Wr[r];null!=n&&(e[r]=Jr(n))}return e}n(9);var lv=((tv={})[Ah.FunctionCall]=function(){return!0},tv[Ah.MessageChannel]=rv,tv[Ah.Dedicated]=iv,tv);function sv(e){return lv[e]()}var fv=((ov={})[Ah.FunctionCall]=function(e){return ev(Ah.FunctionCall,e,(r=new nv,n=new nv,r.open(n),{outside:r,inside:n}));var r,n},ov[Ah.MessageChannel]=function(e){if(!rv())return C("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var r=function(){var e=new MessageChannel;return{outside:Gh(e.port1,e.port1.close),inside:Gh(e.port2,e.port2.close)}}();try{return ev(Ah.MessageChannel,e,r)}catch(e){try{r.outside.close()}catch(e){}throw e}},ov[Ah.Dedicated]=function(e){var r=this,n=e.outside,t=e.inside,o=e.initTimeout,a=e.callTimeout,i=t.scriptName;if(null==i)return C("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=Wn.getCalcAbsUrl();if(!iv()||null==u)return C("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=o?o:Ph,l=null!=a?a:Bh;return Vh(c,function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")},function(e,t){return Kr("calc.worker.createDedicatedWorker (total)",function(){return xr(r,void 0,void 0,function(){function r(r){return xr(this,void 0,void 0,function(){function o(r,t){return i?null!=n.onError&&(n.onError(r,t),!0):(e(t.error),!0)}function a(e){i&&null!=n.onClosed&&n.onClosed(e)}var i,s,f,d,p;return Vr(this,function(e){switch(e.label){case 0:i=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),s=new Worker(r),d=Gh(s,function(){return uv(s)}),f=$h(Ah.Dedicated,d,c,l,o,a),s.onerror=function(e){var n;e.preventDefault(),n=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+r):Zh(e),f.dispatchError(Nh.UnhandledError,n,!i)},function(e,r){var n={shipAssertTag:function(e,n,t,o){try{r.ULS.shipAssertTag(e,n,t,o)}catch(e){}},assertTag:function(e,n,t,o){try{r.ULS.assertTag(e,n,t,o)}catch(e){}},traceTag:function(e,n,t,o){try{r.ULS.traceTag(e,n,t,o)}catch(e){}},debugTraceTag:function(e,n,t,o){try{r.ULS.debugTraceTag(e,n,t,o)}catch(e){}}};e.setExports("",n)}(f,S),t()?[3,3]:[4,Kr("calc.worker.createDedicatedWorker (inside)",function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:l,calcAbsUrl:u,features:cv()})})];case 2:e.sent(),e.label=3;case 3:return t()||null==n.onInit?[3,5]:[4,n.onInit(f)];case 4:e.sent(),e.label=5;case 5:return i=!0,[2,f];case 6:throw p=e.sent(),null!=f?f.close():null!=s&&uv(s),p;case 7:return[2]}})})}var o,a,f,d;return Vr(this,function(e){switch(e.label){case 0:t=i+(/\.min\.js$/.test(n=u)?".min.js":".js"),c=n.lastIndexOf("/"),o=n.substring(0,c+1)+t,a="calc.worker.createDedicatedWorker: workerUrl = "+o,S.ULS.traceTag(595907588,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,a),e.label=1;case 1:e.trys.push([1,6,,7]),f=new Blob(['importScripts("'+encodeURI(o)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(f),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,r(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),S.ULS.traceTag(595881991,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+o+". Attempting with string url instead..."),[2,r(o)];case 7:return[2]}var n,t,c})})})})},ov);function dv(e,r){return fv[e](r)}function pv(e,r){return xr(this,void 0,void 0,function(){var n,t,o,a,i;return Vr(this,function(u){switch(u.label){case 0:n=0,u.label=1;case 1:if(!(n<e.length))return[3,6];if(!sv(t=e[n]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,dv(t,r)];case 3:return[2,u.sent()];case 4:return o=u.sent(),a=null!=o.stack?o.stack:o.message,i="calc.worker.tryCreateWorker: starting "+t+" worker threw "+a,S.ULS.traceTag(595907598,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,i),[3,5];case 5:return n+=1,[3,1];case 6:return[2,void 0]}})})}function Ev(){setTimeout(function(){try{self.close()}catch(e){}},av)}function hv(e,r,n,t){var o=r.initTimeout,a=r.callTimeout,i=r.calcAbsUrl,u=r.features;return xr(this,void 0,void 0,function(){var r,c,l,s,f=this;return Vr(this,function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,Vh(o,function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")},function(e,r){return xr(f,void 0,void 0,function(){function c(r,n){return s?null!=t.onError&&(t.onError(r,n),!0):(e(n.error),!0)}function l(e){s&&null!=t.onClosed&&t.onClosed(e)}var s,f,d,p,E,h;return Vr(this,function(e){switch(e.label){case 0:s=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=Gh(self,Ev),f=$h(Ah.Dedicated,d,o,a,c,l),p=function(e){var r=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,n,t,o){if(r.shipAssertTag.notify(e,n,t,o),!t)throw new Error("shipAssertTag: "+o)},assertTag:function(e,n,t,o){if(r.assertTag.notify(e,n,t,o),!t)throw new Error("assertTag: "+o)},traceTag:function(e,n,t,o){r.traceTag.notify(e,n,t,o)},debugTraceTag:function(e,n,t,o){r.debugTraceTag.notify(e,n,t,o)}}}(f),E=function(e){return!0===u[e]},n.config.initCalc(p,E,i),r()||null==t.onInit?[3,3]:[4,t.onInit(f)];case 2:e.sent(),e.label=3;case 3:return s=!0,[3,5];case 4:throw h=e.sent(),null!=f?f.close():Ev(),h;case 5:return[2]}})})}).then(function(e){return[yh.Fulfilled,e]},function(e){return[yh.Rejected,e]})];case 1:r=d.sent(),c=r[0],l=r[1],s=[Oh.Result,e,c,Xh(l),!0];try{self.postMessage(s)}catch(e){throw Ev(),e}return[2]}})})}var vv={onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,t="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});S.ULS.traceTag(595908699,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,t)},onClosed:function(e){},onInit:function(e){var r=e.getImports("talk",["ping"]);e.setExports("location",Mn),e.setExports("talk",{start:function(e,n,t){return xr(this,void 0,void 0,function(){var o,a=this;return Vr(this,function(i){switch(i.label){case 0:return o=Date.now(),[4,Wh(function(i){return xr(a,void 0,void 0,function(){return Vr(this,function(a){switch(a.label){case 0:return Date.now()>=o+e?[2,void 0]:[4,new Promise(function(e){return setTimeout(function(){return e()},n)})];case 1:return a.sent(),r.ping.notify(i,t),[2,i+1]}})})},0)];case 1:return i.sent(),[2]}})})},memoryTest:function(e){var r=[],n=0;try{for(;n<e;n+=1){var t=new Uint8Array(1024);t[0]=0,t[1023]=255,r.push(t)}}catch(e){}r=[];var o="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+n+"KB";S.ULS.traceTag(595906820,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,o)},ping:function(e,r){if(r&&e%1e3==0){var n="calc.worker.smokeTestInsideDef.ping: n = "+e;S.ULS.traceTag(595907656,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)}return e+1},logMessage:function(e,r){if(r){var n="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;S.ULS.traceTag(595714188,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"},gv="To be, or not to be, that is the question:Whether 'tis nobler in the mind to sufferThe slings and arrows of outrageous fortune,Or to take arms against a sea of troublesAnd by opposing end them. To die—to sleep,No more; and by a sleep to say we endThe heart-ache and the thousand natural shocksThat flesh is heir to: 'tis a consummationDevoutly to be wish'd. To die, to sleep;To sleep, perchance to dream—ay, there's the rub:For in that sleep of death what dreams may come,When we have shuffled off this mortal coil,Must give us pause—there's the respectThat makes calamity of so long life.For who would bear the whips and scorns of time,Th'oppressor's wrong, the proud man's contumely,The pangs of dispriz'd love, the law's delay,The insolence of office, and the spurnsThat patient merit of th'unworthy takes,When he himself might his quietus makeWith a bare bodkin? Who would fardels bear,To grunt and sweat under a weary life,But that the dread of something after death,The undiscovere'd country, from whose bournNo traveller returns, puzzles the will,And makes us rather bear those ills we haveThan fly to others that we know not of?Thus conscience does make cowards of us all,And thus the native hue of resolutionIs sicklied o'er with the pale cast of thought,And enterprises of great pitch and momentWith this regard their currents turn awryAnd lose the name of action.",mv={outside:{onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,t="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});S.ULS.traceTag(595910859,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,t)},onClosed:function(e){S.ULS.traceTag(595908701,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,r){if(r&&e%1e3==0){var n="calc.worker.smokeTestOutsideDef.ping: n = "+e;S.ULS.traceTag(595907657,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)}return e+1}})}},inside:vv},Tv=!1,Sv=void 0;function Rv(){null!=Sv&&Sv.close(),Tv=!1}var Iv=Promise.resolve();function Cv(e,r,n,t){return void 0===t&&(t=0),Jr(Wr.CalcWebWorkerTest)?(Rv(),Iv=Iv.then(function(o){return function(e,r,n,t){return xr(this,void 0,void 0,function(){var o,a,i,u,c,l,f,d=this;return Vr(this,function(p){switch(p.label){case 0:Tv=!0,p.label=1;case 1:return p.trys.push([1,8,9,10]),f="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+r+"ms",S.ULS.traceTag(595908687,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,f),[4,pv([Ah.Dedicated,Ah.MessageChannel,Ah.FunctionCall],mv)];case 2:if(null==(Sv=p.sent()))throw new Error("could not create any kind of worker");if(!Tv)throw new Error("smoke test canceled during worker creation");return f="calc.worker.runSmokeTest: worker created; outside.workerKind = "+Sv.workerKind,S.ULS.traceTag(595907658,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,f),o=Sv.getImports("talk",["start","memoryTest","ping","logMessage"]),a=Sv.getImports("location",["gridCell"]),[4,o.ping.call(-1,n)];case 3:return i=p.sent(),[4,a.gridCell.call(2,3)];case 4:if(u=p.sent(),0!==i||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+i+", "+u.row+", "+u.col);return t>0&&Sv.workerKind===Ah.Dedicated?[4,o.memoryTest.call(t)]:[3,6];case 5:p.sent(),p.label=6;case 6:return o.start.notify(e,r,n),c=Date.now(),[4,Wh(function(t){return xr(d,void 0,void 0,function(){var a;return Vr(this,function(i){switch(i.label){case 0:return Date.now()>=c+e?[2,void 0]:t%1e3!=0?[3,3]:(a=Hr("calc.worker.runSmokeTest: ping call roundtrip"),[4,o.ping.call(t,!1)]);case 1:return i.sent(),a.stop(),a=Hr("calc.worker.runSmokeTest: logMessage notify"),[4,o.logMessage.notify(gv,!1)];case 2:i.sent(),a.stop(),i.label=3;case 3:return[4,new Promise(function(e){return setTimeout(function(){return e()},r)})];case 4:return i.sent(),o.ping.notify(t,n),[2,t+1]}})})},0)];case 7:return p.sent(),f="calc.worker.runSmokeTest: success",S.ULS.traceTag(595906821,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,f),[3,10];case 8:return l=p.sent(),Tv&&(f="calc.worker.runSmokeTest: failure: "+(null!=l.stack?l.stack:l.message),S.ULS.traceTag(595908702,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,f)),[3,10];case 9:return Rv(),Sv=void 0,[7];case 10:return[2]}})})}(e,r,n,t)})):Promise.resolve()}var Av={onError:function(e,r){},onInit:function(e){e.setExports("service",{setA1ReferenceStyle:function(){},setLocale:function(){},setNumberFormats:function(){},setSheetNames:function(){},setUsedRanges:function(){},updateRanges:function(){},updateArrays:function(){},editRangeFormulas:function(){},editArrayFormulas:function(){},resumeRecalc:function(){},clearCache:function(){}})},scriptName:"excelOnlineRecalcService.worker"},Nv={outside:{onError:function(e,r){},onClosed:function(e){}},inside:Av};var Ov=function(){return xr(this,void 0,void 0,function(){var e,r,n,t;return Vr(this,function(o){switch(o.label){case 0:return[4,pv([Ah.Dedicated,Ah.FunctionCall],Nv)];case 1:if(null==(e=o.sent()))throw new Error("could not create any kind of worker");return r="calc.calc.createRecalcService: worker created; outside.workerKind = "+e.workerKind,S.ULS.traceTag(595731987,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,r),n={onRecalcResults:function(e){},onUpdateRequest:function(e){}},e.setExports("client",n),t=e.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","setUsedRanges","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","clearCache"]),[2,{setOnRecalcResults:function(e){n.onRecalcResults=e},setOnUpdateRequest:function(e){n.onUpdateRequest=e},setA1ReferenceStyle:function(e){t.setA1ReferenceStyle.notify(e)},setLocale:function(e){t.setLocale.notify(e)},setNumberFormats:function(e,r){t.setNumberFormats.notify(e,r)},setSheetNames:function(e){t.setSheetNames.notify(e)},setUsedRanges:function(e,r){t.setUsedRanges.notify(e,r)},updateRanges:function(e,r){t.updateRanges.notify(e,r)},updateArrays:function(e,r){t.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t.resumeRecalc.notify()},waitForRecalc:function(){return Promise.resolve()},clearCache:function(){t.clearCache.notify()},close:function(){e.close()}}]}})})};function yv(e,r){return{key:e,value:r}}function Lv(e){return{entries:{},keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.entries[this.keyToString(e)];return Zr(r)?r.value:void 0},setValue:function(e,r){var n=this.keyToString(e),t=this.entries[n];Zr(t)?t.value=r:this.entries[n]=yv(e,r)},contains:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&null!==this.entries[r]},remove:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var n=this.keyToString(e),t=this.entries[n];if(Zr(t))return t.value;var o=r();return delete this.entries[n],this.entries[n]=yv(e,o),o},forEach:function(e){for(var r in this.entries){var n=this.entries[r];null!=n&&e(n.key,n.value)}}}}var kv=function(){function e(e){this.kind=0,this.result=e}return e.prototype.failed=function(e){throw S.ULS.traceTag(595910681,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"DataCell.failed: Calc.ts cannot fail at handling just data."),"DataCell.failed: Calc.ts cannot fail at handling just data."},e}(),Dv=new kv(he),Mv=function(){function e(e){this.kind=1,this.raw=e,this.ir=void 0}return e.prototype.parsed=function(e){this.ir=e},e.prototype.analysed=function(e){this.ir=e},e.prototype.compiled=function(e){this.ir=e},e.prototype.failed=function(e,r,n){return new _v(this.raw,e,r,n)},e}(),_v=function(){function e(e,r,n,t){this.kind=2,this.phase=r,this.formulaText=e,this.reason=n,this.details=t}return e.prototype.failed=function(e){return S.ULS.traceTag(595910682,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Failed.failed: Calc.ts will not attempt at working with a FailedFormula"),this},e}(),Fv=function(){function e(){this.table={map:{},nentries:0,keyToHash:IE,keyEquals:CE,getCount:function(){return this.nentries},getValue:function(e){var r=this.keyToHash(e),n=this.map[r];if(!$r(n)){for(var t=0;t<n.length;t+=1){var o=n[t];if(this.keyEquals(e,o.key))return o.value}SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,r){var n=this.keyToHash(e),t=this.map[n];if(null==t)this.map[n]=[yv(e,r)],this.nentries+=1;else{for(var o=0;o<t.length;o+=1){var a=t[o];if(this.keyEquals(a.key,e))return void(a.value=r)}t.push(yv(e,r)),this.nentries+=1,SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},remove:function(e){var r=this.keyToHash(e),n=this.map[r];if($r(n))return!1;for(var t=[],o=!1,a=0;a<n.length&&!o;a+=1){var i=n[a];this.keyEquals(e,i.key)?(this.nentries-=1,o=!0):t.push(i)}return this.map[r]=t,o||SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),o},getOrSetValue:function(e,r){var n=this.keyToHash(e),t=this.map[n];if($r(t)){var o=r();return this.map[n]=[yv(e,o)],this.nentries+=1,o}for(var a=0;a<t.length;a+=1){var i=t[a];if(this.keyEquals(e,i.key))return i.value}var u=r();return t.push(yv(e,u)),this.nentries+=1,SE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),u},forEach:function(e){var r=this;Object.keys(this.map).forEach(function(n){r.map[+n].forEach(function(r){e(r.key,r.value)})})}},this.usedRange=void 0}return e.prototype.getCellContents=function(e){var r=this.table.getValue(e);return void 0===r?Dv:r},e.prototype.setCellContents=function(e,r){if(this.table.setValue(e,r),void 0===this.usedRange)this.usedRange={row:e.range.row,column:e.range.col};else{var n=this.usedRange,t=n.row,o=n.column;this.usedRange={row:Math.max(e.range.row,t),column:Math.max(e.range.col,o)}}},e.prototype.forEach=function(e){this.table.forEach(e)},e.prototype.getUsedRange=function(){return this.usedRange},e}();var bv=function(){function e(e,r){this.workbook=e,this.grid=new Fv,this.name=r}return e.prototype.updateGrid=function(e,r){this.grid.setCellContents(e,new Mv(r))},e.prototype.upgradeGridWithValue=function(e,r){this.grid.setCellContents(e,new kv(r))},e.prototype.parse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.parse: didn't find a formula to parse.");var n=r;if(void 0!==n.ir)return Ir("Sheet.parse: formula has been parsed already.");var t=this.workbook.parser.parseFormula(this.workbook.isA1RefStyle?ce.A1:ce.R1C1,e,v.Cell,n.raw);return t.kind===je.Failure?(this.grid.setCellContents(e,n.failed(0)),Ir("Sheet.parse: parsing of failed.")):t.value.node.kind===de.Bad?(this.grid.setCellContents(e,r.failed(0)),Ir("Sheet.parse: parsing of formula failed (bad formula).")):(n.parsed(t.value),Rr(t.value))},e.prototype.analyse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.analyse: didn't find a formula to analyse.");var n=r,t=n.ir;if(void 0===t||void 0===t.node)return Ir("Sheet.analyse: didn't find AST in this cell.");var o=this.workbook.analyzer.checkFormula(e,v.Cell,t);return o.isWellFormed?(n.analysed(o),Rr(o)):(this.grid.setCellContents(e,r.failed(1)),Ir("Sheet.analyse: formula is not well-formed."))},e.prototype.compile=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.compile: didn't find a formula to compile.");var n=r,t=n.ir;if(void 0===t||!0!==t.isWellFormed)return Ir("Sheet.compile: didn't find a well-formed formula in this cell.");var o=this.workbook.compiler.compileFormula(e,v.Cell,t);return o.kind!==je.Success?(this.grid.setCellContents(e,r.failed(3)),Ir("Sheet.compile: formula can't be compiled.")):(n.compiled(o.value),Rr(o.value))},e.prototype.evaluate=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.evaluate: didn't find a formula to evaluate.");if(void 0===r.ir)return Ir("Sheet.evaluate: didn't find a compiled term in this cell.");var n=this.workbook.evaluator.evalCells([e]);if(!(n instanceof Array)){if(n.kind===je.Paused)return Ir("Sheet.evaluate: evaluator didn't meet deadline");throw Ir("Sheet.evaluate: something went wrong in the data model.")}var t=n[0];if(t.kind!==je.Success)switch(this.grid.setCellContents(e,r.failed(3,t.reason.kind,t.reason)),t.reason.kind){case"NotImplemented":return Ir("Sheet.evaluate: unimplemented functions :: "+t.reason.features);case"JavaScriptError":return Ir("Sheet.evaluate: javascript error :: "+t.reason.error);case"NameCycle":return Ir("Sheet.evaluate: name cycle :: "+t.reason.names);case"CellCycle":return Ir("Sheet.evaluate: cell cycle :: "+t.reason.cells);default:return Ir("Sheet.evaluate: failed :: "+t.reason)}return Pl(t.value)?Rr(0):Rr(t.value)},e}();function Uv(e){return function(r,n){return e.documentLocation}}function wv(e){return function(r,n){return Rr(e.getSheetId(n))}}function Pv(e,r){var n=e.worksheets.getValue(r.sheet.index);if(void 0!==n){var t=n.grid.getCellContents(r);if(2===t.kind){var o=e.expectedValue(r);return void 0!==o?hl(o):void 0}return 0===t.kind?hl(t.result):vl(r)}}function Bv(e){return function(r){var n=Pv(e,r);return void 0===n?Ir(Cl(r)):Rr(n)}}function xv(e,r,n){return function(t){var o=t.sheet,a=t.range,i=a.row,u=a.col,c=a.rows,l=a.cols;if(c*l>r*n)return Rr([]);if(void 0!==e.worksheets.getValue(o.index)){for(var s=[],f=i;f<i+c;f+=1){for(var d=[],p=u;p<u+l;p+=1){var E=K(o,b(f,p)),h=Pv(e,E);if(void 0===h)return Ir(Cl(t));d.push(h)}s.push(d)}return Rr(s)}return Ir(Cl(t))}}function Vv(e){return function(r){if("number"==typeof r){var n=vE(r);return null!=n?Rr(n):Ir(Ar([e.config.localeInfo.getWorksheetFuncName(r)]))}return Rr(void 0)}}function Wv(e){return function(r){var n=r.name.toUpperCase(),t=r.scope;if(void 0===t.index)return Rr(e.globalNames.getValue(n));var o=e.scopedNames.getValue(t.index);return Rr(void 0===o?void 0:o.getValue(n))}}function Gv(e){return function(r){var n=e.worksheets.getValue(r.sheet.index);if(void 0===n)return Rr(void 0);var t=n.grid.getCellContents(r);if(0===t.kind||2===t.kind)return Rr(void 0);var o=t.ir;return Rr(gl(r,v.Cell,o))}}function Hv(e){return function(r,n){var t=e.worksheets.getValue(r.sheet.index);void 0!==t&&t.grid.setCellContents(r,new kv(n))}}function Kv(e){return function(r,n){for(var t=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,l=0;l<u;l+=1)for(var s=0;s<c;s+=1){var f=K(t,b(l+a,s+i)),d=e.worksheets.getValue(f.sheet.index);void 0!==d&&d.grid.setCellContents(f,new kv(n[l][s]))}}}function jv(e){return function(r,n){for(var t=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,l=0;l<u;l+=1)for(var s=0;s<c;s+=1){var f=K(t,b(l+a,s+i)),d=e.worksheets.getValue(f.sheet.index);if(void 0!==d){var p=d.grid.getCellContents(f);void 0!==p&&d.grid.setCellContents(f,p.failed(3,n.kind,n))}}}}function Qv(e){return function(r){var n=e.worksheets.getValue(r.index);if(void 0===n)return Ir(Nr([r]));var t=n.grid.getUsedRange();if(void 0===t)return Rr(t);var o=F(0,0,t.row+1,t.column+1);return Rr(H(r,o))}}function Jv(e,r,n){var t=e.parser.parseFormula(e.isA1RefStyle?ce.A1:ce.R1C1,n,v.NameManager,r);if(t.kind===je.Success){var o=e.analyzer.checkFormula(n,v.NameManager,t.value);return o.isWellFormed?e.compiler.compileFormula(n,v.NameManager,o):Ir(El("compileNamedFormula: formula is not well formed"))}return t}var Xv=K(M(L(void 0,""),0),b(0,0)),Yv=function(){function e(e,r,n,t,o,a,i,u,c,l){var s=this;void 0===u&&(u=!0),this.documentLocation=L(void 0,e),this.isA1RefStyle=r,this.locale=t,this.config=Wn.calcConfig(t),Wn.initCalc(l,function(e){return-1!==c.indexOf(e)});var f=Wn.calcConfig(t);this.config=f;var d={config:f},p={config:f},E={config:f,mathpack:a};this.parser=Eu(d),this.analyzer=Ic(p),this.compiler=us(E);var v,g,m,T=o?(g=1024,m=1024,{config:(v=this).config,mathpack:bc,getDocumentLoc:Uv(v),getSheetIndex:wv(v),getCellValue:Bv(v),getCellValues:xv(v,g,m),getFirstOrderFunc:Vv(v),getNameFormula:Wv(v),getCellFormula:Gv(v),interruptToken:[fl.Continue],schedulerInfo:{},setCellValue:Hv(v),setCellValues:Kv(v),setCellFailure:jv(v),getUsedRange:Qv(v),setDynamicPrecs:function(e,r){},loadObjects:function(e){return!1}}):function(e){throw"Not being invoked yet."}();this.evaluator=qd(T),this.globalNames=Lv(Yr),this.scopedNames=Lv(String),this.worksheets=Lv(String),this.sheetId=0,n.forEach(function(e){s.addWorksheet(e)}),this.expectedValue=i,this.preprocess=function(e){return function(r){return e?h(r):"string"==typeof r?r:JSON.stringify(r)}}(u)}return e.prototype.addWorksheet=function(e){this.worksheets.setValue(this.sheetId,new bv(this,e)),this.sheetId+=1},e.prototype.makeHomeCell=function(e){var r=this.parser.parseFormula(this.isA1RefStyle?ce.A1:ce.R1C1,Xv,v.Cell,e);if(r.kind===je.Failure)return"Workbook can't create home cell "+this.preprocess(e)+". Reason: "+this.preprocess(r.reason)+".";if(r.value.node.kind===de.Bad)return"Workbook can't create home cell "+this.preprocess(e)+". (Bad Node).";var n=r.value.node.ref,t=r.value.node.qualifier,o=this.getSheetId(t.sheet);return-1===o?"Workbook can't find index of sheet "+this.preprocess(t.sheet)+".":K(M(this.documentLocation,o),b(n.row.index,n.col.index))},e.prototype.getSheetId=function(e){var r=-1;return this.worksheets.forEach(function(n,t){t.name===e&&(r=n)}),r},e.prototype.failedToAddName=function(e,r,n){var t=e?"addGlobalName":"addScopedName";S.ULS.traceTag(595891858,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook."+t+": "+r+" >> "+this.preprocess(n)+".")},e.prototype.addGlobalName=function(e,r,n){var t=this.makeHomeCell(n);if("string"==typeof t)return this.failedToAddName(!0,"failed to parse home cell",n);var o=Jv(this,r,t);o.kind===je.Success?this.globalNames.setValue(e,o.value):this.failedToAddName(!0,"failed to compile named formula",r)},e.prototype.addScopedName=function(e,r,n,t){var o=this.makeHomeCell(t);if("string"==typeof o)return this.failedToAddName(!1,"failed to parse home cell",t);var a=Jv(this,n,o);a.kind===je.Success?this.scopedNames.getOrSetValue(e,function(){return Lv(Yr)}).getOrSetValue(r,function(){return a.value}):this.failedToAddName(!1,"failed to compile named formula",n)},e.prototype.getSheetAndCell=function(e){var r=this.makeHomeCell(e);if("string"==typeof r)return r;var n=r.sheet.document;if(this.documentLocation!==n)return"Workbook: invalid workbook location";var t=r.sheet.index,o=this.worksheets.getValue(t);return void 0===o?"Workbook: invalid workbook location":{sheet:o,cell:r}},e.prototype.cellUpdateFailed=function(e,r,n){var t={cell:e,formula:r};S.ULS.traceTag(595891859,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellUpdate: "+n+" >> "+this.preprocess(t)+".")},e.prototype.cellUpdate=function(e,r){try{var n=this.getSheetAndCell(e);if("string"==typeof n)return this.cellUpdateFailed(e,r,"could not find cell and sheet");var t=n.sheet,o=n.cell;t.updateGrid(o,r);var a=t.parse(o);if(!Cr(a))return this.cellUpdateFailed(e,r,"failed at parsing. "+a.reason);if(!Cr(a=t.analyse(o)))return this.cellUpdateFailed(e,r,"failed at analysing. "+a.reason);if(!Cr(a=t.compile(o)))return this.cellUpdateFailed(e,r,"failed at compiling. "+a.reason)}catch(e){S.ULS.traceTag(595891860,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in Workbook.cellUpdate: "+e)}},e.prototype.cellEvaluate=function(e){var r=this.worksheets.getValue(e.sheet.index);if(void 0!==r){var n=r.evaluate(e);Cr(n)||S.ULS.traceTag(595886097,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellEvaluate: failed at evaluating "+this.preprocess(e)+". "+n.reason)}else S.ULS.traceTag(595886096,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellEvaluate: couldn't find worksheet "+this.preprocess(r))},e.prototype.cellUpdateWithValue=function(e,r){var n=this.getSheetAndCell(e);if("string"!=typeof n){var t=n.sheet,o=n.cell;t.upgradeGridWithValue(o,r)}else{var a="Workbook.cellUpdateWithValue: "+n+".";S.ULS.traceTag(595891861,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,a)}},e.prototype.cellRead=function(e){var r=this.getSheetAndCell(e);if("string"==typeof r){var n="Workbook.cellRead: "+r+".";return S.ULS.traceTag(595891862,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n),n}var t=r.sheet,o=r.cell;return t.grid.getCellContents(o)},e.prototype.forEachCell=function(e){this.worksheets.forEach(function(r,n){n.grid.forEach(function(r,t){e(n,r,t)})})},e}();n.d(r,"location",function(){return Mn}),n.d(r,"formula",function(){return Un}),n.d(r,"value",function(){return Fn}),n.d(r,"signature",function(){return Pn}),n.d(r,"util",function(){return xn}),n.d(r,"config",function(){return Wn}),n.d(r,"parse",function(){return t}),n.d(r,"analyze",function(){return o}),n.d(r,"runtime",function(){return a}),n.d(r,"calc",function(){return u}),n.d(r,"funcs",function(){return c}),n.d(r,"worker",function(){return i}),n.d(r,"datamodel",function(){return l})}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map